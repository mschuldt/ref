<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>What’s New In Python 3.4 &mdash; Python 3.4.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.4.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Python 3.4.3 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Python 3.4.3 documentation" href="../index.html" />
    <link rel="up" title="What’s New in Python" href="index.html" />
    <link rel="next" title="What’s New In Python 3.3" href="3.3.html" />
    <link rel="prev" title="What’s New in Python" href="index.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/version_switch.js"></script>
    
 

  </head>
  <body>  
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="3.3.html" title="What’s New In Python 3.3"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="What’s New in Python"
             accesskey="P">previous</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &raquo;</li>
        <li>
          <span class="version_switcher_placeholder">3.4.3</span>
          <a href="../index.html">Documentation</a> &raquo;
        </li>

          <li><a href="index.html" accesskey="U">What&#8217;s New in Python</a> &raquo;</li> 
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="what-s-new-in-python-3-4">
<h1>What&#8217;s New In Python 3.4<a class="headerlink" href="#what-s-new-in-python-3-4" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">R. David Murray &lt;<a class="reference external" href="mailto:rdmurray&#37;&#52;&#48;bitdance&#46;com">rdmurray<span>&#64;</span>bitdance<span>&#46;</span>com</a>&gt; (Editor)</td>
</tr>
</tbody>
</table>
<p>This article explains the new features in Python 3.4, compared to 3.3.
Python 3.4 was released on March 16, 2014.  For full details, see the
<a class="reference external" href="https://docs.python.org/3.4/whatsnew/changelog.html">changelog</a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><span class="target" id="index-0"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0429"><strong>PEP 429</strong></a> &#8211; Python 3.4 Release Schedule</p>
</div>
<div class="section" id="summary-release-highlights">
<h2>Summary &#8211; Release Highlights<a class="headerlink" href="#summary-release-highlights" title="Permalink to this headline">¶</a></h2>
<p>New syntax features:</p>
<ul class="simple">
<li>No new syntax features were added in Python 3.4.</li>
</ul>
<p>Other new features:</p>
<ul class="simple">
<li><a class="reference internal" href="#whatsnew-pep-453"><em>pip should always be available</em></a> (<span class="target" id="index-1"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a>).</li>
<li><a class="reference internal" href="#whatsnew-pep-446"><em>Newly created file descriptors are non-inheritable</em></a>
(<span class="target" id="index-2"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0446"><strong>PEP 446</strong></a>).</li>
<li>command line option for <a class="reference internal" href="#whatsnew-isolated-mode"><em>isolated mode</em></a>
(<a class="reference external" href="https://bugs.python.org/issue16499">issue 16499</a>).</li>
<li><a class="reference internal" href="#codec-handling-improvements"><em>improvements in the handling of codecs</em></a>
that are not text encodings (multiple issues).</li>
<li><a class="reference internal" href="#whatsnew-pep-451"><em>A ModuleSpec Type</em></a> for the Import System
(<span class="target" id="index-3"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0451"><strong>PEP 451</strong></a>).  (Affects importer authors.)</li>
<li>The <a class="reference internal" href="../library/marshal.html#module-marshal" title="marshal: Convert Python objects to streams of bytes and back (with different constraints)."><tt class="xref py py-mod docutils literal"><span class="pre">marshal</span></tt></a> format has been made <a class="reference internal" href="#whatsnew-marshal-3"><em>more compact and efficient</em></a> (<a class="reference external" href="https://bugs.python.org/issue16475">issue 16475</a>).</li>
</ul>
<p>New library modules:</p>
<ul class="simple">
<li><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O, event loop, coroutines and tasks."><tt class="xref py py-mod docutils literal"><span class="pre">asyncio</span></tt></a>: <a class="reference internal" href="#whatsnew-asyncio"><em>New provisional API for asynchronous IO</em></a> (<span class="target" id="index-4"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-3156"><strong>PEP 3156</strong></a>).</li>
<li><a class="reference internal" href="../library/ensurepip.html#module-ensurepip" title="ensurepip: Bootstrapping the &quot;pip&quot; installer into an existing Python installation or virtual environment."><tt class="xref py py-mod docutils literal"><span class="pre">ensurepip</span></tt></a>: <a class="reference internal" href="#whatsnew-ensurepip"><em>Bootstrapping the pip installer</em></a>
(<span class="target" id="index-5"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a>).</li>
<li><a class="reference internal" href="../library/enum.html#module-enum" title="enum: Implementation of an enumeration class."><tt class="xref py py-mod docutils literal"><span class="pre">enum</span></tt></a>: <a class="reference internal" href="#whatsnew-enum"><em>Support for enumeration types</em></a>
(<span class="target" id="index-6"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0435"><strong>PEP 435</strong></a>).</li>
<li><a class="reference internal" href="../library/pathlib.html#module-pathlib" title="pathlib: Object-oriented filesystem paths"><tt class="xref py py-mod docutils literal"><span class="pre">pathlib</span></tt></a>: <a class="reference internal" href="#whatsnew-pathlib"><em>Object-oriented filesystem paths</em></a>
(<span class="target" id="index-7"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0428"><strong>PEP 428</strong></a>).</li>
<li><a class="reference internal" href="../library/selectors.html#module-selectors" title="selectors: High-level I/O multiplexing."><tt class="xref py py-mod docutils literal"><span class="pre">selectors</span></tt></a>: <a class="reference internal" href="#whatsnew-selectors"><em>High-level and efficient I/O multiplexing</em></a>, built upon the <a class="reference internal" href="../library/select.html#module-select" title="select: Wait for I/O completion on multiple streams."><tt class="xref py py-mod docutils literal"><span class="pre">select</span></tt></a> module primitives (part
of <span class="target" id="index-8"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-3156"><strong>PEP 3156</strong></a>).</li>
<li><a class="reference internal" href="../library/statistics.html#module-statistics" title="statistics: mathematical statistics functions"><tt class="xref py py-mod docutils literal"><span class="pre">statistics</span></tt></a>: A basic <a class="reference internal" href="#whatsnew-statistics"><em>numerically stable statistics library</em></a> (<span class="target" id="index-9"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0450"><strong>PEP 450</strong></a>).</li>
<li><a class="reference internal" href="../library/tracemalloc.html#module-tracemalloc" title="tracemalloc: Trace memory allocations."><tt class="xref py py-mod docutils literal"><span class="pre">tracemalloc</span></tt></a>: <a class="reference internal" href="#whatsnew-tracemalloc"><em>Trace Python memory allocations</em></a> (<span class="target" id="index-10"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0454"><strong>PEP 454</strong></a>).</li>
</ul>
<p>Significantly improved library modules:</p>
<ul class="simple">
<li><a class="reference internal" href="#whatsnew-singledispatch"><em>Single-dispatch generic functions</em></a> in
<a class="reference internal" href="../library/functools.html#module-functools" title="functools: Higher-order functions and operations on callable objects."><tt class="xref py py-mod docutils literal"><span class="pre">functools</span></tt></a> (<span class="target" id="index-11"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0443"><strong>PEP 443</strong></a>).</li>
<li>New <a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><tt class="xref py py-mod docutils literal"><span class="pre">pickle</span></tt></a> <a class="reference internal" href="#whatsnew-protocol-4"><em>protocol 4</em></a> (<span class="target" id="index-12"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-3154"><strong>PEP 3154</strong></a>).</li>
<li><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><tt class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></tt></a> now has <a class="reference internal" href="#whatsnew-multiprocessing-no-fork"><em>an option to avoid using os.fork
on Unix</em></a> (<a class="reference external" href="https://bugs.python.org/issue8713">issue 8713</a>).</li>
<li><a class="reference internal" href="../library/email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages, including MIME documents."><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> has a new submodule, <a class="reference internal" href="../library/email.contentmanager.html#module-email.contentmanager" title="email.contentmanager: Storing and Retrieving Content from MIME Parts"><tt class="xref py py-mod docutils literal"><span class="pre">contentmanager</span></tt></a>, and
a new <a class="reference internal" href="../library/email.message.html#email.message.Message" title="email.message.Message"><tt class="xref py py-mod docutils literal"><span class="pre">Message</span></tt></a> subclass
(<tt class="xref py py-class docutils literal"><span class="pre">EmailMessage</span></tt>) that <a class="reference internal" href="#whatsnew-email-contentmanager"><em>simplify MIME
handling</em></a> (<a class="reference external" href="https://bugs.python.org/issue18891">issue 18891</a>).</li>
<li>The <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><tt class="xref py py-mod docutils literal"><span class="pre">inspect</span></tt></a> and <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a> modules are now capable of
correct introspection of a much wider variety of callable objects,
which improves the output of the Python <a class="reference internal" href="../library/functions.html#help" title="help"><tt class="xref py py-func docutils literal"><span class="pre">help()</span></tt></a> system.</li>
<li>The <a class="reference internal" href="../library/ipaddress.html#module-ipaddress" title="ipaddress: IPv4/IPv6 manipulation library."><tt class="xref py py-mod docutils literal"><span class="pre">ipaddress</span></tt></a> module API has been declared stable</li>
</ul>
<p>Security improvements:</p>
<ul class="simple">
<li><a class="reference internal" href="#whatsnew-pep-456"><em>Secure and interchangeable hash algorithm</em></a>
(<span class="target" id="index-13"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0456"><strong>PEP 456</strong></a>).</li>
<li><a class="reference internal" href="#whatsnew-pep-446"><em>Make newly created file descriptors non-inheritable</em></a>
(<span class="target" id="index-14"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0446"><strong>PEP 446</strong></a>) to avoid leaking file descriptors to child processes.</li>
<li>New command line option for <a class="reference internal" href="#whatsnew-isolated-mode"><em>isolated mode</em></a>,
(<a class="reference external" href="https://bugs.python.org/issue16499">issue 16499</a>).</li>
<li><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><tt class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></tt></a> now has <a class="reference internal" href="#whatsnew-multiprocessing-no-fork"><em>an option to avoid using os.fork
on Unix</em></a>.  <em>spawn</em> and <em>forkserver</em> are
more secure because they avoid sharing data with child processes.</li>
<li><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><tt class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></tt></a> child processes on Windows no longer inherit
all of the parent&#8217;s inheritable handles, only the necessary ones.</li>
<li>A new <a class="reference internal" href="../library/hashlib.html#hashlib.pbkdf2_hmac" title="hashlib.pbkdf2_hmac"><tt class="xref py py-func docutils literal"><span class="pre">hashlib.pbkdf2_hmac()</span></tt></a> function provides
the <a class="reference external" href="http://en.wikipedia.org/wiki/PBKDF2">PKCS#5 password-based key derivation function 2</a>.</li>
<li><a class="reference internal" href="#whatsnew-tls-11-12"><em>TLSv1.1 and TLSv1.2 support</em></a> for <a class="reference internal" href="../library/ssl.html#module-ssl" title="ssl: TLS/SSL wrapper for socket objects"><tt class="xref py py-mod docutils literal"><span class="pre">ssl</span></tt></a>.</li>
<li><a class="reference internal" href="#whatsnew34-win-cert-store"><em>Retrieving certificates from the Windows system cert store support</em></a> for <a class="reference internal" href="../library/ssl.html#module-ssl" title="ssl: TLS/SSL wrapper for socket objects"><tt class="xref py py-mod docutils literal"><span class="pre">ssl</span></tt></a>.</li>
<li><a class="reference internal" href="#whatsnew34-sni"><em>Server-side SNI (Server Name Indication) support</em></a> for <a class="reference internal" href="../library/ssl.html#module-ssl" title="ssl: TLS/SSL wrapper for socket objects"><tt class="xref py py-mod docutils literal"><span class="pre">ssl</span></tt></a>.</li>
<li>The <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">ssl.SSLContext</span></tt></a> class has a <a class="reference internal" href="#whatsnew34-sslcontext"><em>lot of improvements</em></a>.</li>
<li>All modules in the standard library that support SSL now support server
certificate verification, including hostname matching
(<a class="reference internal" href="../library/ssl.html#ssl.match_hostname" title="ssl.match_hostname"><tt class="xref py py-func docutils literal"><span class="pre">ssl.match_hostname()</span></tt></a>) and CRLs (Certificate Revocation lists, see
<a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_verify_locations" title="ssl.SSLContext.load_verify_locations"><tt class="xref py py-func docutils literal"><span class="pre">ssl.SSLContext.load_verify_locations()</span></tt></a>).</li>
</ul>
<p>CPython implementation improvements:</p>
<ul class="simple">
<li><a class="reference internal" href="#whatsnew-pep-442"><em>Safe object finalization</em></a> (<span class="target" id="index-15"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0442"><strong>PEP 442</strong></a>).</li>
<li>Leveraging <span class="target" id="index-16"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0442"><strong>PEP 442</strong></a>, in most cases <a class="reference internal" href="#whatsnew-pep-442"><em>module globals are no longer set
to None during finalization</em></a> (<a class="reference external" href="https://bugs.python.org/issue18214">issue 18214</a>).</li>
<li><a class="reference internal" href="#whatsnew-pep-445"><em>Configurable memory allocators</em></a> (<span class="target" id="index-17"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0445"><strong>PEP 445</strong></a>).</li>
<li><a class="reference internal" href="#whatsnew-pep-436"><em>Argument Clinic</em></a> (<span class="target" id="index-18"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0436"><strong>PEP 436</strong></a>).</li>
</ul>
<p>Please read on for a comprehensive list of user-facing changes, including many
other smaller improvements, CPython optimizations, deprecations, and potential
porting issues.</p>
</div>
<div class="section" id="new-features">
<h2>New Features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pep-453-explicit-bootstrapping-of-pip-in-python-installations">
<span id="whatsnew-pep-453"></span><h3>PEP 453: Explicit Bootstrapping of PIP in Python Installations<a class="headerlink" href="#pep-453-explicit-bootstrapping-of-pip-in-python-installations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="bootstrapping-pip-by-default">
<h4>Bootstrapping pip By Default<a class="headerlink" href="#bootstrapping-pip-by-default" title="Permalink to this headline">¶</a></h4>
<p>The new <a class="reference internal" href="../library/ensurepip.html#module-ensurepip" title="ensurepip: Bootstrapping the &quot;pip&quot; installer into an existing Python installation or virtual environment."><tt class="xref py py-mod docutils literal"><span class="pre">ensurepip</span></tt></a> module (defined in <span class="target" id="index-19"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a>) provides a standard
cross-platform mechanism to bootstrap the pip installer into Python
installations and virtual environments. The version of <tt class="docutils literal"><span class="pre">pip</span></tt> included
with Python 3.4.0 is <tt class="docutils literal"><span class="pre">pip</span></tt> 1.5.4, and future 3.4.x maintenance releases
will update the bundled version to the latest version of <tt class="docutils literal"><span class="pre">pip</span></tt> that is
available at the time of creating the release candidate.</p>
<p>By default, the commands <tt class="docutils literal"><span class="pre">pipX</span></tt> and <tt class="docutils literal"><span class="pre">pipX.Y</span></tt> will be installed on all
platforms (where X.Y stands for the version of the Python installation),
along with the <tt class="docutils literal"><span class="pre">pip</span></tt> Python package and its dependencies. On Windows and
in virtual environments on all platforms, the unversioned <tt class="docutils literal"><span class="pre">pip</span></tt> command
will also be installed. On other platforms, the system wide unversioned
<tt class="docutils literal"><span class="pre">pip</span></tt> command typically refers to the separately installed Python 2
version.</p>
<p>The <a class="reference internal" href="../using/scripts.html#scripts-pyvenv"><em>pyvenv</em></a> command line utility and the <a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><tt class="xref py py-mod docutils literal"><span class="pre">venv</span></tt></a>
module make use of the <a class="reference internal" href="../library/ensurepip.html#module-ensurepip" title="ensurepip: Bootstrapping the &quot;pip&quot; installer into an existing Python installation or virtual environment."><tt class="xref py py-mod docutils literal"><span class="pre">ensurepip</span></tt></a> module to make <tt class="docutils literal"><span class="pre">pip</span></tt> readily
available in virtual environments. When using the command line utility,
<tt class="docutils literal"><span class="pre">pip</span></tt> is installed by default, while when using the <a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><tt class="xref py py-mod docutils literal"><span class="pre">venv</span></tt></a> module
<a class="reference internal" href="../library/venv.html#venv-api"><em>API</em></a> installation of <tt class="docutils literal"><span class="pre">pip</span></tt> must be requested explicitly.</p>
<p>For CPython <a class="reference internal" href="../using/unix.html#building-python-on-unix"><em>source builds on POSIX systems</em></a>,
the <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span></tt> and <tt class="docutils literal"><span class="pre">make</span> <span class="pre">altinstall</span></tt> commands bootstrap <tt class="docutils literal"><span class="pre">pip</span></tt> by
default.  This behaviour can be controlled through configure options, and
overridden through Makefile options.</p>
<p>On Windows and Mac OS X, the CPython installers now default to installing
<tt class="docutils literal"><span class="pre">pip</span></tt> along with CPython itself (users may opt out of installing it
during the installation process). Window users will need to opt in to the
automatic <tt class="docutils literal"><span class="pre">PATH</span></tt> modifications to have <tt class="docutils literal"><span class="pre">pip</span></tt> available from the command
line by default, otherwise it can still be accessed through the Python
launcher for Windows as <tt class="docutils literal"><span class="pre">py</span> <span class="pre">-m</span> <span class="pre">pip</span></tt>.</p>
<p>As <a class="reference external" href="https://www.python.org/dev/peps/pep-0453/#recommendations-for-downstream-distributors">discussed in the PEP</a>, platform packagers may choose not to install
these commands by default, as long as, when invoked, they provide clear and
simple directions on how to install them on that platform (usually using
the system package manager).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To avoid conflicts between parallel Python 2 and Python 3 installations,
only the versioned <tt class="docutils literal"><span class="pre">pip3</span></tt> and <tt class="docutils literal"><span class="pre">pip3.4</span></tt> commands are bootstrapped by
default when <tt class="docutils literal"><span class="pre">ensurepip</span></tt> is invoked directly - the <tt class="docutils literal"><span class="pre">--default-pip</span></tt>
option is needed to also request the unversioned <tt class="docutils literal"><span class="pre">pip</span></tt> command.
<tt class="docutils literal"><span class="pre">pyvenv</span></tt> and the Windows installer ensure that the unqualified <tt class="docutils literal"><span class="pre">pip</span></tt>
command is made available in those environments, and <tt class="docutils literal"><span class="pre">pip</span></tt> can always be
invoked via the <tt class="docutils literal"><span class="pre">-m</span></tt> switch rather than directly to avoid ambiguity on
systems with multiple Python installations.</p>
</div>
</div>
<div class="section" id="documentation-changes">
<h4>Documentation Changes<a class="headerlink" href="#documentation-changes" title="Permalink to this headline">¶</a></h4>
<p>As part of this change, the <a class="reference internal" href="../installing/index.html#installing-index"><em>Installing Python Modules</em></a> and
<a class="reference internal" href="../distributing/index.html#distributing-index"><em>Distributing Python Modules</em></a> sections of the documentation have been
completely redesigned as short getting started and FAQ documents. Most
packaging documentation has now been moved out to the Python Packaging
Authority maintained <a class="reference external" href="https://packaging.python.org">Python Packaging User Guide</a> and the documentation of the individual
projects.</p>
<p>However, as this migration is currently still incomplete, the legacy
versions of those guides remaining available as <a class="reference internal" href="../install/index.html#install-index"><em>Installing Python Modules (Legacy version)</em></a>
and <a class="reference internal" href="../distutils/index.html#distutils-index"><em>Distributing Python Modules (Legacy version)</em></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-20"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a> &#8211; Explicit bootstrapping of pip in Python installations</dt>
<dd>PEP written by Donald Stufft and Nick Coghlan, implemented by
Donald Stufft, Nick Coghlan, Martin von Löwis and Ned Deily.</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="pep-446-newly-created-file-descriptors-are-non-inheritable">
<span id="whatsnew-pep-446"></span><h3>PEP 446: Newly Created File Descriptors Are Non-Inheritable<a class="headerlink" href="#pep-446-newly-created-file-descriptors-are-non-inheritable" title="Permalink to this headline">¶</a></h3>
<p><span class="target" id="index-21"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0446"><strong>PEP 446</strong></a> makes newly created file descriptors <a class="reference internal" href="../library/os.html#fd-inheritance"><em>non-inheritable</em></a>.  In general, this is the behavior an application will
want: when launching a new process, having currently open files also
open in the new process can lead to all sorts of hard to find bugs,
and potentially to security issues.</p>
<p>However, there are occasions when inheritance is desired.  To support
these cases, the following new functions and methods are available:</p>
<ul class="simple">
<li><a class="reference internal" href="../library/os.html#os.get_inheritable" title="os.get_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.get_inheritable()</span></tt></a>, <a class="reference internal" href="../library/os.html#os.set_inheritable" title="os.set_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.set_inheritable()</span></tt></a></li>
<li><a class="reference internal" href="../library/os.html#os.get_handle_inheritable" title="os.get_handle_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.get_handle_inheritable()</span></tt></a>, <a class="reference internal" href="../library/os.html#os.set_handle_inheritable" title="os.set_handle_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.set_handle_inheritable()</span></tt></a></li>
<li><a class="reference internal" href="../library/socket.html#socket.socket.get_inheritable" title="socket.socket.get_inheritable"><tt class="xref py py-meth docutils literal"><span class="pre">socket.socket.get_inheritable()</span></tt></a>, <a class="reference internal" href="../library/socket.html#socket.socket.set_inheritable" title="socket.socket.set_inheritable"><tt class="xref py py-meth docutils literal"><span class="pre">socket.socket.set_inheritable()</span></tt></a></li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-22"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0446"><strong>PEP 446</strong></a> &#8211; Make newly created file descriptors non-inheritable</dt>
<dd>PEP written and implemented by Victor Stinner.</dd>
</dl>
</div>
</div>
<div class="section" id="improvements-to-codec-handling">
<span id="codec-handling-improvements"></span><h3>Improvements to Codec Handling<a class="headerlink" href="#improvements-to-codec-handling" title="Permalink to this headline">¶</a></h3>
<p>Since it was first introduced, the <a class="reference internal" href="../library/codecs.html#module-codecs" title="codecs: Encode and decode data and streams."><tt class="xref py py-mod docutils literal"><span class="pre">codecs</span></tt></a> module has always been
intended to operate as a type-neutral dynamic encoding and decoding
system. However, its close coupling with the Python text model, especially
the type restricted convenience methods on the builtin <a class="reference internal" href="../library/stdtypes.html#str" title="str"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></a>,
<a class="reference internal" href="../library/functions.html#bytes" title="bytes"><tt class="xref py py-class docutils literal"><span class="pre">bytes</span></tt></a> and <a class="reference internal" href="../library/functions.html#bytearray" title="bytearray"><tt class="xref py py-class docutils literal"><span class="pre">bytearray</span></tt></a> types, has historically obscured that
fact.</p>
<p>As a key step in clarifying the situation, the <a class="reference internal" href="../library/codecs.html#codecs.encode" title="codecs.encode"><tt class="xref py py-meth docutils literal"><span class="pre">codecs.encode()</span></tt></a> and
<a class="reference internal" href="../library/codecs.html#codecs.decode" title="codecs.decode"><tt class="xref py py-meth docutils literal"><span class="pre">codecs.decode()</span></tt></a> convenience functions are now properly documented in
Python 2.7, 3.3 and 3.4. These functions have existed in the <a class="reference internal" href="../library/codecs.html#module-codecs" title="codecs: Encode and decode data and streams."><tt class="xref py py-mod docutils literal"><span class="pre">codecs</span></tt></a>
module (and have been covered by the regression test suite) since Python 2.4,
but were previously only discoverable through runtime introspection.</p>
<p>Unlike the convenience methods on <a class="reference internal" href="../library/stdtypes.html#str" title="str"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt></a>, <a class="reference internal" href="../library/functions.html#bytes" title="bytes"><tt class="xref py py-class docutils literal"><span class="pre">bytes</span></tt></a> and
<a class="reference internal" href="../library/functions.html#bytearray" title="bytearray"><tt class="xref py py-class docutils literal"><span class="pre">bytearray</span></tt></a>, the <a class="reference internal" href="../library/codecs.html#module-codecs" title="codecs: Encode and decode data and streams."><tt class="xref py py-mod docutils literal"><span class="pre">codecs</span></tt></a> convenience functions support arbitrary
codecs in both Python 2 and Python 3, rather than being limited to Unicode text
encodings (in Python 3) or <tt class="docutils literal"><span class="pre">basestring</span></tt> &lt;-&gt; <tt class="docutils literal"><span class="pre">basestring</span></tt> conversions (in
Python 2).</p>
<p>In Python 3.4, the interpreter is able to identify the known non-text
encodings provided in the standard library and direct users towards these
general purpose convenience functions when appropriate:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="s">&quot;abcdef&quot;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;hex&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">LookupError</span>: <span class="n">&#39;hex&#39; is not a text encoding; use codecs.decode() to handle arbitrary codecs</span>

<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;hello&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;rot13&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">LookupError</span>: <span class="n">&#39;rot13&#39; is not a text encoding; use codecs.encode() to handle arbitrary codecs</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;foo.txt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;hex&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">LookupError</span>: <span class="n">&#39;hex&#39; is not a text encoding; use codecs.open() to handle arbitrary codecs</span>
</pre></div>
</div>
<p>In a related change, whenever it is feasible without breaking backwards
compatibility, exceptions raised during encoding and decoding operations
are wrapped in a chained exception of the same type that mentions the
name of the codec responsible for producing the error:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">codecs</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">codecs</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;abcdefgh&quot;</span><span class="p">,</span> <span class="s">&quot;hex&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;/usr/lib/python3.4/encodings/hex_codec.py&quot;</span>, line <span class="m">20</span>, in <span class="n">hex_decode</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">a2b_hex</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
<span class="gr">binascii.Error</span>: <span class="n">Non-hexadecimal digit found</span>

<span class="go">The above exception was the direct cause of the following exception:</span>

<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">binascii.Error</span>: <span class="n">decoding with &#39;hex&#39; codec failed (Error: Non-hexadecimal digit found)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">codecs</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="s">&quot;bz2&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;/usr/lib/python3.4/encodings/bz2_codec.py&quot;</span>, line <span class="m">17</span>, in <span class="n">bz2_encode</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">bz2</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
  File <span class="nb">&quot;/usr/lib/python3.4/bz2.py&quot;</span>, line <span class="m">498</span>, in <span class="n">compress</span>
    <span class="k">return</span> <span class="n">comp</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="n">comp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="gr">TypeError</span>: <span class="n">&#39;str&#39; does not support the buffer interface</span>

<span class="go">The above exception was the direct cause of the following exception:</span>

<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">TypeError</span>: <span class="n">encoding with &#39;bz2&#39; codec failed (TypeError: &#39;str&#39; does not support the buffer interface)</span>
</pre></div>
</div>
<p>Finally, as the examples above show, these improvements have permitted
the restoration of the convenience aliases for the non-Unicode codecs that
were themselves restored in Python 3.2. This means that encoding binary data
to and from its hexadecimal representation (for example) can now be written
as:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">codecs</span> <span class="k">import</span> <span class="n">encode</span><span class="p">,</span> <span class="n">decode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encode</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="s">&quot;hex&quot;</span><span class="p">)</span>
<span class="go">b&#39;68656c6c6f&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decode</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;68656c6c6f&quot;</span><span class="p">,</span> <span class="s">&quot;hex&quot;</span><span class="p">)</span>
<span class="go">b&#39;hello&#39;</span>
</pre></div>
</div>
<p>The binary and text transforms provided in the standard library are detailed
in <a class="reference internal" href="../library/codecs.html#binary-transforms"><em>Binary Transforms</em></a> and <a class="reference internal" href="../library/codecs.html#text-transforms"><em>Text Transforms</em></a>.</p>
<p>(Contributed by Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue7475">issue 7475</a>, <a class="reference external" href="https://bugs.python.org/issue17827">issue 17827</a>,
<a class="reference external" href="https://bugs.python.org/issue17828">issue 17828</a> and <a class="reference external" href="https://bugs.python.org/issue19619">issue 19619</a>.)</p>
</div>
<div class="section" id="pep-451-a-modulespec-type-for-the-import-system">
<span id="whatsnew-pep-451"></span><h3>PEP 451: A ModuleSpec Type for the Import System<a class="headerlink" href="#pep-451-a-modulespec-type-for-the-import-system" title="Permalink to this headline">¶</a></h3>
<p><span class="target" id="index-23"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0451"><strong>PEP 451</strong></a> provides an encapsulation of the information about a module that the
import machinery will use to load it (that is, a module specification).  This
helps simplify both the import implementation and several import-related APIs.
The change is also a stepping stone for <a class="reference external" href="https://mail.python.org/pipermail/python-dev/2013-November/130111.html">several future import-related
improvements</a>.</p>
<p>The public-facing changes from the PEP are entirely backward-compatible.
Furthermore, they should be transparent to everyone but importer authors.  Key
finder and loader methods have been deprecated, but they will continue working.
New importers should use the new methods described in the PEP.  Existing
importers should be updated to implement the new methods.  See the
<a class="reference internal" href="#deprecated-3-4"><em>Deprecated</em></a> section for a list of methods that should be replaced and
their replacements.</p>
</div>
<div class="section" id="other-language-changes">
<h3>Other Language Changes<a class="headerlink" href="#other-language-changes" title="Permalink to this headline">¶</a></h3>
<p>Some smaller changes made to the core Python language are:</p>
<ul class="simple">
<li>Unicode database updated to UCD version 6.3.</li>
<li><a class="reference internal" href="../library/functions.html#min" title="min"><tt class="xref py py-func docutils literal"><span class="pre">min()</span></tt></a> and <a class="reference internal" href="../library/functions.html#max" title="max"><tt class="xref py py-func docutils literal"><span class="pre">max()</span></tt></a> now accept a <em>default</em> keyword-only argument that
can be used to specify the value they return if the iterable they are
evaluating has no elements.  (Contributed by Julian Berman in
<a class="reference external" href="https://bugs.python.org/issue18111">issue 18111</a>.)</li>
<li>Module objects are now <a class="reference internal" href="../library/weakref.html#module-weakref" title="weakref: Support for weak references and weak dictionaries."><tt class="xref py py-mod docutils literal"><span class="pre">weakref</span></tt></a>&#8216;able.</li>
<li>Module <tt class="docutils literal"><span class="pre">__file__</span></tt> attributes (and related values) should now always
contain absolute paths by default, with the sole exception of
<tt class="docutils literal"><span class="pre">__main__.__file__</span></tt> when a script has been executed directly using
a relative path.  (Contributed by Brett Cannon in <a class="reference external" href="https://bugs.python.org/issue18416">issue 18416</a>.)</li>
<li>All the UTF-* codecs (except UTF-7) now reject surrogates during both
encoding and decoding unless the <tt class="docutils literal"><span class="pre">surrogatepass</span></tt> error handler is used,
with the exception of the UTF-16 decoder (which accepts valid surrogate pairs)
and the UTF-16 encoder (which produces them while encoding non-BMP characters).
(Contributed by Victor Stinner, Kang-Hao (Kenny) Lu and Serhiy Storchaka in
<a class="reference external" href="https://bugs.python.org/issue12892">issue 12892</a>.)</li>
<li>New German EBCDIC <a class="reference internal" href="../library/codecs.html#standard-encodings"><em>codec</em></a> <tt class="docutils literal"><span class="pre">cp273</span></tt>.  (Contributed
by Michael Bierenfeld and Andrew Kuchling in <a class="reference external" href="https://bugs.python.org/issue1097797">issue 1097797</a>.)</li>
<li>New Ukrainian <a class="reference internal" href="../library/codecs.html#standard-encodings"><em>codec</em></a> <tt class="docutils literal"><span class="pre">cp1125</span></tt>.  (Contributed by
Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue19668">issue 19668</a>.)</li>
<li><a class="reference internal" href="../library/functions.html#bytes" title="bytes"><tt class="xref py py-class docutils literal"><span class="pre">bytes</span></tt></a>.join() and <a class="reference internal" href="../library/functions.html#bytearray" title="bytearray"><tt class="xref py py-class docutils literal"><span class="pre">bytearray</span></tt></a>.join() now accept arbitrary
buffer objects as arguments.  (Contributed by Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue15958">issue 15958</a>.)</li>
<li>The <a class="reference internal" href="../library/functions.html#int" title="int"><tt class="xref py py-class docutils literal"><span class="pre">int</span></tt></a> constructor now accepts any object that has an <tt class="docutils literal"><span class="pre">__index__</span></tt>
method for its <em>base</em> argument.  (Contributed by Mark Dickinson in
<a class="reference external" href="https://bugs.python.org/issue16772">issue 16772</a>.)</li>
<li>Frame objects now have a <a class="reference internal" href="../reference/datamodel.html#frame.clear" title="frame.clear"><tt class="xref py py-func docutils literal"><span class="pre">clear()</span></tt></a> method that clears all
references to local variables from the frame.  (Contributed by Antoine Pitrou
in <a class="reference external" href="https://bugs.python.org/issue17934">issue 17934</a>.)</li>
<li><a class="reference internal" href="../library/stdtypes.html#memoryview" title="memoryview"><tt class="xref py py-class docutils literal"><span class="pre">memoryview</span></tt></a> is now registered as a <a class="reference internal" href="../library/collections.abc.html#module-collections.abc" title="collections.abc: Abstract base classes for containers"><tt class="xref py py-class docutils literal"><span class="pre">Sequence</span></tt></a>,
and supports the <a class="reference internal" href="../library/functions.html#reversed" title="reversed"><tt class="xref py py-func docutils literal"><span class="pre">reversed()</span></tt></a> builtin.  (Contributed by Nick Coghlan
and Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue18690">issue 18690</a> and <a class="reference external" href="https://bugs.python.org/issue19078">issue 19078</a>.)</li>
<li>Signatures reported by <a class="reference internal" href="../library/functions.html#help" title="help"><tt class="xref py py-func docutils literal"><span class="pre">help()</span></tt></a> have been modified and improved in
several cases as a result of the introduction of Argument Clinic and other
changes to the <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><tt class="xref py py-mod docutils literal"><span class="pre">inspect</span></tt></a> and <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a> modules.</li>
<li><a class="reference internal" href="../reference/datamodel.html#object.__length_hint__" title="object.__length_hint__"><tt class="xref py py-meth docutils literal"><span class="pre">__length_hint__()</span></tt></a> is now part of the formal language
specification (see <span class="target" id="index-24"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0424"><strong>PEP 424</strong></a>).  (Contributed by Armin Ronacher in
<a class="reference external" href="https://bugs.python.org/issue16148">issue 16148</a>.)</li>
</ul>
</div>
</div>
<div class="section" id="new-modules">
<h2>New Modules<a class="headerlink" href="#new-modules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="asyncio">
<span id="whatsnew-asyncio"></span><h3>asyncio<a class="headerlink" href="#asyncio" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O, event loop, coroutines and tasks."><tt class="xref py py-mod docutils literal"><span class="pre">asyncio</span></tt></a> module (defined in <span class="target" id="index-25"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-3156"><strong>PEP 3156</strong></a>) provides a standard
pluggable event loop model for Python, providing solid asynchronous IO
support in the standard library, and making it easier for other event loop
implementations to interoperate with the standard library and each other.</p>
<p>For Python 3.4, this module is considered a <a class="reference internal" href="../glossary.html#term-provisional-api"><em class="xref std std-term">provisional API</em></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-26"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-3156"><strong>PEP 3156</strong></a> &#8211; Asynchronous IO Support Rebooted: the &#8220;asyncio&#8221; Module</dt>
<dd>PEP written and implementation led by Guido van Rossum.</dd>
</dl>
</div>
</div>
<div class="section" id="ensurepip">
<span id="whatsnew-ensurepip"></span><h3>ensurepip<a class="headerlink" href="#ensurepip" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/ensurepip.html#module-ensurepip" title="ensurepip: Bootstrapping the &quot;pip&quot; installer into an existing Python installation or virtual environment."><tt class="xref py py-mod docutils literal"><span class="pre">ensurepip</span></tt></a> module is the primary infrastructure for the
<span class="target" id="index-27"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a> implementation.  In the normal course of events end users will not
need to interact with this module, but it can be used to manually bootstrap
<tt class="docutils literal"><span class="pre">pip</span></tt> if the automated bootstrapping into an installation or virtual
environment was declined.</p>
<p><a class="reference internal" href="../library/ensurepip.html#module-ensurepip" title="ensurepip: Bootstrapping the &quot;pip&quot; installer into an existing Python installation or virtual environment."><tt class="xref py py-mod docutils literal"><span class="pre">ensurepip</span></tt></a> includes a bundled copy of <tt class="docutils literal"><span class="pre">pip</span></tt>, up-to-date as of the first
release candidate of the release of CPython with which it ships (this applies
to both maintenance releases and feature releases).  <tt class="docutils literal"><span class="pre">ensurepip</span></tt> does not
access the internet.  If the installation has Internet access, after
<tt class="docutils literal"><span class="pre">ensurepip</span></tt> is run the bundled <tt class="docutils literal"><span class="pre">pip</span></tt> can be used to upgrade <tt class="docutils literal"><span class="pre">pip</span></tt> to a
more recent release than the bundled one.  (Note that such an upgraded version
of <tt class="docutils literal"><span class="pre">pip</span></tt> is considered to be a separately installed package and will not be
removed if Python is uninstalled.)</p>
<p>The module is named <em>ensure</em>pip because if called when <tt class="docutils literal"><span class="pre">pip</span></tt> is already
installed, it does nothing.  It also has an <tt class="docutils literal"><span class="pre">--upgrade</span></tt> option that will
cause it to install the bundled copy of <tt class="docutils literal"><span class="pre">pip</span></tt> if the existing installed
version of <tt class="docutils literal"><span class="pre">pip</span></tt> is older than the bundled copy.</p>
</div>
<div class="section" id="enum">
<span id="whatsnew-enum"></span><h3>enum<a class="headerlink" href="#enum" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/enum.html#module-enum" title="enum: Implementation of an enumeration class."><tt class="xref py py-mod docutils literal"><span class="pre">enum</span></tt></a> module (defined in <span class="target" id="index-28"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0435"><strong>PEP 435</strong></a>) provides a standard
implementation of enumeration types, allowing other modules (such as
<a class="reference internal" href="../library/socket.html#module-socket" title="socket: Low-level networking interface."><tt class="xref py py-mod docutils literal"><span class="pre">socket</span></tt></a>) to provide more informative error messages and better
debugging support by replacing opaque integer constants with backwards
compatible enumeration values.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-29"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0435"><strong>PEP 435</strong></a> &#8211; Adding an Enum type to the Python standard library</dt>
<dd>PEP written by Barry Warsaw, Eli Bendersky and Ethan Furman,
implemented by Ethan Furman.</dd>
</dl>
</div>
</div>
<div class="section" id="pathlib">
<span id="whatsnew-pathlib"></span><h3>pathlib<a class="headerlink" href="#pathlib" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/pathlib.html#module-pathlib" title="pathlib: Object-oriented filesystem paths"><tt class="xref py py-mod docutils literal"><span class="pre">pathlib</span></tt></a> module offers classes representing filesystem paths
with semantics appropriate for different operating systems.  Path classes are
divided between <em>pure paths</em>, which provide purely computational operations
without I/O, and <em>concrete paths</em>, which inherit from pure paths but also
provide I/O operations.</p>
<p>For Python 3.4, this module is considered a <a class="reference internal" href="../glossary.html#term-provisional-api"><em class="xref std std-term">provisional API</em></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-30"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0428"><strong>PEP 428</strong></a> &#8211; The pathlib module &#8211; object-oriented filesystem paths</dt>
<dd>PEP written and implemented by Antoine Pitrou.</dd>
</dl>
</div>
</div>
<div class="section" id="selectors">
<span id="whatsnew-selectors"></span><h3>selectors<a class="headerlink" href="#selectors" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/selectors.html#module-selectors" title="selectors: High-level I/O multiplexing."><tt class="xref py py-mod docutils literal"><span class="pre">selectors</span></tt></a> module (created as part of implementing <span class="target" id="index-31"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-3156"><strong>PEP 3156</strong></a>)
allows high-level and efficient I/O multiplexing, built upon the
<a class="reference internal" href="../library/select.html#module-select" title="select: Wait for I/O completion on multiple streams."><tt class="xref py py-mod docutils literal"><span class="pre">select</span></tt></a> module primitives.</p>
</div>
<div class="section" id="statistics">
<span id="whatsnew-statistics"></span><h3>statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/statistics.html#module-statistics" title="statistics: mathematical statistics functions"><tt class="xref py py-mod docutils literal"><span class="pre">statistics</span></tt></a> module (defined in <span class="target" id="index-32"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0450"><strong>PEP 450</strong></a>) offers some core
statistics functionality directly in the standard library. This module
supports calculation of the mean, median, mode, variance and standard
deviation of a data series.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-33"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0450"><strong>PEP 450</strong></a> &#8211; Adding A Statistics Module To The Standard Library</dt>
<dd>PEP written and implemented by Steven D&#8217;Aprano</dd>
</dl>
</div>
</div>
<div class="section" id="tracemalloc">
<span id="whatsnew-tracemalloc"></span><h3>tracemalloc<a class="headerlink" href="#tracemalloc" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/tracemalloc.html#module-tracemalloc" title="tracemalloc: Trace memory allocations."><tt class="xref py py-mod docutils literal"><span class="pre">tracemalloc</span></tt></a> module (defined in <span class="target" id="index-34"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0454"><strong>PEP 454</strong></a>) is a debug tool to
trace memory blocks allocated by Python. It provides the following information:</p>
<ul class="simple">
<li>Trace where an object was allocated</li>
<li>Statistics on allocated memory blocks per filename and per line number:
total size, number and average size of allocated memory blocks</li>
<li>Compute the differences between two snapshots to detect memory leaks</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-35"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0454"><strong>PEP 454</strong></a> &#8211; Add a new tracemalloc module to trace Python memory allocations</dt>
<dd>PEP written and implemented by Victor Stinner</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="improved-modules">
<h2>Improved Modules<a class="headerlink" href="#improved-modules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="abc">
<h3>abc<a class="headerlink" href="#abc" title="Permalink to this headline">¶</a></h3>
<p>New function <a class="reference internal" href="../library/abc.html#abc.get_cache_token" title="abc.get_cache_token"><tt class="xref py py-func docutils literal"><span class="pre">abc.get_cache_token()</span></tt></a> can be used to know when to invalidate
caches that are affected by changes in the object graph.  (Contributed
by Łukasz Langa in <a class="reference external" href="https://bugs.python.org/issue16832">issue 16832</a>.)</p>
<p>New class <a class="reference internal" href="../library/abc.html#abc.ABC" title="abc.ABC"><tt class="xref py py-class docutils literal"><span class="pre">ABC</span></tt></a> has <a class="reference internal" href="../library/abc.html#abc.ABCMeta" title="abc.ABCMeta"><tt class="xref py py-class docutils literal"><span class="pre">ABCMeta</span></tt></a> as its meta class.
Using <tt class="docutils literal"><span class="pre">ABC</span></tt> as a base class has essentially the same effect as specifying
<tt class="docutils literal"><span class="pre">metaclass=abc.ABCMeta</span></tt>, but is simpler to type and easier to read.
(Contributed by Bruno Dupuis in <a class="reference external" href="https://bugs.python.org/issue16049">issue 16049</a>.)</p>
</div>
<div class="section" id="aifc">
<h3>aifc<a class="headerlink" href="#aifc" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/aifc.html#aifc.aifc.getparams" title="aifc.aifc.getparams"><tt class="xref py py-meth docutils literal"><span class="pre">getparams()</span></tt></a> method now returns a namedtuple rather than a
plain tuple.  (Contributed by Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue17818">issue 17818</a>.)</p>
<p><a class="reference internal" href="../library/aifc.html#aifc.open" title="aifc.open"><tt class="xref py py-func docutils literal"><span class="pre">aifc.open()</span></tt></a> now supports the context management protocol: when used in a
<a class="reference internal" href="../reference/compound_stmts.html#with"><tt class="xref std std-keyword docutils literal"><span class="pre">with</span></tt></a> block, the <a class="reference internal" href="../library/aifc.html#aifc.aifc.close" title="aifc.aifc.close"><tt class="xref py py-meth docutils literal"><span class="pre">close()</span></tt></a> method of the returned
object will be called automatically at the end of the block.  (Contributed by
Serhiy Storchacha in <a class="reference external" href="https://bugs.python.org/issue16486">issue 16486</a>.)</p>
<p>The <a class="reference internal" href="../library/aifc.html#aifc.aifc.writeframesraw" title="aifc.aifc.writeframesraw"><tt class="xref py py-meth docutils literal"><span class="pre">writeframesraw()</span></tt></a> and <a class="reference internal" href="../library/aifc.html#aifc.aifc.writeframes" title="aifc.aifc.writeframes"><tt class="xref py py-meth docutils literal"><span class="pre">writeframes()</span></tt></a>
methods now accept any <a class="reference internal" href="../glossary.html#term-bytes-like-object"><em class="xref std std-term">bytes-like object</em></a>.  (Contributed by Serhiy
Storchaka in <a class="reference external" href="https://bugs.python.org/issue8311">issue 8311</a>.)</p>
</div>
<div class="section" id="argparse">
<h3>argparse<a class="headerlink" href="#argparse" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/argparse.html#argparse.FileType" title="argparse.FileType"><tt class="xref py py-class docutils literal"><span class="pre">FileType</span></tt></a> class now accepts <em>encoding</em> and
<em>errors</em> arguments, which are passed through to <a class="reference internal" href="../library/functions.html#open" title="open"><tt class="xref py py-func docutils literal"><span class="pre">open()</span></tt></a>.  (Contributed
by Lucas Maystre in <a class="reference external" href="https://bugs.python.org/issue11175">issue 11175</a>.)</p>
</div>
<div class="section" id="audioop">
<h3>audioop<a class="headerlink" href="#audioop" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/audioop.html#module-audioop" title="audioop: Manipulate raw audio data."><tt class="xref py py-mod docutils literal"><span class="pre">audioop</span></tt></a> now supports 24-bit samples.  (Contributed by Serhiy Storchaka
in <a class="reference external" href="https://bugs.python.org/issue12866">issue 12866</a>.)</p>
<p>New <a class="reference internal" href="../library/audioop.html#audioop.byteswap" title="audioop.byteswap"><tt class="xref py py-func docutils literal"><span class="pre">byteswap()</span></tt></a> function converts big-endian samples to
little-endian and vice versa.  (Contributed by Serhiy Storchaka in
<a class="reference external" href="https://bugs.python.org/issue19641">issue 19641</a>.)</p>
<p>All <a class="reference internal" href="../library/audioop.html#module-audioop" title="audioop: Manipulate raw audio data."><tt class="xref py py-mod docutils literal"><span class="pre">audioop</span></tt></a> functions now accept any <a class="reference internal" href="../glossary.html#term-bytes-like-object"><em class="xref std std-term">bytes-like object</em></a>.  Strings
are not accepted: they didn&#8217;t work before, now they raise an error right away.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue16685">issue 16685</a>.)</p>
</div>
<div class="section" id="base64">
<h3>base64<a class="headerlink" href="#base64" title="Permalink to this headline">¶</a></h3>
<p>The encoding and decoding functions in <a class="reference internal" href="../library/base64.html#module-base64" title="base64: RFC 3548: Base16, Base32, Base64 Data Encodings; Base85 and Ascii85"><tt class="xref py py-mod docutils literal"><span class="pre">base64</span></tt></a> now accept any
<a class="reference internal" href="../glossary.html#term-bytes-like-object"><em class="xref std std-term">bytes-like object</em></a> in cases where it previously required a
<a class="reference internal" href="../library/functions.html#bytes" title="bytes"><tt class="xref py py-class docutils literal"><span class="pre">bytes</span></tt></a> or <a class="reference internal" href="../library/functions.html#bytearray" title="bytearray"><tt class="xref py py-class docutils literal"><span class="pre">bytearray</span></tt></a> instance.  (Contributed by Nick Coghlan in
<a class="reference external" href="https://bugs.python.org/issue17839">issue 17839</a>.)</p>
<p>New functions <a class="reference internal" href="../library/base64.html#base64.a85encode" title="base64.a85encode"><tt class="xref py py-func docutils literal"><span class="pre">a85encode()</span></tt></a>, <a class="reference internal" href="../library/base64.html#base64.a85decode" title="base64.a85decode"><tt class="xref py py-func docutils literal"><span class="pre">a85decode()</span></tt></a>,
<a class="reference internal" href="../library/base64.html#base64.b85encode" title="base64.b85encode"><tt class="xref py py-func docutils literal"><span class="pre">b85encode()</span></tt></a>, and <a class="reference internal" href="../library/base64.html#base64.b85decode" title="base64.b85decode"><tt class="xref py py-func docutils literal"><span class="pre">b85decode()</span></tt></a> provide the ability to
encode and decode binary data from and to <tt class="docutils literal"><span class="pre">Ascii85</span></tt> and the git/mercurial
<tt class="docutils literal"><span class="pre">Base85</span></tt> formats, respectively.  The <tt class="docutils literal"><span class="pre">a85</span></tt> functions have options that can
be used to make them compatible with the variants of the <tt class="docutils literal"><span class="pre">Ascii85</span></tt> encoding,
including the Adobe variant.  (Contributed by Martin Morrison, the Mercurial
project, Serhiy Storchaka, and Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue17618">issue 17618</a>.)</p>
</div>
<div class="section" id="collections">
<h3>collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/collections.html#collections.ChainMap.new_child" title="collections.ChainMap.new_child"><tt class="xref py py-meth docutils literal"><span class="pre">ChainMap.new_child()</span></tt></a> method now accepts an <em>m</em> argument specifying
the child map to add to the chain.  This allows an existing mapping and/or a
custom mapping type to be used for the child.  (Contributed by Vinay Sajip in
<a class="reference external" href="https://bugs.python.org/issue16613">issue 16613</a>.)</p>
</div>
<div class="section" id="colorsys">
<h3>colorsys<a class="headerlink" href="#colorsys" title="Permalink to this headline">¶</a></h3>
<p>The number of digits in the coefficients for the RGB &#8212; YIQ conversions have
been expanded so that they match the FCC NTSC versions.  The change in
results should be less than 1% and may better match results found elsewhere.
(Contributed by Brian Landers and Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue14323">issue 14323</a>.)</p>
</div>
<div class="section" id="contextlib">
<h3>contextlib<a class="headerlink" href="#contextlib" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/contextlib.html#contextlib.suppress" title="contextlib.suppress"><tt class="xref py py-class docutils literal"><span class="pre">contextlib.suppress</span></tt></a> context manager helps to clarify the
intent of code that deliberately suppresses exceptions from a single
statement.  (Contributed by Raymond Hettinger in <a class="reference external" href="https://bugs.python.org/issue15806">issue 15806</a> and
Zero Piraeus in <a class="reference external" href="https://bugs.python.org/issue19266">issue 19266</a>.)</p>
<p>The new <a class="reference internal" href="../library/contextlib.html#contextlib.redirect_stdout" title="contextlib.redirect_stdout"><tt class="xref py py-func docutils literal"><span class="pre">contextlib.redirect_stdout()</span></tt></a> context manager makes it easier
for utility scripts to handle inflexible APIs that write their output to
<a class="reference internal" href="../library/sys.html#sys.stdout" title="sys.stdout"><tt class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></tt></a> and don&#8217;t provide any options to redirect it.  Using the
context manager, the <a class="reference internal" href="../library/sys.html#sys.stdout" title="sys.stdout"><tt class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></tt></a> output can be redirected to any
other stream or, in conjunction with <a class="reference internal" href="../library/io.html#io.StringIO" title="io.StringIO"><tt class="xref py py-class docutils literal"><span class="pre">io.StringIO</span></tt></a>, to a string.
The latter can be especially useful, for example, to capture output
from a function that was written to implement a command line interface.
It is recommended only for utility scripts because it affects the
global state of <a class="reference internal" href="../library/sys.html#sys.stdout" title="sys.stdout"><tt class="xref py py-data docutils literal"><span class="pre">sys.stdout</span></tt></a>.  (Contributed by Raymond Hettinger
in <a class="reference external" href="https://bugs.python.org/issue15805">issue 15805</a>.)</p>
<p>The <a class="reference internal" href="../library/contextlib.html#module-contextlib" title="contextlib: Utilities for with-statement contexts."><tt class="xref py py-mod docutils literal"><span class="pre">contextlib</span></tt></a> documentation has also been updated to include a
<a class="reference internal" href="../library/contextlib.html#single-use-reusable-and-reentrant-cms"><em>discussion</em></a> of the
differences between single use, reusable and reentrant context managers.</p>
</div>
<div class="section" id="dbm">
<h3>dbm<a class="headerlink" href="#dbm" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/dbm.html#dbm.open" title="dbm.open"><tt class="xref py py-func docutils literal"><span class="pre">dbm.open()</span></tt></a> objects now support the context management protocol.  When
used in a <a class="reference internal" href="../reference/compound_stmts.html#with"><tt class="xref std std-keyword docutils literal"><span class="pre">with</span></tt></a> statement, the <tt class="docutils literal"><span class="pre">close</span></tt> method of the database
object will be called automatically at the end of the block.  (Contributed by
Claudiu Popa and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue19282">issue 19282</a>.)</p>
</div>
<div class="section" id="dis">
<h3>dis<a class="headerlink" href="#dis" title="Permalink to this headline">¶</a></h3>
<p>Functions <a class="reference internal" href="../library/dis.html#dis.show_code" title="dis.show_code"><tt class="xref py py-func docutils literal"><span class="pre">show_code()</span></tt></a>, <a class="reference internal" href="../library/dis.html#dis.dis" title="dis.dis"><tt class="xref py py-func docutils literal"><span class="pre">dis()</span></tt></a>, <a class="reference internal" href="../library/dis.html#dis.distb" title="dis.distb"><tt class="xref py py-func docutils literal"><span class="pre">distb()</span></tt></a>, and
<a class="reference internal" href="../library/dis.html#dis.disassemble" title="dis.disassemble"><tt class="xref py py-func docutils literal"><span class="pre">disassemble()</span></tt></a> now accept a keyword-only <em>file</em> argument that
controls where they write their output.</p>
<p>The <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><tt class="xref py py-mod docutils literal"><span class="pre">dis</span></tt></a> module is now built around an <a class="reference internal" href="../library/dis.html#dis.Instruction" title="dis.Instruction"><tt class="xref py py-class docutils literal"><span class="pre">Instruction</span></tt></a> class
that provides object oriented access to the details of each individual bytecode
operation.</p>
<p>A new method, <a class="reference internal" href="../library/dis.html#dis.get_instructions" title="dis.get_instructions"><tt class="xref py py-func docutils literal"><span class="pre">get_instructions()</span></tt></a>, provides an iterator that emits
the Instruction stream for a given piece of Python code.  Thus it is now
possible to write a program that inspects and manipulates a bytecode
object in ways different from those provided by the <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><tt class="xref py py-mod docutils literal"><span class="pre">dis</span></tt></a> module
itself.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">dis</span><span class="o">.</span><span class="n">get_instructions</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">opname</span><span class="p">)</span>
<span class="go">LOAD_FAST</span>
<span class="go">LOAD_CONST</span>
<span class="go">BINARY_ADD</span>
<span class="go">RETURN_VALUE</span>
</pre></div>
</div>
<p>The various display tools in the <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><tt class="xref py py-mod docutils literal"><span class="pre">dis</span></tt></a> module have been rewritten to use
these new components.</p>
<p>In addition, a new application-friendly class <a class="reference internal" href="../library/dis.html#dis.Bytecode" title="dis.Bytecode"><tt class="xref py py-class docutils literal"><span class="pre">Bytecode</span></tt></a> provides
an object-oriented API for inspecting bytecode in both in human-readable form
and for iterating over instructions.  The <a class="reference internal" href="../library/dis.html#dis.Bytecode" title="dis.Bytecode"><tt class="xref py py-class docutils literal"><span class="pre">Bytecode</span></tt></a> constructor
takes the same arguments that <tt class="xref py py-func docutils literal"><span class="pre">get_instruction()</span></tt> does (plus an
optional <em>current_offset</em>), and the resulting object can be iterated to produce
<a class="reference internal" href="../library/dis.html#dis.Instruction" title="dis.Instruction"><tt class="xref py py-class docutils literal"><span class="pre">Instruction</span></tt></a> objects.  But it also has a <a class="reference internal" href="../library/dis.html#dis.Bytecode.dis" title="dis.Bytecode.dis"><tt class="xref py py-mod docutils literal"><span class="pre">dis</span></tt></a>
method, equivalent to calling <a class="reference internal" href="../library/dis.html#dis.dis" title="dis.dis"><tt class="xref py py-mod docutils literal"><span class="pre">dis</span></tt></a> on the constructor argument, but
returned as a multi-line string:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">dis</span><span class="o">.</span><span class="n">Bytecode</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">current_offset</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="n">bytecode</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s">&#39;{} ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">opname</span><span class="p">,</span> <span class="n">instr</span><span class="o">.</span><span class="n">opcode</span><span class="p">))</span>
<span class="go">LOAD_FAST (124)</span>
<span class="go">LOAD_CONST (100)</span>
<span class="go">BINARY_ADD (23)</span>
<span class="go">RETURN_VALUE (83)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bytecode</span><span class="o">.</span><span class="n">dis</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>       
<span class="go">[&#39;  1           0 LOAD_FAST                0 (x)&#39;,</span>
<span class="go"> &#39;      --&gt;     3 LOAD_CONST               1 (1)&#39;,</span>
<span class="go"> &#39;              6 BINARY_ADD&#39;,</span>
<span class="go"> &#39;              7 RETURN_VALUE&#39;]</span>
</pre></div>
</div>
<p><a class="reference internal" href="../library/dis.html#dis.Bytecode" title="dis.Bytecode"><tt class="xref py py-class docutils literal"><span class="pre">Bytecode</span></tt></a> also has a class method,
<a class="reference internal" href="../library/dis.html#dis.Bytecode.from_traceback" title="dis.Bytecode.from_traceback"><tt class="xref py py-meth docutils literal"><span class="pre">from_traceback()</span></tt></a>, that provides the ability to manipulate a
traceback (that is, <tt class="docutils literal"><span class="pre">print(Bytecode.from_traceback(tb).dis())</span></tt> is equivalent
to <tt class="docutils literal"><span class="pre">distb(tb)</span></tt>).</p>
<p>(Contributed by Nick Coghlan, Ryan Kelly and Thomas Kluyver in <a class="reference external" href="https://bugs.python.org/issue11816">issue 11816</a>
and Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue17916">issue 17916</a>.)</p>
<p>New function <a class="reference internal" href="../library/dis.html#dis.stack_effect" title="dis.stack_effect"><tt class="xref py py-func docutils literal"><span class="pre">stack_effect()</span></tt></a> computes the effect on the Python stack
of a given opcode and argument, information that is not otherwise available.
(Contributed by Larry Hastings in <a class="reference external" href="https://bugs.python.org/issue19722">issue 19722</a>.)</p>
</div>
<div class="section" id="doctest">
<h3>doctest<a class="headerlink" href="#doctest" title="Permalink to this headline">¶</a></h3>
<p>A new <a class="reference internal" href="../library/doctest.html#doctest-options"><em>option flag</em></a>, <a class="reference internal" href="../library/doctest.html#doctest.FAIL_FAST" title="doctest.FAIL_FAST"><tt class="xref py py-data docutils literal"><span class="pre">FAIL_FAST</span></tt></a>, halts
test running as soon as the first failure is detected.  (Contributed by R.
David Murray and Daniel Urban in <a class="reference external" href="https://bugs.python.org/issue16522">issue 16522</a>.)</p>
<p>The <a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><tt class="xref py py-mod docutils literal"><span class="pre">doctest</span></tt></a> command line interface now uses <a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>, and has two
new options, <tt class="docutils literal"><span class="pre">-o</span></tt> and <tt class="docutils literal"><span class="pre">-f</span></tt>.  <tt class="docutils literal"><span class="pre">-o</span></tt> allows <a class="reference internal" href="../library/doctest.html#doctest-options"><em>doctest options</em></a> to be specified on the command line, and <tt class="docutils literal"><span class="pre">-f</span></tt> is a
shorthand for <tt class="docutils literal"><span class="pre">-o</span> <span class="pre">FAIL_FAST</span></tt> (to parallel the similar option supported by the
<a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><tt class="xref py py-mod docutils literal"><span class="pre">unittest</span></tt></a> CLI).  (Contributed by R. David Murray in <a class="reference external" href="https://bugs.python.org/issue11390">issue 11390</a>.)</p>
<p><a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><tt class="xref py py-mod docutils literal"><span class="pre">doctest</span></tt></a> will now find doctests in extension module <tt class="docutils literal"><span class="pre">__doc__</span></tt> strings.
(Contributed by Zachary Ware in <a class="reference external" href="https://bugs.python.org/issue3158">issue 3158</a>.)</p>
</div>
<div class="section" id="email">
<h3>email<a class="headerlink" href="#email" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/email.message.html#email.message.Message.as_string" title="email.message.Message.as_string"><tt class="xref py py-meth docutils literal"><span class="pre">as_string()</span></tt></a> now accepts a <em>policy</em> argument to
override the default policy of the message when generating a string
representation of it.  This means that <tt class="docutils literal"><span class="pre">as_string</span></tt> can now be used in more
circumstances, instead of having to create and use a <a class="reference internal" href="../library/email.generator.html#module-email.generator" title="email.generator: Generate flat text email messages from a message structure."><tt class="xref py py-mod docutils literal"><span class="pre">generator</span></tt></a> in
order to pass formatting parameters to its <tt class="docutils literal"><span class="pre">flatten</span></tt> method.  (Contributed by
R. David Murray in <a class="reference external" href="https://bugs.python.org/issue18600">issue 18600</a>.)</p>
<p>New method <a class="reference internal" href="../library/email.message.html#email.message.Message.as_bytes" title="email.message.Message.as_bytes"><tt class="xref py py-meth docutils literal"><span class="pre">as_bytes()</span></tt></a> added to produce a bytes
representation of the message in a fashion similar to how <tt class="docutils literal"><span class="pre">as_string</span></tt>
produces a string representation.  It does not accept the <em>maxheaderlen</em>
argument, but does accept the <em>unixfrom</em> and <em>policy</em> arguments. The
<a class="reference internal" href="../library/email.message.html#email.message.Message" title="email.message.Message"><tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt></a> <a class="reference internal" href="../library/email.message.html#email.message.Message.__bytes__" title="email.message.Message.__bytes__"><tt class="xref py py-meth docutils literal"><span class="pre">__bytes__()</span></tt></a> method
calls it, meaning that <tt class="docutils literal"><span class="pre">bytes(mymsg)</span></tt> will now produce the intuitive
result:  a bytes object containing the fully formatted message.  (Contributed
by R. David Murray in <a class="reference external" href="https://bugs.python.org/issue18600">issue 18600</a>.)</p>
<p>The <a class="reference internal" href="../library/email.message.html#email.message.Message.set_param" title="email.message.Message.set_param"><tt class="xref py py-meth docutils literal"><span class="pre">Message.set_param()</span></tt></a> message now accepts a <em>replace</em> keyword argument.
When specified, the associated header will be updated without changing
its location in the list of headers.  For backward compatibility, the default
is <tt class="docutils literal"><span class="pre">False</span></tt>.  (Contributed by R. David Murray in <a class="reference external" href="https://bugs.python.org/issue18891">issue 18891</a>.)</p>
<p id="whatsnew-email-contentmanager">A pair of new subclasses of <a class="reference internal" href="../library/email.message.html#email.message.Message" title="email.message.Message"><tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt></a> have been added
(<a class="reference internal" href="../library/email.contentmanager.html#email.message.EmailMessage" title="email.message.EmailMessage"><tt class="xref py py-class docutils literal"><span class="pre">EmailMessage</span></tt></a> and <a class="reference internal" href="../library/email.contentmanager.html#email.message.MIMEPart" title="email.message.MIMEPart"><tt class="xref py py-class docutils literal"><span class="pre">MIMEPart</span></tt></a>), along with a new sub-module,
<a class="reference internal" href="../library/email.contentmanager.html#module-email.contentmanager" title="email.contentmanager: Storing and Retrieving Content from MIME Parts"><tt class="xref py py-mod docutils literal"><span class="pre">contentmanager</span></tt></a> and a new <a class="reference internal" href="../library/email.policy.html#module-email.policy" title="email.policy: Controlling the parsing and generating of messages"><tt class="xref py py-mod docutils literal"><span class="pre">policy</span></tt></a> attribute
<a class="reference internal" href="../library/email.policy.html#email.policy.EmailPolicy.content_manager" title="email.policy.EmailPolicy.content_manager"><tt class="xref py py-attr docutils literal"><span class="pre">content_manager</span></tt></a>.  All documentation is
currently in the new module, which is being added as part of email&#8217;s new
<a class="reference internal" href="../glossary.html#term-provisional-api"><em class="xref std std-term">provisional API</em></a>.  These classes provide a number of new methods that
make extracting content from and inserting content into email messages much
easier.  For details, see the <a class="reference internal" href="../library/email.contentmanager.html#module-email.contentmanager" title="email.contentmanager: Storing and Retrieving Content from MIME Parts"><tt class="xref py py-mod docutils literal"><span class="pre">contentmanager</span></tt></a> documentation and
the <a class="reference internal" href="../library/email-examples.html#email-contentmanager-api-examples"><em>Examples using the Provisional API</em></a>.  These API additions complete the
bulk of the work that was planned as part of the email6 project.  The currently
provisional API is scheduled to become final in Python 3.5 (possibly with a few
minor additions in the area of error handling).  (Contributed by R. David
Murray in <a class="reference external" href="https://bugs.python.org/issue18891">issue 18891</a>.)</p>
</div>
<div class="section" id="filecmp">
<h3>filecmp<a class="headerlink" href="#filecmp" title="Permalink to this headline">¶</a></h3>
<p>A new <a class="reference internal" href="../library/filecmp.html#filecmp.clear_cache" title="filecmp.clear_cache"><tt class="xref py py-func docutils literal"><span class="pre">clear_cache()</span></tt></a> function provides the ability to clear the
<a class="reference internal" href="../library/filecmp.html#module-filecmp" title="filecmp: Compare files efficiently."><tt class="xref py py-mod docutils literal"><span class="pre">filecmp</span></tt></a> comparison cache, which uses <a class="reference internal" href="../library/os.html#os.stat" title="os.stat"><tt class="xref py py-func docutils literal"><span class="pre">os.stat()</span></tt></a> information to
determine if the file has changed since the last compare.  This can be used,
for example, if the file might have been changed and re-checked in less time
than the resolution of a particular filesystem&#8217;s file modification time field.
(Contributed by Mark Levitt in <a class="reference external" href="https://bugs.python.org/issue18149">issue 18149</a>.)</p>
<p>New module attribute <a class="reference internal" href="../library/filecmp.html#filecmp.DEFAULT_IGNORES" title="filecmp.DEFAULT_IGNORES"><tt class="xref py py-data docutils literal"><span class="pre">DEFAULT_IGNORES</span></tt></a> provides the list of
directories that are used as the default value for the <em>ignore</em> parameter of
the <a class="reference internal" href="../library/filecmp.html#filecmp.dircmp" title="filecmp.dircmp"><tt class="xref py py-func docutils literal"><span class="pre">dircmp()</span></tt></a> function.  (Contributed by Eli Bendersky in
<a class="reference external" href="https://bugs.python.org/issue15442">issue 15442</a>.)</p>
</div>
<div class="section" id="functools">
<h3>functools<a class="headerlink" href="#functools" title="Permalink to this headline">¶</a></h3>
<p>The new <a class="reference internal" href="../library/functools.html#functools.partialmethod" title="functools.partialmethod"><tt class="xref py py-func docutils literal"><span class="pre">partialmethod()</span></tt></a> descriptor brings partial argument
application to descriptors, just as <a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><tt class="xref py py-func docutils literal"><span class="pre">partial()</span></tt></a> provides
for normal callables. The new descriptor also makes it easier to get
arbitrary callables (including <a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><tt class="xref py py-func docutils literal"><span class="pre">partial()</span></tt></a> instances)
to behave like normal instance methods when included in a class definition.
(Contributed by Alon Horev and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue4331">issue 4331</a>.)</p>
<p id="whatsnew-singledispatch">The new <a class="reference internal" href="../library/functools.html#functools.singledispatch" title="functools.singledispatch"><tt class="xref py py-func docutils literal"><span class="pre">singledispatch()</span></tt></a> decorator brings support for
single-dispatch generic functions to the Python standard library. Where
object oriented programming focuses on grouping multiple operations on a
common set of data into a class, a generic function focuses on grouping
multiple implementations of an operation that allows it to work with
<em>different</em> kinds of data.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-36"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0443"><strong>PEP 443</strong></a> &#8211; Single-dispatch generic functions</dt>
<dd>PEP written and implemented by Łukasz Langa.</dd>
</dl>
</div>
<p><a class="reference internal" href="../library/functools.html#functools.total_ordering" title="functools.total_ordering"><tt class="xref py py-func docutils literal"><span class="pre">total_ordering()</span></tt></a> now supports a return value of
<a class="reference internal" href="../library/constants.html#NotImplemented" title="NotImplemented"><tt class="xref py py-const docutils literal"><span class="pre">NotImplemented</span></tt></a> from the underlying comparison function.  (Contributed
by Katie Miller in <a class="reference external" href="https://bugs.python.org/issue10042">issue 10042</a>.)</p>
<p>A pure-python version of the <a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><tt class="xref py py-func docutils literal"><span class="pre">partial()</span></tt></a> function is now in the
stdlib; in CPython it is overridden by the C accelerated version, but it is
available for other implementations to use.  (Contributed by Brian Thorne in
<a class="reference external" href="https://bugs.python.org/issue12428">issue 12428</a>.)</p>
</div>
<div class="section" id="gc">
<h3>gc<a class="headerlink" href="#gc" title="Permalink to this headline">¶</a></h3>
<p>New function <a class="reference internal" href="../library/gc.html#gc.get_stats" title="gc.get_stats"><tt class="xref py py-func docutils literal"><span class="pre">get_stats()</span></tt></a> returns a list of three per-generation
dictionaries containing the collections statistics since interpreter startup.
(Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue16351">issue 16351</a>.)</p>
</div>
<div class="section" id="glob">
<h3>glob<a class="headerlink" href="#glob" title="Permalink to this headline">¶</a></h3>
<p>A new function <a class="reference internal" href="../library/glob.html#glob.escape" title="glob.escape"><tt class="xref py py-func docutils literal"><span class="pre">escape()</span></tt></a> provides a way to escape special characters
in a filename so that they do not become part of the globbing expansion but are
instead matched literally.  (Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue8402">issue 8402</a>.)</p>
</div>
<div class="section" id="hashlib">
<h3>hashlib<a class="headerlink" href="#hashlib" title="Permalink to this headline">¶</a></h3>
<p>A new <a class="reference internal" href="../library/hashlib.html#hashlib.pbkdf2_hmac" title="hashlib.pbkdf2_hmac"><tt class="xref py py-func docutils literal"><span class="pre">hashlib.pbkdf2_hmac()</span></tt></a> function provides
the <a class="reference external" href="http://en.wikipedia.org/wiki/PBKDF2">PKCS#5 password-based key derivation function 2</a>.  (Contributed by Christian
Heimes in <a class="reference external" href="https://bugs.python.org/issue18582">issue 18582</a>.)</p>
<p>The <a class="reference internal" href="../library/hashlib.html#hashlib.hash.name" title="hashlib.hash.name"><tt class="xref py py-attr docutils literal"><span class="pre">name</span></tt></a> attribute of <a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><tt class="xref py py-mod docutils literal"><span class="pre">hashlib</span></tt></a> hash objects is now
a formally supported interface.  It has always existed in CPython&#8217;s
<a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><tt class="xref py py-mod docutils literal"><span class="pre">hashlib</span></tt></a> (although it did not return lower case names for all supported
hashes), but it was not a public interface and so some other Python
implementations have not previously supported it.  (Contributed by Jason R.
Coombs in <a class="reference external" href="https://bugs.python.org/issue18532">issue 18532</a>.)</p>
</div>
<div class="section" id="hmac">
<h3>hmac<a class="headerlink" href="#hmac" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/hmac.html#module-hmac" title="hmac: Keyed-Hashing for Message Authentication (HMAC) implementation for Python."><tt class="xref py py-mod docutils literal"><span class="pre">hmac</span></tt></a> now accepts <tt class="docutils literal"><span class="pre">bytearray</span></tt> as well as <tt class="docutils literal"><span class="pre">bytes</span></tt> for the <em>key</em>
argument to the <a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><tt class="xref py py-func docutils literal"><span class="pre">new()</span></tt></a> function, and the <em>msg</em> parameter to both the
<a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><tt class="xref py py-func docutils literal"><span class="pre">new()</span></tt></a> function and the <a class="reference internal" href="../library/hmac.html#hmac.HMAC.update" title="hmac.HMAC.update"><tt class="xref py py-meth docutils literal"><span class="pre">update()</span></tt></a> method now
accepts any type supported by the <a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><tt class="xref py py-mod docutils literal"><span class="pre">hashlib</span></tt></a> module.  (Contributed
by Jonas Borgström in <a class="reference external" href="https://bugs.python.org/issue18240">issue 18240</a>.)</p>
<p>The <em>digestmod</em> argument to the <a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><tt class="xref py py-func docutils literal"><span class="pre">hmac.new()</span></tt></a> function may now be any hash
digest name recognized by <a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><tt class="xref py py-mod docutils literal"><span class="pre">hashlib</span></tt></a>.  In addition, the current behavior in
which the value of <em>digestmod</em> defaults to <tt class="docutils literal"><span class="pre">MD5</span></tt> is deprecated: in a
future version of Python there will be no default value.  (Contributed by
Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue17276">issue 17276</a>.)</p>
<p>With the addition of <a class="reference internal" href="../library/hmac.html#hmac.HMAC.block_size" title="hmac.HMAC.block_size"><tt class="xref py py-attr docutils literal"><span class="pre">block_size</span></tt></a> and <a class="reference internal" href="../library/hmac.html#hmac.HMAC.name" title="hmac.HMAC.name"><tt class="xref py py-attr docutils literal"><span class="pre">name</span></tt></a>
attributes (and the formal documentation of the <a class="reference internal" href="../library/hmac.html#hmac.HMAC.digest_size" title="hmac.HMAC.digest_size"><tt class="xref py py-attr docutils literal"><span class="pre">digest_size</span></tt></a>
attribute), the <a class="reference internal" href="../library/hmac.html#module-hmac" title="hmac: Keyed-Hashing for Message Authentication (HMAC) implementation for Python."><tt class="xref py py-mod docutils literal"><span class="pre">hmac</span></tt></a> module now conforms fully to the <span class="target" id="index-37"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0247"><strong>PEP 247</strong></a> API.
(Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue18775">issue 18775</a>.)</p>
</div>
<div class="section" id="html">
<h3>html<a class="headerlink" href="#html" title="Permalink to this headline">¶</a></h3>
<p>New function <a class="reference internal" href="../library/html.html#html.unescape" title="html.unescape"><tt class="xref py py-func docutils literal"><span class="pre">unescape()</span></tt></a> function converts HTML5 character references to
the corresponding Unicode characters.  (Contributed by Ezio Melotti in
<a class="reference external" href="https://bugs.python.org/issue2927">issue 2927</a>.)</p>
<p><a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><tt class="xref py py-class docutils literal"><span class="pre">HTMLParser</span></tt></a> accepts a new keyword argument
<em>convert_charrefs</em> that, when <tt class="docutils literal"><span class="pre">True</span></tt>, automatically converts all character
references.  For backward-compatibility, its value defaults to <tt class="docutils literal"><span class="pre">False</span></tt>, but
it will change to <tt class="docutils literal"><span class="pre">True</span></tt> in a future version of Python, so you are invited to
set it explicitly and update your code to use this new feature.  (Contributed
by Ezio Melotti in <a class="reference external" href="https://bugs.python.org/issue13633">issue 13633</a>.)</p>
<p>The <em>strict</em> argument of <a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><tt class="xref py py-class docutils literal"><span class="pre">HTMLParser</span></tt></a> is now deprecated.
(Contributed by Ezio Melotti in <a class="reference external" href="https://bugs.python.org/issue15114">issue 15114</a>.)</p>
</div>
<div class="section" id="http">
<h3>http<a class="headerlink" href="#http" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/http.server.html#http.server.BaseHTTPRequestHandler.send_error" title="http.server.BaseHTTPRequestHandler.send_error"><tt class="xref py py-meth docutils literal"><span class="pre">send_error()</span></tt></a> now accepts an
optional additional <em>explain</em> parameter which can be used to provide an
extended error description, overriding the hardcoded default if there is one.
This extended error description will be formatted using the
<tt class="xref py py-attr docutils literal"><span class="pre">error_message_format</span></tt> attribute and sent as the body
of the error response.  (Contributed by Karl Cow in <a class="reference external" href="https://bugs.python.org/issue12921">issue 12921</a>.)</p>
<p>The <a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><tt class="xref py py-mod docutils literal"><span class="pre">http.server</span></tt></a> <a class="reference internal" href="../library/http.server.html#http-server-cli"><em>command line interface</em></a> now has
a <tt class="docutils literal"><span class="pre">-b/--bind</span></tt> option that causes the server to listen on a specific address.
(Contributed by Malte Swart in <a class="reference external" href="https://bugs.python.org/issue17764">issue 17764</a>.)</p>
</div>
<div class="section" id="idlelib-and-idle">
<h3>idlelib and IDLE<a class="headerlink" href="#idlelib-and-idle" title="Permalink to this headline">¶</a></h3>
<p>Since idlelib implements the IDLE shell and editor and is not intended for
import by other programs, it gets improvements with every release. See
<tt class="file docutils literal"><span class="pre">Lib/idlelib/NEWS.txt</span></tt> for a cumulative list of changes since 3.3.0,
as well as changes made in future 3.4.x releases. This file is also available
from the IDLE Help -&gt; About Idle dialog.</p>
</div>
<div class="section" id="importlib">
<h3>importlib<a class="headerlink" href="#importlib" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader" title="importlib.abc.InspectLoader"><tt class="xref py py-class docutils literal"><span class="pre">InspectLoader</span></tt></a> ABC defines a new method,
<a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader.source_to_code" title="importlib.abc.InspectLoader.source_to_code"><tt class="xref py py-meth docutils literal"><span class="pre">source_to_code()</span></tt></a> that accepts source
data and a path and returns a code object.  The default implementation
is equivalent to <tt class="docutils literal"><span class="pre">compile(data,</span> <span class="pre">path,</span> <span class="pre">'exec',</span> <span class="pre">dont_inherit=True)</span></tt>.
(Contributed by Eric Snow and Brett Cannon in <a class="reference external" href="https://bugs.python.org/issue15627">issue 15627</a>.)</p>
<p><a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader" title="importlib.abc.InspectLoader"><tt class="xref py py-class docutils literal"><span class="pre">InspectLoader</span></tt></a> also now has a default implementation
for the <a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader.get_code" title="importlib.abc.InspectLoader.get_code"><tt class="xref py py-meth docutils literal"><span class="pre">get_code()</span></tt></a> method.  However,
it will normally be desirable to override the default implementation
for performance reasons.  (Contributed by Brett Cannon in <a class="reference external" href="https://bugs.python.org/issue18072">issue 18072</a>.)</p>
<p>The <a class="reference internal" href="../library/importlib.html#importlib.reload" title="importlib.reload"><tt class="xref py py-func docutils literal"><span class="pre">reload()</span></tt></a> function has been moved from <a class="reference internal" href="../library/imp.html#module-imp" title="imp: Access the implementation of the import statement. (deprecated)"><tt class="xref py py-mod docutils literal"><span class="pre">imp</span></tt></a> to
<a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><tt class="xref py py-mod docutils literal"><span class="pre">importlib</span></tt></a> as part of the <a class="reference internal" href="../library/imp.html#module-imp" title="imp: Access the implementation of the import statement. (deprecated)"><tt class="xref py py-mod docutils literal"><span class="pre">imp</span></tt></a> module deprecation.  (Contributed by
Berker Peksag in <a class="reference external" href="https://bugs.python.org/issue18193">issue 18193</a>.)</p>
<p><a class="reference internal" href="../library/importlib.html#module-importlib.util" title="importlib.util: Utility code for importers"><tt class="xref py py-mod docutils literal"><span class="pre">importlib.util</span></tt></a> now has a <a class="reference internal" href="../library/importlib.html#importlib.util.MAGIC_NUMBER" title="importlib.util.MAGIC_NUMBER"><tt class="xref py py-data docutils literal"><span class="pre">MAGIC_NUMBER</span></tt></a> attribute
providing access to the bytecode version number.  This replaces the
<a class="reference internal" href="../library/imp.html#imp.get_magic" title="imp.get_magic"><tt class="xref py py-func docutils literal"><span class="pre">get_magic()</span></tt></a> function in the deprecated <a class="reference internal" href="../library/imp.html#module-imp" title="imp: Access the implementation of the import statement. (deprecated)"><tt class="xref py py-mod docutils literal"><span class="pre">imp</span></tt></a> module.
(Contributed by Brett Cannon in <a class="reference external" href="https://bugs.python.org/issue18192">issue 18192</a>.)</p>
<p>New <a class="reference internal" href="../library/importlib.html#module-importlib.util" title="importlib.util: Utility code for importers"><tt class="xref py py-mod docutils literal"><span class="pre">importlib.util</span></tt></a> functions <a class="reference internal" href="../library/importlib.html#importlib.util.cache_from_source" title="importlib.util.cache_from_source"><tt class="xref py py-func docutils literal"><span class="pre">cache_from_source()</span></tt></a>
and <a class="reference internal" href="../library/importlib.html#importlib.util.source_from_cache" title="importlib.util.source_from_cache"><tt class="xref py py-func docutils literal"><span class="pre">source_from_cache()</span></tt></a> replace the same-named functions
in the deprecated <a class="reference internal" href="../library/imp.html#module-imp" title="imp: Access the implementation of the import statement. (deprecated)"><tt class="xref py py-mod docutils literal"><span class="pre">imp</span></tt></a> module.  (Contributed by Brett Cannon in
<a class="reference external" href="https://bugs.python.org/issue18194">issue 18194</a>.)</p>
<p>The <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><tt class="xref py py-mod docutils literal"><span class="pre">importlib</span></tt></a> bootstrap <tt class="xref py py-class docutils literal"><span class="pre">NamespaceLoader</span></tt> now conforms to
the <a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader" title="importlib.abc.InspectLoader"><tt class="xref py py-class docutils literal"><span class="pre">InspectLoader</span></tt></a> ABC, which means that <tt class="docutils literal"><span class="pre">runpy</span></tt> and
<tt class="docutils literal"><span class="pre">python</span> <span class="pre">-m</span></tt> can now be used with namespace packages.  (Contributed
by Brett Cannon in <a class="reference external" href="https://bugs.python.org/issue18058">issue 18058</a>.)</p>
<p><a class="reference internal" href="../library/importlib.html#module-importlib.util" title="importlib.util: Utility code for importers"><tt class="xref py py-mod docutils literal"><span class="pre">importlib.util</span></tt></a> has a new function <a class="reference internal" href="../library/importlib.html#importlib.util.decode_source" title="importlib.util.decode_source"><tt class="xref py py-func docutils literal"><span class="pre">decode_source()</span></tt></a>
that decodes source from bytes using universal newline processing.  This is
useful for implementing <a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader.get_source" title="importlib.abc.InspectLoader.get_source"><tt class="xref py py-meth docutils literal"><span class="pre">InspectLoader.get_source()</span></tt></a> methods.</p>
<p><a class="reference internal" href="../library/importlib.html#importlib.machinery.ExtensionFileLoader" title="importlib.machinery.ExtensionFileLoader"><tt class="xref py py-class docutils literal"><span class="pre">importlib.machinery.ExtensionFileLoader</span></tt></a> now has a
<a class="reference internal" href="../library/importlib.html#importlib.machinery.ExtensionFileLoader.get_filename" title="importlib.machinery.ExtensionFileLoader.get_filename"><tt class="xref py py-meth docutils literal"><span class="pre">get_filename()</span></tt></a> method.  This was
inadvertently omitted in the original implementation.  (Contributed by Eric
Snow in <a class="reference external" href="https://bugs.python.org/issue19152">issue 19152</a>.)</p>
</div>
<div class="section" id="inspect">
<h3>inspect<a class="headerlink" href="#inspect" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><tt class="xref py py-mod docutils literal"><span class="pre">inspect</span></tt></a> module now offers a basic <a class="reference internal" href="../library/inspect.html#inspect-module-cli"><em>command line interface</em></a> to quickly display source code and other
information for modules, classes and functions.  (Contributed by Claudiu Popa
and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue18626">issue 18626</a>.)</p>
<p><a class="reference internal" href="../library/inspect.html#inspect.unwrap" title="inspect.unwrap"><tt class="xref py py-func docutils literal"><span class="pre">unwrap()</span></tt></a> makes it easy to unravel wrapper function chains
created by <a class="reference internal" href="../library/functools.html#functools.wraps" title="functools.wraps"><tt class="xref py py-func docutils literal"><span class="pre">functools.wraps()</span></tt></a> (and any other API that sets the
<tt class="docutils literal"><span class="pre">__wrapped__</span></tt> attribute on a wrapper function).  (Contributed by
Daniel Urban, Aaron Iles and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue13266">issue 13266</a>.)</p>
<p>As part of the implementation of the new <a class="reference internal" href="../library/enum.html#module-enum" title="enum: Implementation of an enumeration class."><tt class="xref py py-mod docutils literal"><span class="pre">enum</span></tt></a> module, the
<a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><tt class="xref py py-mod docutils literal"><span class="pre">inspect</span></tt></a> module now has substantially better support for custom
<tt class="docutils literal"><span class="pre">__dir__</span></tt> methods and dynamic class attributes provided through
metaclasses.  (Contributed by Ethan Furman in <a class="reference external" href="https://bugs.python.org/issue18929">issue 18929</a> and
<a class="reference external" href="https://bugs.python.org/issue19030">issue 19030</a>.)</p>
<p><a class="reference internal" href="../library/inspect.html#inspect.getfullargspec" title="inspect.getfullargspec"><tt class="xref py py-func docutils literal"><span class="pre">getfullargspec()</span></tt></a> and <a class="reference internal" href="../library/inspect.html#inspect.getargspec" title="inspect.getargspec"><tt class="xref py py-func docutils literal"><span class="pre">getargspec()</span></tt></a>
now use the <a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><tt class="xref py py-func docutils literal"><span class="pre">signature()</span></tt></a> API. This allows them to
support a much broader range of callables, including those with
<tt class="docutils literal"><span class="pre">__signature__</span></tt> attributes, those with metadata provided by argument
clinic, <a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><tt class="xref py py-func docutils literal"><span class="pre">functools.partial()</span></tt></a> objects and more. Note that, unlike
<a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><tt class="xref py py-func docutils literal"><span class="pre">signature()</span></tt></a>, these functions still ignore <tt class="docutils literal"><span class="pre">__wrapped__</span></tt>
attributes, and report the already bound first argument for bound methods,
so it is still necessary to update your code to use
<a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><tt class="xref py py-func docutils literal"><span class="pre">signature()</span></tt></a> directly if those features are desired.
(Contributed by Yury Selivanov in <a class="reference external" href="https://bugs.python.org/issue17481">issue 17481</a>.)</p>
<p><a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><tt class="xref py py-func docutils literal"><span class="pre">signature()</span></tt></a> now supports duck types of CPython functions,
which adds support for functions compiled with Cython.  (Contributed
by Stefan Behnel and Yury Selivanov in <a class="reference external" href="https://bugs.python.org/issue17159">issue 17159</a>.)</p>
</div>
<div class="section" id="ipaddress">
<h3>ipaddress<a class="headerlink" href="#ipaddress" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/ipaddress.html#module-ipaddress" title="ipaddress: IPv4/IPv6 manipulation library."><tt class="xref py py-mod docutils literal"><span class="pre">ipaddress</span></tt></a> was added to the standard library in Python 3.3 as a
<a class="reference internal" href="../glossary.html#term-provisional-api"><em class="xref std std-term">provisional API</em></a>. With the release of Python 3.4, this qualification
has been removed: <a class="reference internal" href="../library/ipaddress.html#module-ipaddress" title="ipaddress: IPv4/IPv6 manipulation library."><tt class="xref py py-mod docutils literal"><span class="pre">ipaddress</span></tt></a> is now considered a stable API, covered
by the normal standard library requirements to maintain backwards
compatibility.</p>
<p>A new <a class="reference internal" href="../library/ipaddress.html#ipaddress.IPv4Address.is_global" title="ipaddress.IPv4Address.is_global"><tt class="xref py py-attr docutils literal"><span class="pre">is_global</span></tt></a> property is <tt class="docutils literal"><span class="pre">True</span></tt> if
an address is globally routeable.  (Contributed by Peter Moody in
<a class="reference external" href="https://bugs.python.org/issue17400">issue 17400</a>.)</p>
</div>
<div class="section" id="logging">
<h3>logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/logging.handlers.html#logging.handlers.TimedRotatingFileHandler" title="logging.handlers.TimedRotatingFileHandler"><tt class="xref py py-class docutils literal"><span class="pre">TimedRotatingFileHandler</span></tt></a> has a new <em>atTime</em>
parameter that can be used to specify the time of day when rollover should
happen.  (Contributed by Ronald Oussoren in <a class="reference external" href="https://bugs.python.org/issue9556">issue 9556</a>.)</p>
<p><a class="reference internal" href="../library/logging.handlers.html#logging.handlers.SocketHandler" title="logging.handlers.SocketHandler"><tt class="xref py py-class docutils literal"><span class="pre">SocketHandler</span></tt></a> and
<a class="reference internal" href="../library/logging.handlers.html#logging.handlers.DatagramHandler" title="logging.handlers.DatagramHandler"><tt class="xref py py-class docutils literal"><span class="pre">DatagramHandler</span></tt></a> now support Unix domain sockets (by
setting <em>port</em> to <tt class="docutils literal"><span class="pre">None</span></tt>).  (Contributed by Vinay Sajip in commit
ce46195b56a9.)</p>
<p><a class="reference internal" href="../library/logging.config.html#logging.config.fileConfig" title="logging.config.fileConfig"><tt class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></tt></a> now accepts a
<a class="reference internal" href="../library/configparser.html#configparser.RawConfigParser" title="configparser.RawConfigParser"><tt class="xref py py-class docutils literal"><span class="pre">configparser.RawConfigParser</span></tt></a> subclass instance for the <em>fname</em>
parameter.  This facilitates using a configuration file when logging
configuration is just a part of the overall application configuration, or where
the application modifies the configuration before passing it to
<a class="reference internal" href="../library/logging.config.html#logging.config.fileConfig" title="logging.config.fileConfig"><tt class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></tt></a>.  (Contributed by Vinay Sajip in
<a class="reference external" href="https://bugs.python.org/issue16110">issue 16110</a>.)</p>
<p>Logging configuration data received from a socket via the
<a class="reference internal" href="../library/logging.config.html#logging.config.listen" title="logging.config.listen"><tt class="xref py py-func docutils literal"><span class="pre">logging.config.listen()</span></tt></a> function can now be validated before being
processed by supplying a verification function as the argument to the new
<em>verify</em> keyword argument.  (Contributed by Vinay Sajip in <a class="reference external" href="https://bugs.python.org/issue15452">issue 15452</a>.)</p>
</div>
<div class="section" id="marshal">
<span id="whatsnew-marshal-3"></span><h3>marshal<a class="headerlink" href="#marshal" title="Permalink to this headline">¶</a></h3>
<p>The default <a class="reference internal" href="../library/marshal.html#module-marshal" title="marshal: Convert Python objects to streams of bytes and back (with different constraints)."><tt class="xref py py-mod docutils literal"><span class="pre">marshal</span></tt></a> version has been bumped to 3.  The code implementing
the new version restores the Python2 behavior of recording only one copy of
interned strings and preserving the interning on deserialization, and extends
this &#8220;one copy&#8221; ability to any object type (including handling recursive
references).  This reduces both the size of <tt class="docutils literal"><span class="pre">.pyc</span></tt> files and the amount of
memory a module occupies in memory when it is loaded from a <tt class="docutils literal"><span class="pre">.pyc</span></tt> (or
<tt class="docutils literal"><span class="pre">.pyo</span></tt>) file.  (Contributed by Kristján Valur Jónsson in <a class="reference external" href="https://bugs.python.org/issue16475">issue 16475</a>,
with additional speedups by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue19219">issue 19219</a>.)</p>
</div>
<div class="section" id="mmap">
<h3>mmap<a class="headerlink" href="#mmap" title="Permalink to this headline">¶</a></h3>
<p>mmap objects can now be <a class="reference internal" href="../library/weakref.html#module-weakref" title="weakref: Support for weak references and weak dictionaries."><tt class="xref py py-mod docutils literal"><span class="pre">weakref</span></tt></a>ed.  (Contributed by Valerie Lambert in
<a class="reference external" href="https://bugs.python.org/issue4885">issue 4885</a>.)</p>
</div>
<div class="section" id="multiprocessing">
<h3>multiprocessing<a class="headerlink" href="#multiprocessing" title="Permalink to this headline">¶</a></h3>
<p id="whatsnew-multiprocessing-no-fork">On Unix two new <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-methods"><em>start methods</em></a>,
(<tt class="docutils literal"><span class="pre">spawn</span></tt> and <tt class="docutils literal"><span class="pre">forkserver</span></tt>, have been added for starting processes using
<a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><tt class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></tt></a>.  These make the mixing of processes with threads more
robust, and the <tt class="docutils literal"><span class="pre">spawn</span></tt> method matches the semantics that multiprocessing has
always used on Windows.  New function
<a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_all_start_methods" title="multiprocessing.get_all_start_methods"><tt class="xref py py-func docutils literal"><span class="pre">get_all_start_methods()</span></tt></a> reports all start methods
available on the platform, <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_start_method" title="multiprocessing.get_start_method"><tt class="xref py py-func docutils literal"><span class="pre">get_start_method()</span></tt></a> reports
the current start method, and <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.set_start_method" title="multiprocessing.set_start_method"><tt class="xref py py-func docutils literal"><span class="pre">set_start_method()</span></tt></a> sets
the start method.  (Contributed by Richard Oudkerk in <a class="reference external" href="https://bugs.python.org/issue8713">issue 8713</a>.)</p>
<p><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><tt class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></tt></a> also now has the concept of a <tt class="docutils literal"><span class="pre">context</span></tt>, which
determines how child processes are created.  New function
<a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_context" title="multiprocessing.get_context"><tt class="xref py py-func docutils literal"><span class="pre">get_context()</span></tt></a> returns a context that uses a specified
start method.  It has the same API as the <a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><tt class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></tt></a> module itself,
so you can use it to create <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.pool.Pool" title="multiprocessing.pool.Pool"><tt class="xref py py-class docutils literal"><span class="pre">Pool</span></tt></a>s and other
objects that will operate within that context.  This allows a framework and an
application or different parts of the same application to use multiprocessing
without interfering with each other.  (Contributed by Richard Oudkerk in
<a class="reference external" href="https://bugs.python.org/issue18999">issue 18999</a>.)</p>
<p>Except when using the old <em>fork</em> start method, child processes no longer
inherit unneeded handles/file descriptors from their parents (part of
<a class="reference external" href="https://bugs.python.org/issue8713">issue 8713</a>).</p>
<p><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><tt class="xref py py-mod docutils literal"><span class="pre">multiprocessing</span></tt></a> now relies on <a class="reference internal" href="../library/runpy.html#module-runpy" title="runpy: Locate and run Python modules without importing them first."><tt class="xref py py-mod docutils literal"><span class="pre">runpy</span></tt></a> (which implements the
<tt class="docutils literal"><span class="pre">-m</span></tt> switch) to initialise <tt class="docutils literal"><span class="pre">__main__</span></tt> appropriately in child processes
when using the <tt class="docutils literal"><span class="pre">spawn</span></tt> or <tt class="docutils literal"><span class="pre">forkserver</span></tt> start methods. This resolves some
edge cases where combining multiprocessing, the <tt class="docutils literal"><span class="pre">-m</span></tt> command line switch,
and explicit relative imports could cause obscure failures in child
processes.  (Contributed by Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue19946">issue 19946</a>.)</p>
</div>
<div class="section" id="operator">
<h3>operator<a class="headerlink" href="#operator" title="Permalink to this headline">¶</a></h3>
<p>New function <a class="reference internal" href="../library/operator.html#operator.length_hint" title="operator.length_hint"><tt class="xref py py-func docutils literal"><span class="pre">length_hint()</span></tt></a> provides an implementation of the
specification for how the <a class="reference internal" href="../reference/datamodel.html#object.__length_hint__" title="object.__length_hint__"><tt class="xref py py-meth docutils literal"><span class="pre">__length_hint__()</span></tt></a> special method should
be used, as part of the <span class="target" id="index-38"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0424"><strong>PEP 424</strong></a> formal specification of this language
feature.  (Contributed by Armin Ronacher in <a class="reference external" href="https://bugs.python.org/issue16148">issue 16148</a>.)</p>
<p>There is now a pure-python version of the <a class="reference internal" href="../library/operator.html#module-operator" title="operator: Functions corresponding to the standard operators."><tt class="xref py py-mod docutils literal"><span class="pre">operator</span></tt></a> module available for
reference and for use by alternate implementations of Python.  (Contributed by
Zachary Ware in <a class="reference external" href="https://bugs.python.org/issue16694">issue 16694</a>.)</p>
</div>
<div class="section" id="os">
<h3>os<a class="headerlink" href="#os" title="Permalink to this headline">¶</a></h3>
<p>There are new functions to get and set the <a class="reference internal" href="../library/os.html#fd-inheritance"><em>inheritable flag</em></a> of a file descriptor (<a class="reference internal" href="../library/os.html#os.get_inheritable" title="os.get_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.get_inheritable()</span></tt></a>,
<a class="reference internal" href="../library/os.html#os.set_inheritable" title="os.set_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.set_inheritable()</span></tt></a>) or a Windows handle
(<a class="reference internal" href="../library/os.html#os.get_handle_inheritable" title="os.get_handle_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.get_handle_inheritable()</span></tt></a>, <a class="reference internal" href="../library/os.html#os.set_handle_inheritable" title="os.set_handle_inheritable"><tt class="xref py py-func docutils literal"><span class="pre">os.set_handle_inheritable()</span></tt></a>).</p>
<p>New function <a class="reference internal" href="../library/os.html#os.cpu_count" title="os.cpu_count"><tt class="xref py py-func docutils literal"><span class="pre">cpu_count()</span></tt></a> reports the number of CPUs available on the
platform on which Python is running (or <tt class="docutils literal"><span class="pre">None</span></tt> if the count can&#8217;t be
determined).  The <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.cpu_count" title="multiprocessing.cpu_count"><tt class="xref py py-func docutils literal"><span class="pre">multiprocessing.cpu_count()</span></tt></a> function is now implemented
in terms of this function).  (Contributed by Trent Nelson, Yogesh Chaudhari,
Victor Stinner, and Charles-François Natali in <a class="reference external" href="https://bugs.python.org/issue17914">issue 17914</a>.)</p>
<p><a class="reference internal" href="../library/os.path.html#os.path.samestat" title="os.path.samestat"><tt class="xref py py-func docutils literal"><span class="pre">os.path.samestat()</span></tt></a> is now available on the Windows platform (and the
<a class="reference internal" href="../library/os.path.html#os.path.samefile" title="os.path.samefile"><tt class="xref py py-func docutils literal"><span class="pre">os.path.samefile()</span></tt></a> implementation is now shared between Unix and
Windows).  (Contributed by Brian Curtin in <a class="reference external" href="https://bugs.python.org/issue11939">issue 11939</a>.)</p>
<p><a class="reference internal" href="../library/os.path.html#os.path.ismount" title="os.path.ismount"><tt class="xref py py-func docutils literal"><span class="pre">os.path.ismount()</span></tt></a> now recognizes volumes mounted below a drive
root on Windows.  (Contributed by Tim Golden in <a class="reference external" href="https://bugs.python.org/issue9035">issue 9035</a>.)</p>
<p><a class="reference internal" href="../library/os.html#os.open" title="os.open"><tt class="xref py py-func docutils literal"><span class="pre">os.open()</span></tt></a> supports two new flags on platforms that provide them,
<a class="reference internal" href="../library/os.html#os.O_PATH" title="os.O_PATH"><tt class="xref py py-data docutils literal"><span class="pre">O_PATH</span></tt></a> (un-opened file descriptor), and <a class="reference internal" href="../library/os.html#os.O_TMPFILE" title="os.O_TMPFILE"><tt class="xref py py-data docutils literal"><span class="pre">O_TMPFILE</span></tt></a>
(unnamed temporary file; as of 3.4.0 release available only on Linux systems
with a kernel version of 3.11 or newer that have uapi headers).  (Contributed
by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue18673">issue 18673</a> and Benjamin Peterson, respectively.)</p>
</div>
<div class="section" id="pdb">
<h3>pdb<a class="headerlink" href="#pdb" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><tt class="xref py py-mod docutils literal"><span class="pre">pdb</span></tt></a> has been enhanced to handle generators, <a class="reference internal" href="../reference/simple_stmts.html#yield"><tt class="xref std std-keyword docutils literal"><span class="pre">yield</span></tt></a>, and
<tt class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></tt> in a more useful fashion.  This is especially helpful when
debugging <a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O, event loop, coroutines and tasks."><tt class="xref py py-mod docutils literal"><span class="pre">asyncio</span></tt></a> based programs.  (Contributed by Andrew Svetlov and
Xavier de Gaye in <a class="reference external" href="https://bugs.python.org/issue16596">issue 16596</a>.)</p>
<p>The <tt class="docutils literal"><span class="pre">print</span></tt> command has been removed from <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><tt class="xref py py-mod docutils literal"><span class="pre">pdb</span></tt></a>, restoring access to the
Python <a class="reference internal" href="../library/functions.html#print" title="print"><tt class="xref py py-func docutils literal"><span class="pre">print()</span></tt></a> function from the pdb command line.  Python2&#8217;s <tt class="docutils literal"><span class="pre">pdb</span></tt> did
not have a <tt class="docutils literal"><span class="pre">print</span></tt> command; instead, entering <tt class="docutils literal"><span class="pre">print</span></tt> executed the
<tt class="docutils literal"><span class="pre">print</span></tt> statement.  In Python3 <tt class="docutils literal"><span class="pre">print</span></tt> was mistakenly made an alias for the
pdb <a class="reference internal" href="../library/pdb.html#pdbcommand-p"><tt class="xref std std-pdbcmd docutils literal"><span class="pre">p</span></tt></a> command.  <tt class="docutils literal"><span class="pre">p</span></tt>, however, prints the <tt class="docutils literal"><span class="pre">repr</span></tt> of its argument,
not the <tt class="docutils literal"><span class="pre">str</span></tt> like the Python2 <tt class="docutils literal"><span class="pre">print</span></tt> command did.  Worse, the Python3
<tt class="docutils literal"><span class="pre">pdb</span> <span class="pre">print</span></tt> command shadowed the Python3 <tt class="docutils literal"><span class="pre">print</span></tt> function, making it
inaccessible at the <tt class="docutils literal"><span class="pre">pdb</span></tt> prompt.  (Contributed by Connor Osborn in
<a class="reference external" href="https://bugs.python.org/issue18764">issue 18764</a>.)</p>
</div>
<div class="section" id="pickle">
<span id="whatsnew-protocol-4"></span><h3>pickle<a class="headerlink" href="#pickle" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/pickle.html#module-pickle" title="pickle: Convert Python objects to streams of bytes and back."><tt class="xref py py-mod docutils literal"><span class="pre">pickle</span></tt></a> now supports (but does not use by default) a new pickle protocol,
protocol 4.  This new protocol addresses a number of issues that were present
in previous protocols, such as the serialization of nested classes, very large
strings and containers, and classes whose <a class="reference internal" href="../reference/datamodel.html#object.__new__" title="object.__new__"><tt class="xref py py-meth docutils literal"><span class="pre">__new__()</span></tt></a> method takes
keyword-only arguments.  It also provides some efficiency improvements.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-39"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-3154"><strong>PEP 3154</strong></a> &#8211; Pickle protocol 4</dt>
<dd>PEP written by Antoine Pitrou and implemented by Alexandre Vassalotti.</dd>
</dl>
</div>
</div>
<div class="section" id="plistlib">
<h3>plistlib<a class="headerlink" href="#plistlib" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/plistlib.html#module-plistlib" title="plistlib: Generate and parse Mac OS X plist files."><tt class="xref py py-mod docutils literal"><span class="pre">plistlib</span></tt></a> now has an API that is similar to the standard pattern for
stdlib serialization protocols, with new <a class="reference internal" href="../library/plistlib.html#plistlib.load" title="plistlib.load"><tt class="xref py py-func docutils literal"><span class="pre">load()</span></tt></a>,
<a class="reference internal" href="../library/plistlib.html#plistlib.dump" title="plistlib.dump"><tt class="xref py py-func docutils literal"><span class="pre">dump()</span></tt></a>, <a class="reference internal" href="../library/plistlib.html#plistlib.loads" title="plistlib.loads"><tt class="xref py py-func docutils literal"><span class="pre">loads()</span></tt></a>, and <a class="reference internal" href="../library/plistlib.html#plistlib.dumps" title="plistlib.dumps"><tt class="xref py py-func docutils literal"><span class="pre">dumps()</span></tt></a>
functions.  (The older API is now deprecated.)  In addition to the already
supported XML plist format (<a class="reference internal" href="../library/plistlib.html#plistlib.FMT_XML" title="plistlib.FMT_XML"><tt class="xref py py-data docutils literal"><span class="pre">FMT_XML</span></tt></a>), it also now supports
the binary plist format (<a class="reference internal" href="../library/plistlib.html#plistlib.FMT_BINARY" title="plistlib.FMT_BINARY"><tt class="xref py py-data docutils literal"><span class="pre">FMT_BINARY</span></tt></a>).  (Contributed by Ronald
Oussoren and others in <a class="reference external" href="https://bugs.python.org/issue14455">issue 14455</a>.)</p>
</div>
<div class="section" id="poplib">
<h3>poplib<a class="headerlink" href="#poplib" title="Permalink to this headline">¶</a></h3>
<p>Two new methods have been added to <a class="reference internal" href="../library/poplib.html#module-poplib" title="poplib: POP3 protocol client (requires sockets)."><tt class="xref py py-mod docutils literal"><span class="pre">poplib</span></tt></a>: <a class="reference internal" href="../library/poplib.html#poplib.POP3.capa" title="poplib.POP3.capa"><tt class="xref py py-meth docutils literal"><span class="pre">capa()</span></tt></a>,
which returns the list of capabilities advertised by the POP server, and
<a class="reference internal" href="../library/poplib.html#poplib.POP3.stls" title="poplib.POP3.stls"><tt class="xref py py-meth docutils literal"><span class="pre">stls()</span></tt></a>, which switches a clear-text POP3 session into an
encrypted POP3 session if the POP server supports it.  (Contributed by Lorenzo
Catucci in <a class="reference external" href="https://bugs.python.org/issue4473">issue 4473</a>.)</p>
</div>
<div class="section" id="pprint">
<h3>pprint<a class="headerlink" href="#pprint" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/pprint.html#module-pprint" title="pprint: Data pretty printer."><tt class="xref py py-mod docutils literal"><span class="pre">pprint</span></tt></a> module&#8217;s <a class="reference internal" href="../library/pprint.html#pprint.PrettyPrinter" title="pprint.PrettyPrinter"><tt class="xref py py-class docutils literal"><span class="pre">PrettyPrinter</span></tt></a> class and its
<a class="reference internal" href="../library/pprint.html#pprint.pformat" title="pprint.pformat"><tt class="xref py py-func docutils literal"><span class="pre">pformat()</span></tt></a>, and <a class="reference internal" href="../library/pprint.html#pprint.pprint" title="pprint.pprint"><tt class="xref py py-func docutils literal"><span class="pre">pprint()</span></tt></a> functions have a new
option, <em>compact</em>, that controls how the output is formatted.  Currently
setting <em>compact</em> to <tt class="docutils literal"><span class="pre">True</span></tt> means that sequences will be printed with as many
sequence elements as will fit within <em>width</em> on each (indented) line.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue19132">issue 19132</a>.)</p>
<p>Long strings are now wrapped using Python&#8217;s normal line continuation
syntax.  (Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue17150">issue 17150</a>.)</p>
</div>
<div class="section" id="pty">
<h3>pty<a class="headerlink" href="#pty" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/pty.html#pty.spawn" title="pty.spawn"><tt class="xref py py-func docutils literal"><span class="pre">pty.spawn()</span></tt></a> now returns the status value from <a class="reference internal" href="../library/os.html#os.waitpid" title="os.waitpid"><tt class="xref py py-func docutils literal"><span class="pre">os.waitpid()</span></tt></a> on
the child process, instead of <tt class="docutils literal"><span class="pre">None</span></tt>.  (Contributed by Gregory P. Smith.)</p>
</div>
<div class="section" id="pydoc">
<h3>pydoc<a class="headerlink" href="#pydoc" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a> module is now based directly on the <a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><tt class="xref py py-func docutils literal"><span class="pre">inspect.signature()</span></tt></a>
introspection API, allowing it to provide signature information for a wider
variety of callable objects. This change also means that <tt class="docutils literal"><span class="pre">__wrapped__</span></tt>
attributes are now taken into account when displaying help information.
(Contributed by Larry Hastings in <a class="reference external" href="https://bugs.python.org/issue19674">issue 19674</a>.)</p>
<p>The <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a> module no longer displays the <tt class="docutils literal"><span class="pre">self</span></tt> parameter for
already bound methods. Instead, it aims to always display the exact current
signature of the supplied callable.  (Contributed by Larry Hastings in
<a class="reference external" href="https://bugs.python.org/issue20710">issue 20710</a>.)</p>
<p>In addition to the changes that have been made to <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a> directly,
its handling of custom <tt class="docutils literal"><span class="pre">__dir__</span></tt> methods and various descriptor
behaviours has also been improved substantially by the underlying changes in
the <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><tt class="xref py py-mod docutils literal"><span class="pre">inspect</span></tt></a> module.</p>
<p>As the <a class="reference internal" href="../library/functions.html#help" title="help"><tt class="xref py py-func docutils literal"><span class="pre">help()</span></tt></a> builtin is based on <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a>, the above changes also
affect the behaviour of <a class="reference internal" href="../library/functions.html#help" title="help"><tt class="xref py py-func docutils literal"><span class="pre">help()</span></tt></a>.</p>
</div>
<div class="section" id="re">
<h3>re<a class="headerlink" href="#re" title="Permalink to this headline">¶</a></h3>
<p>New <a class="reference internal" href="../library/re.html#re.fullmatch" title="re.fullmatch"><tt class="xref py py-func docutils literal"><span class="pre">fullmatch()</span></tt></a> function and <a class="reference internal" href="../library/re.html#re.regex.fullmatch" title="re.regex.fullmatch"><tt class="xref py py-meth docutils literal"><span class="pre">regex.fullmatch()</span></tt></a> method anchor
the pattern at both ends of the string to match.  This provides a way to be
explicit about the goal of the match, which avoids a class of subtle bugs where
<tt class="docutils literal"><span class="pre">$</span></tt> characters get lost during code changes or the addition of alternatives
to an existing regular expression.  (Contributed by Matthew Barnett in
<a class="reference external" href="https://bugs.python.org/issue16203">issue 16203</a>.)</p>
<p>The repr of <a class="reference internal" href="../library/re.html#re-objects"><em>regex objects</em></a> now includes the pattern
and the flags; the repr of <a class="reference internal" href="../library/re.html#match-objects"><em>match objects</em></a> now
includes the start, end, and the part of the string that matched.  (Contributed
by Hugo Lopes Tavares and Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue13592">issue 13592</a> and
<a class="reference external" href="https://bugs.python.org/issue17087">issue 17087</a>.)</p>
</div>
<div class="section" id="resource">
<h3>resource<a class="headerlink" href="#resource" title="Permalink to this headline">¶</a></h3>
<p>New <a class="reference internal" href="../library/resource.html#resource.prlimit" title="resource.prlimit"><tt class="xref py py-func docutils literal"><span class="pre">prlimit()</span></tt></a> function, available on Linux platforms with a
kernel version of 2.6.36 or later and glibc of 2.13 or later, provides the
ability to query or set the resource limits for processes other than the one
making the call.  (Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue16595">issue 16595</a>.)</p>
<p>On Linux kernel version 2.6.36 or later, there are there are also some new
Linux specific constants: <a class="reference internal" href="../library/resource.html#resource.RLIMIT_MSGQUEUE" title="resource.RLIMIT_MSGQUEUE"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_MSGQUEUE</span></tt></a>,
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_NICE" title="resource.RLIMIT_NICE"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_NICE</span></tt></a>, <a class="reference internal" href="../library/resource.html#resource.RLIMIT_RTPRIO" title="resource.RLIMIT_RTPRIO"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_RTPRIO</span></tt></a>,
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_RTTIME" title="resource.RLIMIT_RTTIME"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_RTTIME</span></tt></a>, and <a class="reference internal" href="../library/resource.html#resource.RLIMIT_SIGPENDING" title="resource.RLIMIT_SIGPENDING"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_SIGPENDING</span></tt></a>.
(Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue19324">issue 19324</a>.)</p>
<p>On FreeBSD version 9 and later, there some new FreeBSD specific constants:
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_SBSIZE" title="resource.RLIMIT_SBSIZE"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_SBSIZE</span></tt></a>, <a class="reference internal" href="../library/resource.html#resource.RLIMIT_SWAP" title="resource.RLIMIT_SWAP"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_SWAP</span></tt></a>, and
<a class="reference internal" href="../library/resource.html#resource.RLIMIT_NPTS" title="resource.RLIMIT_NPTS"><tt class="xref py py-attr docutils literal"><span class="pre">RLIMIT_NPTS</span></tt></a>.  (Contributed by Claudiu Popa in
<a class="reference external" href="https://bugs.python.org/issue19343">issue 19343</a>.)</p>
</div>
<div class="section" id="select">
<h3>select<a class="headerlink" href="#select" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/select.html#select.epoll" title="select.epoll"><tt class="xref py py-class docutils literal"><span class="pre">epoll</span></tt></a> objects now support the context management protocol.
When used in a <a class="reference internal" href="../reference/compound_stmts.html#with"><tt class="xref std std-keyword docutils literal"><span class="pre">with</span></tt></a> statement, the <a class="reference internal" href="../library/select.html#select.epoll.close" title="select.epoll.close"><tt class="xref py py-meth docutils literal"><span class="pre">close()</span></tt></a>
method will be called automatically at the end of the block.  (Contributed
by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue16488">issue 16488</a>.)</p>
<p><a class="reference internal" href="../library/select.html#select.devpoll" title="select.devpoll"><tt class="xref py py-class docutils literal"><span class="pre">devpoll</span></tt></a> objects now have <a class="reference internal" href="../library/select.html#select.devpoll.fileno" title="select.devpoll.fileno"><tt class="xref py py-meth docutils literal"><span class="pre">fileno()</span></tt></a> and
<a class="reference internal" href="../library/select.html#select.devpoll.close" title="select.devpoll.close"><tt class="xref py py-meth docutils literal"><span class="pre">close()</span></tt></a> methods, as well as a new attribute
<a class="reference internal" href="../library/select.html#select.devpoll.closed" title="select.devpoll.closed"><tt class="xref py py-attr docutils literal"><span class="pre">closed</span></tt></a>.  (Contributed by Victor Stinner in
<a class="reference external" href="https://bugs.python.org/issue18794">issue 18794</a>.)</p>
</div>
<div class="section" id="shelve">
<h3>shelve<a class="headerlink" href="#shelve" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/shelve.html#shelve.Shelf" title="shelve.Shelf"><tt class="xref py py-class docutils literal"><span class="pre">Shelf</span></tt></a> instances may now be used in <a class="reference internal" href="../reference/compound_stmts.html#with"><tt class="xref std std-keyword docutils literal"><span class="pre">with</span></tt></a> statements,
and will be automatically closed at the end of the <a class="reference internal" href="../reference/compound_stmts.html#with"><tt class="xref std std-keyword docutils literal"><span class="pre">with</span></tt></a> block.
(Contributed by Filip Gruszczyński in <a class="reference external" href="https://bugs.python.org/issue13896">issue 13896</a>.)</p>
</div>
<div class="section" id="shutil">
<h3>shutil<a class="headerlink" href="#shutil" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/shutil.html#shutil.copyfile" title="shutil.copyfile"><tt class="xref py py-func docutils literal"><span class="pre">copyfile()</span></tt></a> now raises a specific <a class="reference internal" href="../library/shutil.html#shutil.Error" title="shutil.Error"><tt class="xref py py-exc docutils literal"><span class="pre">Error</span></tt></a> subclass,
<a class="reference internal" href="../library/shutil.html#shutil.SameFileError" title="shutil.SameFileError"><tt class="xref py py-exc docutils literal"><span class="pre">SameFileError</span></tt></a>, when the source and destination are the same
file, which allows an application to take appropriate action on this specific
error.  (Contributed by Atsuo Ishimoto and Hynek Schlawack in
<a class="reference external" href="https://bugs.python.org/issue1492704">issue 1492704</a>.)</p>
</div>
<div class="section" id="smtpd">
<h3>smtpd<a class="headerlink" href="#smtpd" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/smtpd.html#smtpd.SMTPServer" title="smtpd.SMTPServer"><tt class="xref py py-class docutils literal"><span class="pre">SMTPServer</span></tt></a> and <a class="reference internal" href="../library/smtpd.html#smtpd.SMTPChannel" title="smtpd.SMTPChannel"><tt class="xref py py-class docutils literal"><span class="pre">SMTPChannel</span></tt></a> classes now
accept a <em>map</em> keyword argument which, if specified, is passed in to
<a class="reference internal" href="../library/asynchat.html#asynchat.async_chat" title="asynchat.async_chat"><tt class="xref py py-class docutils literal"><span class="pre">asynchat.async_chat</span></tt></a> as its <em>map</em> argument.  This allows an application
to avoid affecting the global socket map.  (Contributed by Vinay Sajip in
<a class="reference external" href="https://bugs.python.org/issue11959">issue 11959</a>.)</p>
</div>
<div class="section" id="smtplib">
<h3>smtplib<a class="headerlink" href="#smtplib" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/smtplib.html#smtplib.SMTPException" title="smtplib.SMTPException"><tt class="xref py py-exc docutils literal"><span class="pre">SMTPException</span></tt></a> is now a subclass of <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><tt class="xref py py-exc docutils literal"><span class="pre">OSError</span></tt></a>, which allows
both socket level errors and SMTP protocol level errors to be caught in one
try/except statement by code that only cares whether or not an error occurred.
(Contributed by Ned Jackson Lovely in <a class="reference external" href="https://bugs.python.org/issue2118">issue 2118</a>.)</p>
</div>
<div class="section" id="socket">
<h3>socket<a class="headerlink" href="#socket" title="Permalink to this headline">¶</a></h3>
<p>The socket module now supports the <a class="reference internal" href="../library/socket.html#socket.CAN_BCM" title="socket.CAN_BCM"><tt class="xref py py-data docutils literal"><span class="pre">CAN_BCM</span></tt></a> protocol on
platforms that support it.  (Contributed by Brian Thorne in <a class="reference external" href="https://bugs.python.org/issue15359">issue 15359</a>.)</p>
<p>Socket objects have new methods to get or set their <a class="reference internal" href="../library/os.html#fd-inheritance"><em>inheritable flag</em></a>, <a class="reference internal" href="../library/socket.html#socket.socket.get_inheritable" title="socket.socket.get_inheritable"><tt class="xref py py-meth docutils literal"><span class="pre">get_inheritable()</span></tt></a> and
<a class="reference internal" href="../library/socket.html#socket.socket.set_inheritable" title="socket.socket.set_inheritable"><tt class="xref py py-meth docutils literal"><span class="pre">set_inheritable()</span></tt></a>.</p>
<p>The <tt class="docutils literal"><span class="pre">socket.AF_*</span></tt> and <tt class="docutils literal"><span class="pre">socket.SOCK_*</span></tt> constants are now enumeration values
using the new <a class="reference internal" href="../library/enum.html#module-enum" title="enum: Implementation of an enumeration class."><tt class="xref py py-mod docutils literal"><span class="pre">enum</span></tt></a> module.  This allows meaningful names to be printed
during debugging, instead of integer &#8220;magic numbers&#8221;.</p>
<p>The <a class="reference internal" href="../library/socket.html#socket.AF_LINK" title="socket.AF_LINK"><tt class="xref py py-data docutils literal"><span class="pre">AF_LINK</span></tt></a> constant is now available on BSD and OSX.</p>
<p><a class="reference internal" href="../library/socket.html#socket.inet_pton" title="socket.inet_pton"><tt class="xref py py-func docutils literal"><span class="pre">inet_pton()</span></tt></a> and <a class="reference internal" href="../library/socket.html#socket.inet_ntop" title="socket.inet_ntop"><tt class="xref py py-func docutils literal"><span class="pre">inet_ntop()</span></tt></a> are now supported
on Windows.  (Contributed by Atsuo Ishimoto in <a class="reference external" href="https://bugs.python.org/issue7171">issue 7171</a>.)</p>
</div>
<div class="section" id="sqlite3">
<h3>sqlite3<a class="headerlink" href="#sqlite3" title="Permalink to this headline">¶</a></h3>
<p>A new boolean parameter to the <a class="reference internal" href="../library/sqlite3.html#sqlite3.connect" title="sqlite3.connect"><tt class="xref py py-func docutils literal"><span class="pre">connect()</span></tt></a> function, <em>uri</em>, can be
used to indicate that the <em>database</em> parameter is a <tt class="docutils literal"><span class="pre">uri</span></tt> (see the <a class="reference external" href="http://www.sqlite.org/uri.html">SQLite
URI documentation</a>).  (Contributed by poq in
<a class="reference external" href="https://bugs.python.org/issue13773">issue 13773</a>.)</p>
</div>
<div class="section" id="ssl">
<h3>ssl<a class="headerlink" href="#ssl" title="Permalink to this headline">¶</a></h3>
<p id="whatsnew-tls-11-12"><a class="reference internal" href="../library/ssl.html#ssl.PROTOCOL_TLSv1_1" title="ssl.PROTOCOL_TLSv1_1"><tt class="xref py py-data docutils literal"><span class="pre">PROTOCOL_TLSv1_1</span></tt></a> and <a class="reference internal" href="../library/ssl.html#ssl.PROTOCOL_TLSv1_2" title="ssl.PROTOCOL_TLSv1_2"><tt class="xref py py-data docutils literal"><span class="pre">PROTOCOL_TLSv1_2</span></tt></a> (TLSv1.1 and
TLSv1.2 support) have been added; support for these protocols is only available if
Python is linked with OpenSSL 1.0.1 or later.  (Contributed by Michele Orrù and
Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue16692">issue 16692</a>.)</p>
<p id="whatsnew34-sslcontext">New function <a class="reference internal" href="../library/ssl.html#ssl.create_default_context" title="ssl.create_default_context"><tt class="xref py py-func docutils literal"><span class="pre">create_default_context()</span></tt></a> provides a standard way to
obtain an <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">SSLContext</span></tt></a> whose settings are intended to be a
reasonable balance between compatibility and security.  These settings are
more stringent than the defaults provided by the <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">SSLContext</span></tt></a>
constructor, and may be adjusted in the future, without prior deprecation, if
best-practice security requirements change.  The new recommended best
practice for using stdlib libraries that support SSL is to use
<a class="reference internal" href="../library/ssl.html#ssl.create_default_context" title="ssl.create_default_context"><tt class="xref py py-func docutils literal"><span class="pre">create_default_context()</span></tt></a> to obtain an <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">SSLContext</span></tt></a>
object, modify it if needed, and then pass it as the <em>context</em> argument
of the appropriate stdlib API.  (Contributed by Christian Heimes
in <a class="reference external" href="https://bugs.python.org/issue19689">issue 19689</a>.)</p>
<p><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">SSLContext</span></tt></a> method <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_verify_locations" title="ssl.SSLContext.load_verify_locations"><tt class="xref py py-meth docutils literal"><span class="pre">load_verify_locations()</span></tt></a>
accepts a new optional argument <em>cadata</em>, which can be used to provide PEM or
DER encoded certificates directly via strings or bytes, respectively.
(Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue18138">issue 18138</a>.)</p>
<p>New function <a class="reference internal" href="../library/ssl.html#ssl.get_default_verify_paths" title="ssl.get_default_verify_paths"><tt class="xref py py-func docutils literal"><span class="pre">get_default_verify_paths()</span></tt></a> returns
a named tuple of the paths and environment variables that the
<a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_default_verify_paths" title="ssl.SSLContext.set_default_verify_paths"><tt class="xref py py-meth docutils literal"><span class="pre">set_default_verify_paths()</span></tt></a> method uses to set
OpenSSL&#8217;s default <tt class="docutils literal"><span class="pre">cafile</span></tt> and <tt class="docutils literal"><span class="pre">capath</span></tt>.  This can be an aid in
debugging default verification issues.  (Contributed by Christian Heimes
in <a class="reference external" href="https://bugs.python.org/issue18143">issue 18143</a>.)</p>
<p><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">SSLContext</span></tt></a> has a new method,
<a class="reference internal" href="../library/ssl.html#ssl.SSLContext.cert_store_stats" title="ssl.SSLContext.cert_store_stats"><tt class="xref py py-meth docutils literal"><span class="pre">cert_store_stats()</span></tt></a>, that reports the number of loaded
<tt class="docutils literal"><span class="pre">X.509</span></tt> certs, <tt class="docutils literal"><span class="pre">X.509</span> <span class="pre">CA</span></tt> certs, and certificate revocation lists (<tt class="docutils literal"><span class="pre">crl</span></tt>s), as well as a <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.get_ca_certs" title="ssl.SSLContext.get_ca_certs"><tt class="xref py py-meth docutils literal"><span class="pre">get_ca_certs()</span></tt></a> method that returns a
list of the loaded <tt class="docutils literal"><span class="pre">CA</span></tt> certificates.  (Contributed by Christian Heimes in
<a class="reference external" href="https://bugs.python.org/issue18147">issue 18147</a>.)</p>
<p>If OpenSSL 0.9.8 or later is available, <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">SSLContext</span></tt></a> has an new
attribute <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.verify_flags" title="ssl.SSLContext.verify_flags"><tt class="xref py py-attr docutils literal"><span class="pre">verify_flags</span></tt></a> that can be used to control the
certificate verification process by setting it to some combination of the new
constants <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_DEFAULT" title="ssl.VERIFY_DEFAULT"><tt class="xref py py-data docutils literal"><span class="pre">VERIFY_DEFAULT</span></tt></a>, <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_CRL_CHECK_LEAF" title="ssl.VERIFY_CRL_CHECK_LEAF"><tt class="xref py py-data docutils literal"><span class="pre">VERIFY_CRL_CHECK_LEAF</span></tt></a>,
<a class="reference internal" href="../library/ssl.html#ssl.VERIFY_CRL_CHECK_CHAIN" title="ssl.VERIFY_CRL_CHECK_CHAIN"><tt class="xref py py-data docutils literal"><span class="pre">VERIFY_CRL_CHECK_CHAIN</span></tt></a>, or <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_X509_STRICT" title="ssl.VERIFY_X509_STRICT"><tt class="xref py py-data docutils literal"><span class="pre">VERIFY_X509_STRICT</span></tt></a>.
OpenSSL does not do any CRL verification by default.  (Contributed by
Christien Heimes in <a class="reference external" href="https://bugs.python.org/issue8813">issue 8813</a>.)</p>
<p>New <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><tt class="xref py py-class docutils literal"><span class="pre">SSLContext</span></tt></a> method <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_default_certs" title="ssl.SSLContext.load_default_certs"><tt class="xref py py-meth docutils literal"><span class="pre">load_default_certs()</span></tt></a>
loads a set of default &#8220;certificate authority&#8221; (CA) certificates from default
locations, which vary according to the platform.  It can be used to load both
TLS web server authentication certificates
(<tt class="docutils literal"><span class="pre">purpose=</span></tt><a class="reference internal" href="../library/ssl.html#ssl.Purpose.SERVER_AUTH" title="ssl.Purpose.SERVER_AUTH"><tt class="xref py py-data docutils literal"><span class="pre">SERVER_AUTH</span></tt></a>) for a client to use to verify a
server, and certificates for a server to use in verifying client certificates
(<tt class="docutils literal"><span class="pre">purpose=</span></tt><a class="reference internal" href="../library/ssl.html#ssl.Purpose.CLIENT_AUTH" title="ssl.Purpose.CLIENT_AUTH"><tt class="xref py py-data docutils literal"><span class="pre">CLIENT_AUTH</span></tt></a>).  (Contributed by Christian
Heimes in <a class="reference external" href="https://bugs.python.org/issue19292">issue 19292</a>.)</p>
<p id="whatsnew34-win-cert-store">Two new windows-only functions, <a class="reference internal" href="../library/ssl.html#ssl.enum_certificates" title="ssl.enum_certificates"><tt class="xref py py-func docutils literal"><span class="pre">enum_certificates()</span></tt></a> and
<a class="reference internal" href="../library/ssl.html#ssl.enum_crls" title="ssl.enum_crls"><tt class="xref py py-func docutils literal"><span class="pre">enum_crls()</span></tt></a> provide the ability to retrieve certificates,
certificate information, and CRLs from the Windows cert store.  (Contributed
by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue17134">issue 17134</a>.)</p>
<p id="whatsnew34-sni">Support for server-side SNI (Server Name Indication) using the new
<a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_servername_callback" title="ssl.SSLContext.set_servername_callback"><tt class="xref py py-meth docutils literal"><span class="pre">ssl.SSLContext.set_servername_callback()</span></tt></a> method.
(Contributed by Daniel Black in <a class="reference external" href="https://bugs.python.org/issue8109">issue 8109</a>.)</p>
<p>The dictionary returned by <a class="reference internal" href="../library/ssl.html#ssl.SSLSocket.getpeercert" title="ssl.SSLSocket.getpeercert"><tt class="xref py py-meth docutils literal"><span class="pre">SSLSocket.getpeercert()</span></tt></a> contains additional
<tt class="docutils literal"><span class="pre">X509v3</span></tt> extension items: <tt class="docutils literal"><span class="pre">crlDistributionPoints</span></tt>, <tt class="docutils literal"><span class="pre">calIssuers</span></tt>, and
<tt class="docutils literal"><span class="pre">OCSP</span></tt> URIs.  (Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue18379">issue 18379</a>.)</p>
</div>
<div class="section" id="stat">
<h3>stat<a class="headerlink" href="#stat" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/stat.html#module-stat" title="stat: Utilities for interpreting the results of os.stat(), os.lstat() and os.fstat()."><tt class="xref py py-mod docutils literal"><span class="pre">stat</span></tt></a> module is now backed by a C implementation in <tt class="xref py py-mod docutils literal"><span class="pre">_stat</span></tt>. A C
implementation is required as most of the values aren&#8217;t standardized and
are platform-dependent.  (Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue11016">issue 11016</a>.)</p>
<p>The module supports new <a class="reference internal" href="../library/stat.html#stat.ST_MODE" title="stat.ST_MODE"><tt class="xref py py-mod docutils literal"><span class="pre">ST_MODE</span></tt></a> flags, <a class="reference internal" href="../library/stat.html#stat.S_IFDOOR" title="stat.S_IFDOOR"><tt class="xref py py-mod docutils literal"><span class="pre">S_IFDOOR</span></tt></a>,
<a class="reference internal" href="../library/stat.html#stat.S_IFPORT" title="stat.S_IFPORT"><tt class="xref py py-attr docutils literal"><span class="pre">S_IFPORT</span></tt></a>, and <a class="reference internal" href="../library/stat.html#stat.S_IFWHT" title="stat.S_IFWHT"><tt class="xref py py-attr docutils literal"><span class="pre">S_IFWHT</span></tt></a>.  (Contributed by
Christian Hiemes in <a class="reference external" href="https://bugs.python.org/issue11016">issue 11016</a>.)</p>
</div>
<div class="section" id="struct">
<h3>struct<a class="headerlink" href="#struct" title="Permalink to this headline">¶</a></h3>
<p>New function <a class="reference internal" href="../library/struct.html#struct.iter_unpack" title="struct.iter_unpack"><tt class="xref py py-mod docutils literal"><span class="pre">iter_unpack</span></tt></a> and a new
<a class="reference internal" href="../library/struct.html#struct.Struct.iter_unpack" title="struct.Struct.iter_unpack"><tt class="xref py py-meth docutils literal"><span class="pre">struct.Struct.iter_unpack()</span></tt></a> method on compiled formats provide streamed
unpacking of a buffer containing repeated instances of a given format of data.
(Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue17804">issue 17804</a>.)</p>
</div>
<div class="section" id="subprocess">
<h3>subprocess<a class="headerlink" href="#subprocess" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/subprocess.html#subprocess.check_output" title="subprocess.check_output"><tt class="xref py py-func docutils literal"><span class="pre">check_output()</span></tt></a> now accepts an <em>input</em> argument that can
be used to provide the contents of <tt class="docutils literal"><span class="pre">stdin</span></tt> for the command that is run.
(Contributed by Zack Weinberg in <a class="reference external" href="https://bugs.python.org/issue16624">issue 16624</a>.)</p>
<p><tt class="xref py py-func docutils literal"><span class="pre">getstatus()</span></tt> and <a class="reference internal" href="../library/subprocess.html#subprocess.getstatusoutput" title="subprocess.getstatusoutput"><tt class="xref py py-func docutils literal"><span class="pre">getstatusoutput()</span></tt></a> now
work on Windows.  This change was actually inadvertently made in 3.3.4.
(Contributed by Tim Golden in <a class="reference external" href="https://bugs.python.org/issue10197">issue 10197</a>.)</p>
</div>
<div class="section" id="sunau">
<h3>sunau<a class="headerlink" href="#sunau" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="xref py py-meth docutils literal"><span class="pre">getparams()</span></tt> method now returns a namedtuple rather than a
plain tuple.  (Contributed by Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue18901">issue 18901</a>.)</p>
<p><a class="reference internal" href="../library/sunau.html#sunau.open" title="sunau.open"><tt class="xref py py-meth docutils literal"><span class="pre">sunau.open()</span></tt></a> now supports the context management protocol: when used in a
<a class="reference internal" href="../reference/compound_stmts.html#with"><tt class="xref std std-keyword docutils literal"><span class="pre">with</span></tt></a> block, the <tt class="docutils literal"><span class="pre">close</span></tt> method of the returned object will be
called automatically at the end of the block.  (Contributed by Serhiy Storchaka
in <a class="reference external" href="https://bugs.python.org/issue18878">issue 18878</a>.)</p>
<p><a class="reference internal" href="../library/sunau.html#sunau.AU_write.setsampwidth" title="sunau.AU_write.setsampwidth"><tt class="xref py py-meth docutils literal"><span class="pre">AU_write.setsampwidth()</span></tt></a> now supports 24 bit samples, thus adding
support for writing 24 sample using the module.  (Contributed by
Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue19261">issue 19261</a>.)</p>
<p>The <a class="reference internal" href="../library/sunau.html#sunau.AU_write.writeframesraw" title="sunau.AU_write.writeframesraw"><tt class="xref py py-meth docutils literal"><span class="pre">writeframesraw()</span></tt></a> and
<a class="reference internal" href="../library/sunau.html#sunau.AU_write.writeframes" title="sunau.AU_write.writeframes"><tt class="xref py py-meth docutils literal"><span class="pre">writeframes()</span></tt></a> methods now accept any <a class="reference internal" href="../glossary.html#term-bytes-like-object"><em class="xref std std-term">bytes-like
object</em></a>.  (Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue8311">issue 8311</a>.)</p>
</div>
<div class="section" id="sys">
<h3>sys<a class="headerlink" href="#sys" title="Permalink to this headline">¶</a></h3>
<p>New function <a class="reference internal" href="../library/sys.html#sys.getallocatedblocks" title="sys.getallocatedblocks"><tt class="xref py py-func docutils literal"><span class="pre">sys.getallocatedblocks()</span></tt></a> returns the current number of
blocks allocated by the interpreter.  (In CPython with the default
<tt class="docutils literal"><span class="pre">--with-pymalloc</span></tt> setting, this is allocations made through the
<tt class="xref c c-func docutils literal"><span class="pre">PyObject_Malloc()</span></tt> API.)  This can be useful for tracking memory leaks,
especially if automated via a test suite.  (Contributed by Antoine Pitrou
in <a class="reference external" href="https://bugs.python.org/issue13390">issue 13390</a>.)</p>
<p>When the Python interpreter starts in <a class="reference internal" href="../tutorial/interpreter.html#tut-interactive"><em>interactive mode</em></a>, it checks for an <a class="reference internal" href="../library/sys.html#sys.__interactivehook__" title="sys.__interactivehook__"><tt class="xref py py-data docutils literal"><span class="pre">__interactivehook__</span></tt></a> attribute
on the <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><tt class="xref py py-mod docutils literal"><span class="pre">sys</span></tt></a> module.  If the attribute exists, its value is called with no
arguments just before interactive mode is started.  The check is made after the
<span class="target" id="index-40"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONSTARTUP"><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONSTARTUP</span></tt></a> file is read, so it can be set there.  The <a class="reference internal" href="../library/site.html#module-site" title="site: Module responsible for site-specific configuration."><tt class="xref py py-mod docutils literal"><span class="pre">site</span></tt></a>
module <a class="reference internal" href="../library/site.html#rlcompleter-config"><em>sets it</em></a> to a function that enables tab
completion and history saving (in <tt class="file docutils literal"><span class="pre">~/.python-history</span></tt>) if the platform
supports <a class="reference internal" href="../library/readline.html#module-readline" title="readline: GNU readline support for Python. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">readline</span></tt></a>.  If you do not want this (new) behavior, you can
override it in <span class="target" id="index-41"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONSTARTUP"><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONSTARTUP</span></tt></a>, <tt class="xref py py-mod docutils literal"><span class="pre">sitecustomize</span></tt>, or
<tt class="xref py py-mod docutils literal"><span class="pre">usercustomize</span></tt> by deleting this attribute from <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><tt class="xref py py-mod docutils literal"><span class="pre">sys</span></tt></a> (or setting it
to some other callable).  (Contributed by Éric Araujo and Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue5845">issue 5845</a>.)</p>
</div>
<div class="section" id="tarfile">
<h3>tarfile<a class="headerlink" href="#tarfile" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><tt class="xref py py-mod docutils literal"><span class="pre">tarfile</span></tt></a> module now supports a simple <a class="reference internal" href="../library/tarfile.html#tarfile-commandline"><em>Command Line Interface</em></a> when
called as a script directly or via <tt class="docutils literal"><span class="pre">-m</span></tt>.  This can be used to create and
extract tarfile archives.  (Contributed by Berker Peksag in <a class="reference external" href="https://bugs.python.org/issue13477">issue 13477</a>.)</p>
</div>
<div class="section" id="textwrap">
<h3>textwrap<a class="headerlink" href="#textwrap" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/textwrap.html#textwrap.TextWrapper" title="textwrap.TextWrapper"><tt class="xref py py-class docutils literal"><span class="pre">TextWrapper</span></tt></a> class has two new attributes/constructor
arguments: <a class="reference internal" href="../library/textwrap.html#textwrap.TextWrapper.max_lines" title="textwrap.TextWrapper.max_lines"><tt class="xref py py-attr docutils literal"><span class="pre">max_lines</span></tt></a>, which limits the number of
lines in the output, and <a class="reference internal" href="../library/textwrap.html#textwrap.TextWrapper.placeholder" title="textwrap.TextWrapper.placeholder"><tt class="xref py py-attr docutils literal"><span class="pre">placeholder</span></tt></a>, which is a
string that will appear at the end of the output if it has been truncated
because of <em>max_lines</em>.  Building on these capabilities, a new convenience
function <a class="reference internal" href="../library/textwrap.html#textwrap.shorten" title="textwrap.shorten"><tt class="xref py py-func docutils literal"><span class="pre">shorten()</span></tt></a> collapses all of the whitespace in the input
to single spaces and produces a single line of a given <em>width</em> that ends with
the <em>placeholder</em> (by default, <tt class="docutils literal"><span class="pre">[...]</span></tt>).  (Contributed by Antoine Pitrou and
Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue18585">issue 18585</a> and <a class="reference external" href="https://bugs.python.org/issue18725">issue 18725</a>.)</p>
</div>
<div class="section" id="threading">
<h3>threading<a class="headerlink" href="#threading" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/threading.html#threading.Thread" title="threading.Thread"><tt class="xref py py-class docutils literal"><span class="pre">Thread</span></tt></a> object representing the main thread can be
obtained from the new <a class="reference internal" href="../library/threading.html#threading.main_thread" title="threading.main_thread"><tt class="xref py py-func docutils literal"><span class="pre">main_thread()</span></tt></a> function.  In normal
conditions this will be the thread from which the Python interpreter was
started.  (Contributed by Andrew Svetlov in <a class="reference external" href="https://bugs.python.org/issue18882">issue 18882</a>.)</p>
</div>
<div class="section" id="traceback">
<h3>traceback<a class="headerlink" href="#traceback" title="Permalink to this headline">¶</a></h3>
<p>A new <a class="reference internal" href="../library/traceback.html#traceback.clear_frames" title="traceback.clear_frames"><tt class="xref py py-func docutils literal"><span class="pre">traceback.clear_frames()</span></tt></a> function takes a traceback object
and clears the local variables in all of the frames it references,
reducing the amount of memory consumed.  (Contributed by Andrew Kuchling in
<a class="reference external" href="https://bugs.python.org/issue1565525">issue 1565525</a>.)</p>
</div>
<div class="section" id="types">
<h3>types<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h3>
<p>A new <a class="reference internal" href="../library/types.html#types.DynamicClassAttribute" title="types.DynamicClassAttribute"><tt class="xref py py-func docutils literal"><span class="pre">DynamicClassAttribute()</span></tt></a> descriptor provides a way to define
an attribute that acts normally when looked up through an instance object, but
which is routed to the <em>class</em> <tt class="docutils literal"><span class="pre">__getattr__</span></tt> when looked up through the
class.  This allows one to have properties active on a class, and have virtual
attributes on the class with the same name (see <tt class="xref py py-mod docutils literal"><span class="pre">Enum</span></tt> for an example).
(Contributed by Ethan Furman in <a class="reference external" href="https://bugs.python.org/issue19030">issue 19030</a>.)</p>
</div>
<div class="section" id="urllib">
<h3>urllib<a class="headerlink" href="#urllib" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/urllib.request.html#module-urllib.request" title="urllib.request: Extensible library for opening URLs."><tt class="xref py py-mod docutils literal"><span class="pre">urllib.request</span></tt></a> now supports <tt class="docutils literal"><span class="pre">data:</span></tt> URLs via the
<a class="reference internal" href="../library/urllib.request.html#urllib.request.DataHandler" title="urllib.request.DataHandler"><tt class="xref py py-class docutils literal"><span class="pre">DataHandler</span></tt></a> class.  (Contributed by Mathias Panzenböck
in <a class="reference external" href="https://bugs.python.org/issue16423">issue 16423</a>.)</p>
<p>The http method that will be used by a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><tt class="xref py py-class docutils literal"><span class="pre">Request</span></tt></a> class
can now be specified by setting a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.method" title="urllib.request.Request.method"><tt class="xref py py-class docutils literal"><span class="pre">method</span></tt></a>
class attribute on the subclass.  (Contributed by Jason R Coombs in
<a class="reference external" href="https://bugs.python.org/issue18978">issue 18978</a>.)</p>
<p><a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><tt class="xref py py-class docutils literal"><span class="pre">Request</span></tt></a> objects are now reusable: if the
<a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.full_url" title="urllib.request.Request.full_url"><tt class="xref py py-attr docutils literal"><span class="pre">full_url</span></tt></a> or <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.data" title="urllib.request.Request.data"><tt class="xref py py-attr docutils literal"><span class="pre">data</span></tt></a>
attributes are modified, all relevant internal properties are updated.  This
means, for example, that it is now possible to use the same
<a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><tt class="xref py py-class docutils literal"><span class="pre">Request</span></tt></a> object in more than one
<a class="reference internal" href="../library/urllib.request.html#urllib.request.OpenerDirector.open" title="urllib.request.OpenerDirector.open"><tt class="xref py py-meth docutils literal"><span class="pre">OpenerDirector.open()</span></tt></a> call with different <em>data</em> arguments, or to
modify a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><tt class="xref py py-class docutils literal"><span class="pre">Request</span></tt></a>&#8216;s <tt class="docutils literal"><span class="pre">url</span></tt> rather than recomputing it
from scratch.  There is also a new
<a class="reference internal" href="../library/urllib.request.html#urllib.request.Request.remove_header" title="urllib.request.Request.remove_header"><tt class="xref py py-meth docutils literal"><span class="pre">remove_header()</span></tt></a> method that can be used to remove
headers from a <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><tt class="xref py py-class docutils literal"><span class="pre">Request</span></tt></a>.  (Contributed by Alexey
Kachayev in <a class="reference external" href="https://bugs.python.org/issue16464">issue 16464</a>, Daniel Wozniak in <a class="reference external" href="https://bugs.python.org/issue17485">issue 17485</a>, and Damien Brecht
and Senthil Kumaran in <a class="reference external" href="https://bugs.python.org/issue17272">issue 17272</a>.)</p>
<p><a class="reference internal" href="../library/urllib.error.html#urllib.error.HTTPError" title="urllib.error.HTTPError"><tt class="xref py py-class docutils literal"><span class="pre">HTTPError</span></tt></a> objects now have a
<a class="reference internal" href="../library/urllib.error.html#urllib.error.HTTPError.headers" title="urllib.error.HTTPError.headers"><tt class="xref py py-attr docutils literal"><span class="pre">headers</span></tt></a> attribute that provides access to the
HTTP response headers associated with the error.  (Contributed by
Berker Peksag in <a class="reference external" href="https://bugs.python.org/issue15701">issue 15701</a>.)</p>
</div>
<div class="section" id="unittest">
<h3>unittest<a class="headerlink" href="#unittest" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/unittest.html#unittest.TestCase" title="unittest.TestCase"><tt class="xref py py-class docutils literal"><span class="pre">TestCase</span></tt></a> class has a new method,
<a class="reference internal" href="../library/unittest.html#unittest.TestCase.subTest" title="unittest.TestCase.subTest"><tt class="xref py py-meth docutils literal"><span class="pre">subTest()</span></tt></a>, that produces a context manager whose
<a class="reference internal" href="../reference/compound_stmts.html#with"><tt class="xref std std-keyword docutils literal"><span class="pre">with</span></tt></a> block becomes a &#8220;sub-test&#8221;.  This context manager allows a test
method to dynamically generate subtests  by, say, calling the <tt class="docutils literal"><span class="pre">subTest</span></tt>
context manager inside a loop.  A single test method can thereby produce an
indefinite number of separately-identified and separately-counted tests, all of
which will run even if one or more of them fail.  For example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="k">class</span> <span class="nc">NumbersTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_even</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>will result in six subtests, each identified in the unittest verbose output
with a label consisting of the variable name <tt class="docutils literal"><span class="pre">i</span></tt> and a particular value for
that variable (<tt class="docutils literal"><span class="pre">i=0</span></tt>, <tt class="docutils literal"><span class="pre">i=1</span></tt>, etc).  See <a class="reference internal" href="../library/unittest.html#subtests"><em>Distinguishing test iterations using subtests</em></a> for the full
version of this example.  (Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue16997">issue 16997</a>.)</p>
<p><a class="reference internal" href="../library/unittest.html#unittest.main" title="unittest.main"><tt class="xref py py-func docutils literal"><span class="pre">unittest.main()</span></tt></a> now accepts an iterable of test names for
<em>defaultTest</em>, where previously it only accepted a single test name as a
string.  (Contributed by Jyrki Pulliainen in <a class="reference external" href="https://bugs.python.org/issue15132">issue 15132</a>.)</p>
<p>If <a class="reference internal" href="../library/unittest.html#unittest.SkipTest" title="unittest.SkipTest"><tt class="xref py py-class docutils literal"><span class="pre">SkipTest</span></tt></a> is raised during test discovery (that is, at the
module level in the test file), it is now reported as a skip instead of an
error.  (Contributed by Zach Ware in <a class="reference external" href="https://bugs.python.org/issue16935">issue 16935</a>.)</p>
<p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.discover" title="unittest.TestLoader.discover"><tt class="xref py py-meth docutils literal"><span class="pre">discover()</span></tt></a> now sorts the discovered files to provide
consistent test ordering.  (Contributed by Martin Melin and Jeff Ramnani in
<a class="reference external" href="https://bugs.python.org/issue16709">issue 16709</a>.)</p>
<p><a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><tt class="xref py py-class docutils literal"><span class="pre">TestSuite</span></tt></a> now drops references to tests as soon as the test
has been run, if the test is successful.  On Python interpreters that do
garbage collection, this allows the tests to be garbage collected if nothing
else is holding a reference to the test.  It is possible to override this
behavior by creating a <a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><tt class="xref py py-class docutils literal"><span class="pre">TestSuite</span></tt></a> subclass that defines a
custom <tt class="docutils literal"><span class="pre">_removeTestAtIndex</span></tt> method.  (Contributed by Tom Wardill, Matt
McClure, and Andrew Svetlov in <a class="reference external" href="https://bugs.python.org/issue11798">issue 11798</a>.)</p>
<p>A new test assertion context-manager, <a class="reference internal" href="../library/unittest.html#unittest.TestCase.assertLogs" title="unittest.TestCase.assertLogs"><tt class="xref py py-meth docutils literal"><span class="pre">assertLogs()</span></tt></a>,
will ensure that a given block of code emits a log message using the
<a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a> module.  By default the message can come from any logger and
have a priority of <tt class="docutils literal"><span class="pre">INFO</span></tt> or higher, but both the logger name and an
alternative minimum logging level may be specified.  The object returned by the
context manager can be queried for the <a class="reference internal" href="../library/logging.html#logging.LogRecord" title="logging.LogRecord"><tt class="xref py py-class docutils literal"><span class="pre">LogRecord</span></tt></a>s and/or
formatted messages that were logged.  (Contributed by Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue18937">issue 18937</a>.)</p>
<p>Test discovery now works with namespace packages (Contributed by Claudiu Popa
in <a class="reference external" href="https://bugs.python.org/issue17457">issue 17457</a>.)</p>
<p><a class="reference internal" href="../library/unittest.mock.html#module-unittest.mock" title="unittest.mock: Mock object library."><tt class="xref py py-mod docutils literal"><span class="pre">unittest.mock</span></tt></a> objects now inspect their specification signatures when
matching calls, which means an argument can now be matched by either position
or name, instead of only by position.  (Contributed by Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue17015">issue 17015</a>.)</p>
<p><tt class="xref py py-func docutils literal"><span class="pre">mock_open()</span></tt> objects now have <tt class="docutils literal"><span class="pre">readline</span></tt> and <tt class="docutils literal"><span class="pre">readlines</span></tt>
methods.  (Contributed by Toshio Kuratomi in <a class="reference external" href="https://bugs.python.org/issue17467">issue 17467</a>.)</p>
</div>
<div class="section" id="venv">
<h3>venv<a class="headerlink" href="#venv" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/venv.html#module-venv" title="venv: Creation of virtual environments."><tt class="xref py py-mod docutils literal"><span class="pre">venv</span></tt></a> now includes activation scripts for the <tt class="docutils literal"><span class="pre">csh</span></tt> and <tt class="docutils literal"><span class="pre">fish</span></tt>
shells.  (Contributed by Andrew Svetlov in <a class="reference external" href="https://bugs.python.org/issue15417">issue 15417</a>.)</p>
<p><a class="reference internal" href="../library/venv.html#venv.EnvBuilder" title="venv.EnvBuilder"><tt class="xref py py-class docutils literal"><span class="pre">EnvBuilder</span></tt></a> and the <a class="reference internal" href="../library/venv.html#venv.create" title="venv.create"><tt class="xref py py-func docutils literal"><span class="pre">create()</span></tt></a> convenience function
take a new keyword argument <em>with_pip</em>, which defaults to <tt class="docutils literal"><span class="pre">False</span></tt>, that
controls whether or not <a class="reference internal" href="../library/venv.html#venv.EnvBuilder" title="venv.EnvBuilder"><tt class="xref py py-class docutils literal"><span class="pre">EnvBuilder</span></tt></a> ensures that <tt class="docutils literal"><span class="pre">pip</span></tt> is
installed in the virtual environment.  (Contributed by Nick Coghlan in
<a class="reference external" href="https://bugs.python.org/issue19552">issue 19552</a> as part of the <span class="target" id="index-42"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a> implementation.)</p>
</div>
<div class="section" id="wave">
<h3>wave<a class="headerlink" href="#wave" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="xref py py-meth docutils literal"><span class="pre">getparams()</span></tt> method now returns a namedtuple rather than a
plain tuple.  (Contributed by Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue17487">issue 17487</a>.)</p>
<p><a class="reference internal" href="../library/wave.html#wave.open" title="wave.open"><tt class="xref py py-meth docutils literal"><span class="pre">wave.open()</span></tt></a> now supports the context management protocol.  (Contributed
by Claudiu Popa in <a class="reference external" href="https://bugs.python.org/issue17616">issue 17616</a>.)</p>
<p><a class="reference internal" href="../library/wave.html#module-wave" title="wave: Provide an interface to the WAV sound format."><tt class="xref py py-mod docutils literal"><span class="pre">wave</span></tt></a> can now <a class="reference internal" href="../library/wave.html#wave-write-objects"><em>write output to unseekable files</em></a>.  (Contributed by David Jones, Guilherme Polo, and Serhiy
Storchaka in <a class="reference external" href="https://bugs.python.org/issue5202">issue 5202</a>.)</p>
<p>The <a class="reference internal" href="../library/wave.html#wave.Wave_write.writeframesraw" title="wave.Wave_write.writeframesraw"><tt class="xref py py-meth docutils literal"><span class="pre">writeframesraw()</span></tt></a> and
<a class="reference internal" href="../library/wave.html#wave.Wave_write.writeframes" title="wave.Wave_write.writeframes"><tt class="xref py py-meth docutils literal"><span class="pre">writeframes()</span></tt></a> methods now accept any <a class="reference internal" href="../glossary.html#term-bytes-like-object"><em class="xref std std-term">bytes-like
object</em></a>.  (Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue8311">issue 8311</a>.)</p>
</div>
<div class="section" id="weakref">
<h3>weakref<a class="headerlink" href="#weakref" title="Permalink to this headline">¶</a></h3>
<p>New <a class="reference internal" href="../library/weakref.html#weakref.WeakMethod" title="weakref.WeakMethod"><tt class="xref py py-class docutils literal"><span class="pre">WeakMethod</span></tt></a> class simulates weak references to bound
methods.  (Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue14631">issue 14631</a>.)</p>
<p>New <a class="reference internal" href="../library/weakref.html#weakref.finalize" title="weakref.finalize"><tt class="xref py py-class docutils literal"><span class="pre">finalize</span></tt></a> class makes it possible to register a callback
to be invoked when an object is garbage collected, without needing to
carefully manage the lifecycle of the weak reference itself.  (Contributed by
Richard Oudkerk in <a class="reference external" href="https://bugs.python.org/issue15528">issue 15528</a>.)</p>
<p>The callback, if any, associated with a <a class="reference internal" href="../library/weakref.html#weakref.ref" title="weakref.ref"><tt class="xref py py-class docutils literal"><span class="pre">ref</span></tt></a> is now
exposed via the <a class="reference internal" href="../library/weakref.html#weakref.ref.__callback__" title="weakref.ref.__callback__"><tt class="xref py py-attr docutils literal"><span class="pre">__callback__</span></tt></a> attribute.  (Contributed
by Mark Dickinson in <a class="reference external" href="https://bugs.python.org/issue17643">issue 17643</a>.)</p>
</div>
<div class="section" id="xml-etree">
<h3>xml.etree<a class="headerlink" href="#xml-etree" title="Permalink to this headline">¶</a></h3>
<p>A new parser, <a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.XMLPullParser" title="xml.etree.ElementTree.XMLPullParser"><tt class="xref py py-class docutils literal"><span class="pre">XMLPullParser</span></tt></a>, allows a
non-blocking applications to parse XML documents.  An example can be
seen at <a class="reference internal" href="../library/xml.etree.elementtree.html#elementtree-pull-parsing"><em>Pull API for non-blocking parsing</em></a>.  (Contributed by Antoine
Pitrou in <a class="reference external" href="https://bugs.python.org/issue17741">issue 17741</a>.)</p>
<p>The <a class="reference internal" href="../library/xml.etree.elementtree.html#module-xml.etree.ElementTree" title="xml.etree.ElementTree: Implementation of the ElementTree API."><tt class="xref py py-mod docutils literal"><span class="pre">xml.etree.ElementTree</span></tt></a> <a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.tostring" title="xml.etree.ElementTree.tostring"><tt class="xref py py-func docutils literal"><span class="pre">tostring()</span></tt></a> and
<a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.tostringlist" title="xml.etree.ElementTree.tostringlist"><tt class="xref py py-func docutils literal"><span class="pre">tostringlist()</span></tt></a> functions, and the
<a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.ElementTree" title="xml.etree.ElementTree.ElementTree"><tt class="xref py py-class docutils literal"><span class="pre">ElementTree</span></tt></a>
<a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.ElementTree.write" title="xml.etree.ElementTree.ElementTree.write"><tt class="xref py py-meth docutils literal"><span class="pre">write()</span></tt></a> method, now have a
<em>short_empty_elements</em> <a class="reference internal" href="../glossary.html#keyword-only-parameter"><em>keyword-only parameter</em></a>
providing control over whether elements with no content are written in
abbreviated (<tt class="docutils literal"><span class="pre">&lt;tag</span> <span class="pre">/&gt;</span></tt>) or expanded (<tt class="docutils literal"><span class="pre">&lt;tag&gt;&lt;/tag&gt;</span></tt>) form.  (Contributed by
Ariel Poliak and Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue14377">issue 14377</a>.)</p>
</div>
<div class="section" id="zipfile">
<h3>zipfile<a class="headerlink" href="#zipfile" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../library/zipfile.html#zipfile.PyZipFile.writepy" title="zipfile.PyZipFile.writepy"><tt class="xref py py-meth docutils literal"><span class="pre">writepy()</span></tt></a> method of the
<a class="reference internal" href="../library/zipfile.html#zipfile.PyZipFile" title="zipfile.PyZipFile"><tt class="xref py py-class docutils literal"><span class="pre">PyZipFile</span></tt></a> class has a new <em>filterfunc</em> option that can be
used to control which directories and files are added to the archive.  For
example, this could be used to exclude test files from the archive.
(Contributed by Christian Tismer in <a class="reference external" href="https://bugs.python.org/issue19274">issue 19274</a>.)</p>
<p>The <em>allowZip64</em> parameter to <a class="reference internal" href="../library/zipfile.html#zipfile.ZipFile" title="zipfile.ZipFile"><tt class="xref py py-class docutils literal"><span class="pre">ZipFile</span></tt></a> and
<tt class="xref py py-class docutils literal"><span class="pre">PyZipfile</span></tt> is now <tt class="docutils literal"><span class="pre">True</span></tt> by default.  (Contributed by
William Mallard in <a class="reference external" href="https://bugs.python.org/issue17201">issue 17201</a>.)</p>
</div>
</div>
<div class="section" id="cpython-implementation-changes">
<h2>CPython Implementation Changes<a class="headerlink" href="#cpython-implementation-changes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pep-445-customization-of-cpython-memory-allocators">
<span id="whatsnew-pep-445"></span><h3>PEP 445: Customization of CPython Memory Allocators<a class="headerlink" href="#pep-445-customization-of-cpython-memory-allocators" title="Permalink to this headline">¶</a></h3>
<p><span class="target" id="index-43"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0445"><strong>PEP 445</strong></a> adds new C level interfaces to customize memory allocation in
the CPython interpreter.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-44"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0445"><strong>PEP 445</strong></a> &#8211; Add new APIs to customize Python memory allocators</dt>
<dd>PEP written and implemented by Victor Stinner.</dd>
</dl>
</div>
</div>
<div class="section" id="pep-442-safe-object-finalization">
<span id="whatsnew-pep-442"></span><h3>PEP 442: Safe Object Finalization<a class="headerlink" href="#pep-442-safe-object-finalization" title="Permalink to this headline">¶</a></h3>
<p><span class="target" id="index-45"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0442"><strong>PEP 442</strong></a> removes the current limitations and quirks of object finalization
in CPython. With it, objects with <a class="reference internal" href="../reference/datamodel.html#object.__del__" title="object.__del__"><tt class="xref py py-meth docutils literal"><span class="pre">__del__()</span></tt></a> methods, as well as
generators with <a class="reference internal" href="../reference/compound_stmts.html#finally"><tt class="xref std std-keyword docutils literal"><span class="pre">finally</span></tt></a> clauses, can be finalized when they are
part of a reference cycle.</p>
<p>As part of this change, module globals are no longer forcibly set to
<a class="reference internal" href="../library/constants.html#None" title="None"><tt class="xref py py-const docutils literal"><span class="pre">None</span></tt></a> during interpreter shutdown in most cases, instead relying
on the normal operation of the cyclic garbage collector.  This avoids a
whole class of interpreter-shutdown-time errors, usually involving
<tt class="docutils literal"><span class="pre">__del__</span></tt> methods, that have plagued Python since the cyclic GC
was first introduced.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-46"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0442"><strong>PEP 442</strong></a> &#8211; Safe object finalization</dt>
<dd>PEP written and implemented by Antoine Pitrou.</dd>
</dl>
</div>
</div>
<div class="section" id="pep-456-secure-and-interchangeable-hash-algorithm">
<span id="whatsnew-pep-456"></span><h3>PEP 456: Secure and Interchangeable Hash Algorithm<a class="headerlink" href="#pep-456-secure-and-interchangeable-hash-algorithm" title="Permalink to this headline">¶</a></h3>
<p><span class="target" id="index-47"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0456"><strong>PEP 456</strong></a> follows up on earlier security fix work done on Python&#8217;s hash
algorithm to address certain DOS attacks to which public facing APIs backed by
dictionary lookups may be subject.  (See <a class="reference external" href="https://bugs.python.org/issue14621">issue 14621</a> for the start of the
current round of improvements.)  The PEP unifies CPython&#8217;s hash code to make it
easier for a packager to substitute a different hash algorithm, and switches
Python&#8217;s default implementation to a SipHash implementation on platforms that
have a 64 bit data type.  Any performance differences in comparison with the
older FNV algorithm are trivial.</p>
<p>The PEP adds additional fields to the <a class="reference internal" href="../library/sys.html#sys.hash_info" title="sys.hash_info"><tt class="xref py py-attr docutils literal"><span class="pre">sys.hash_info</span></tt></a> struct sequence to
describe the hash algorithm in use by the currently executing binary.  Otherwise,
the PEP does not alter any existing CPython APIs.</p>
</div>
<div class="section" id="pep-436-argument-clinic">
<span id="whatsnew-pep-436"></span><h3>PEP 436: Argument Clinic<a class="headerlink" href="#pep-436-argument-clinic" title="Permalink to this headline">¶</a></h3>
<p>&#8220;Argument Clinic&#8221; (<span class="target" id="index-48"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0436"><strong>PEP 436</strong></a>) is now part of the CPython build process
and can be used to simplify the process of defining and maintaining
accurate signatures for builtins and standard library extension modules
implemented in C.</p>
<p>Some standard library extension modules have been converted to use Argument
Clinic in Python 3.4, and <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a> and <a class="reference internal" href="../library/inspect.html#module-inspect" title="inspect: Extract information and source code from live objects."><tt class="xref py py-mod docutils literal"><span class="pre">inspect</span></tt></a> have been updated
accordingly.</p>
<p>It is expected that signature metadata for programmatic introspection will
be added to additional callables implemented in C as part of Python 3.4
maintenance releases.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Argument Clinic PEP is not fully up to date with the state of the
implementation. This has been deemed acceptable by the release manager
and core development team in this case, as Argument Clinic will not
be made available as a public API for third party use in Python 3.4.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><span class="target" id="index-49"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0436"><strong>PEP 436</strong></a> &#8211; The Argument Clinic DSL</dt>
<dd>PEP written and implemented by Larry Hastings.</dd>
</dl>
</div>
</div>
<div class="section" id="other-build-and-c-api-changes">
<h3>Other Build and C API Changes<a class="headerlink" href="#other-build-and-c-api-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The new <a class="reference internal" href="../c-api/type.html#c.PyType_GetSlot" title="PyType_GetSlot"><tt class="xref c c-func docutils literal"><span class="pre">PyType_GetSlot()</span></tt></a> function has been added to the stable ABI,
allowing retrieval of function pointers from named type slots when using
the limited API.  (Contributed by Martin von Löwis in <a class="reference external" href="https://bugs.python.org/issue17162">issue 17162</a>.)</li>
<li>The new <a class="reference internal" href="../c-api/init.html#c.Py_SetStandardStreamEncoding" title="Py_SetStandardStreamEncoding"><tt class="xref c c-func docutils literal"><span class="pre">Py_SetStandardStreamEncoding()</span></tt></a> pre-initialization API
allows applications embedding the CPython interpreter to reliably force
a particular encoding and error handler for the standard streams.
(Contributed by Bastien Montagne and Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue16129">issue 16129</a>.)</li>
<li>Most Python C APIs that don&#8217;t mutate string arguments are now correctly
marked as accepting <tt class="docutils literal"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*</span></tt> rather than <tt class="docutils literal"><span class="pre">char</span> <span class="pre">*</span></tt>.  (Contributed
by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue1772673">issue 1772673</a>.)</li>
<li>A new shell version of <tt class="docutils literal"><span class="pre">python-config</span></tt> can be used even when a python
interpreter is not available (for example, in cross compilation scenarios).</li>
<li><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FromFormat" title="PyUnicode_FromFormat"><tt class="xref c c-func docutils literal"><span class="pre">PyUnicode_FromFormat()</span></tt></a> now supports width and precision
specifications for <tt class="docutils literal"><span class="pre">%s</span></tt>, <tt class="docutils literal"><span class="pre">%A</span></tt>, <tt class="docutils literal"><span class="pre">%U</span></tt>, <tt class="docutils literal"><span class="pre">%V</span></tt>, <tt class="docutils literal"><span class="pre">%S</span></tt>, and <tt class="docutils literal"><span class="pre">%R</span></tt>.
(Contributed by Ysj Ray and Victor Stinner in <a class="reference external" href="https://bugs.python.org/issue7330">issue 7330</a>.)</li>
<li>New function <a class="reference internal" href="../c-api/tuple.html#c.PyStructSequence_InitType2" title="PyStructSequence_InitType2"><tt class="xref c c-func docutils literal"><span class="pre">PyStructSequence_InitType2()</span></tt></a> supplements the
existing <a class="reference internal" href="../c-api/tuple.html#c.PyStructSequence_InitType" title="PyStructSequence_InitType"><tt class="xref c c-func docutils literal"><span class="pre">PyStructSequence_InitType()</span></tt></a> function.  The difference
is that it returns <tt class="docutils literal"><span class="pre">0</span></tt> on success and <tt class="docutils literal"><span class="pre">-1</span></tt> on failure.</li>
<li>The CPython source can now be compiled using the address sanity checking
features of recent versions of GCC and clang:  the false alarms in the small
object allocator have been silenced.  (Contributed by Dhiru Kholia in
<a class="reference external" href="https://bugs.python.org/issue18596">issue 18596</a>.)</li>
<li>The Windows build now uses <a class="reference external" href="http://en.wikipedia.org/wiki/ASLR">Address Space Layout Randomization</a> and <a class="reference external" href="http://en.wikipedia.org/wiki/Data_Execution_Prevention">Data Execution Prevention</a>.  (Contributed by
Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue16632">issue 16632</a>.)</li>
<li>New function <a class="reference internal" href="../c-api/object.html#c.PyObject_LengthHint" title="PyObject_LengthHint"><tt class="xref c c-func docutils literal"><span class="pre">PyObject_LengthHint()</span></tt></a> is the C API equivalent
of <a class="reference internal" href="../library/operator.html#operator.length_hint" title="operator.length_hint"><tt class="xref py py-func docutils literal"><span class="pre">operator.length_hint()</span></tt></a>.  (Contributed by Armin Ronacher in
<a class="reference external" href="https://bugs.python.org/issue16148">issue 16148</a>.)</li>
</ul>
</div>
<div class="section" id="other-improvements">
<span id="other-improvements-3-4"></span><h3>Other Improvements<a class="headerlink" href="#other-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple" id="whatsnew-isolated-mode">
<li>The <a class="reference internal" href="../using/cmdline.html#using-on-cmdline"><em>python</em></a> command has a new <a class="reference internal" href="../using/cmdline.html#using-on-misc-options"><em>option</em></a>, <tt class="docutils literal"><span class="pre">-I</span></tt>, which causes it to run in &#8220;isolated mode&#8221;,
which means that <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><tt class="xref py py-data docutils literal"><span class="pre">sys.path</span></tt></a> contains neither the script&#8217;s directory nor
the user&#8217;s <tt class="docutils literal"><span class="pre">site-packages</span></tt> directory, and all <span class="target" id="index-50"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHON*</span></tt> environment
variables are ignored (it implies both <tt class="docutils literal"><span class="pre">-s</span></tt> and <tt class="docutils literal"><span class="pre">-E</span></tt>).  Other
restrictions may also be applied in the future, with the goal being to
isolate the execution of a script from the user&#8217;s environment.  This is
appropriate, for example, when Python is used to run a system script.  On
most POSIX systems it can and should be used in the <tt class="docutils literal"><span class="pre">#!</span></tt> line of system
scripts.  (Contributed by Christian Heimes in <a class="reference external" href="https://bugs.python.org/issue16499">issue 16499</a>.)</li>
<li>Tab-completion is now enabled by default in the interactive interpreter
on systems that support <a class="reference internal" href="../library/readline.html#module-readline" title="readline: GNU readline support for Python. (Unix)"><tt class="xref py py-mod docutils literal"><span class="pre">readline</span></tt></a>.  History is also enabled by default,
and is written to (and read from) the file <tt class="file docutils literal"><span class="pre">~/.python-history</span></tt>.
(Contributed by Antoine Pitrou and Éric Araujo in <a class="reference external" href="https://bugs.python.org/issue5845">issue 5845</a>.)</li>
<li>Invoking the Python interpreter with <tt class="docutils literal"><span class="pre">--version</span></tt> now outputs the version to
standard output instead of standard error (<a class="reference external" href="https://bugs.python.org/issue18338">issue 18338</a>). Similar changes
were made to <a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a> (<a class="reference external" href="https://bugs.python.org/issue18920">issue 18920</a>) and other modules that have
script-like invocation capabilities (<a class="reference external" href="https://bugs.python.org/issue18922">issue 18922</a>).</li>
<li>The CPython Windows installer now adds <tt class="docutils literal"><span class="pre">.py</span></tt> to the <span class="target" id="index-51"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PATHEXT</span></tt>
variable when extensions are registered, allowing users to run a python
script at the windows command prompt by just typing its name without the
<tt class="docutils literal"><span class="pre">.py</span></tt> extension.  (Contributed by Paul Moore in <a class="reference external" href="https://bugs.python.org/issue18569">issue 18569</a>.)</li>
<li>A new <tt class="docutils literal"><span class="pre">make</span></tt> target <a class="reference external" href="https://docs.python.org/devguide/coverage.html#measuring-coverage-of-c-code-with-gcov-and-lcov">coverage-report</a>
will build python, run the test suite, and generate an HTML coverage report
for the C codebase using <tt class="docutils literal"><span class="pre">gcov</span></tt> and <a class="reference external" href="http://ltp.sourceforge.net/coverage/lcov.php">lcov</a>.</li>
<li>The <tt class="docutils literal"><span class="pre">-R</span></tt> option to the <a class="reference internal" href="../library/test.html#regrtest"><em>python regression test suite</em></a> now
also checks for memory allocation leaks, using
<a class="reference internal" href="../library/sys.html#sys.getallocatedblocks" title="sys.getallocatedblocks"><tt class="xref py py-func docutils literal"><span class="pre">sys.getallocatedblocks()</span></tt></a>.  (Contributed by Antoine Pitrou in
<a class="reference external" href="https://bugs.python.org/issue13390">issue 13390</a>.)</li>
<li><tt class="docutils literal"><span class="pre">python</span> <span class="pre">-m</span></tt> now works with namespace packages.</li>
<li>The <a class="reference internal" href="../library/stat.html#module-stat" title="stat: Utilities for interpreting the results of os.stat(), os.lstat() and os.fstat()."><tt class="xref py py-mod docutils literal"><span class="pre">stat</span></tt></a> module is now implemented in C, which means it gets the
values for its constants from the C header files, instead of having the
values hard-coded in the python module as was previously the case.</li>
<li>Loading multiple python modules from a single OS module (<tt class="docutils literal"><span class="pre">.so</span></tt>, <tt class="docutils literal"><span class="pre">.dll</span></tt>)
now works correctly (previously it silently returned the first python
module in the file).  (Contributed by Václav Šmilauer in <a class="reference external" href="https://bugs.python.org/issue16421">issue 16421</a>.)</li>
<li>A new opcode, <a class="reference internal" href="../library/dis.html#opcode-LOAD_CLASSDEREF"><tt class="xref std std-opcode docutils literal"><span class="pre">LOAD_CLASSDEREF</span></tt></a>, has been added to fix a bug in the
loading of free variables in class bodies that could be triggered by certain
uses of <a class="reference internal" href="../reference/datamodel.html#prepare"><em>__prepare__</em></a>.  (Contributed by Benjamin Peterson in
<a class="reference external" href="https://bugs.python.org/issue17853">issue 17853</a>.)</li>
<li>A number of MemoryError-related crashes were identified and fixed by Victor
Stinner using his <span class="target" id="index-52"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0445"><strong>PEP 445</strong></a>-based <tt class="docutils literal"><span class="pre">pyfailmalloc</span></tt> tool (<a class="reference external" href="https://bugs.python.org/issue18408">issue 18408</a>,
<a class="reference external" href="https://bugs.python.org/issue18520">issue 18520</a>).</li>
<li>The <a class="reference internal" href="../using/scripts.html#scripts-pyvenv"><em>pyvenv</em></a> command now accepts a <tt class="docutils literal"><span class="pre">--copies</span></tt> option
to use copies rather than symlinks even on systems where symlinks are the
default.  (Contributed by Vinay Sajip in <a class="reference external" href="https://bugs.python.org/issue18807">issue 18807</a>.)</li>
<li>The <a class="reference internal" href="../using/scripts.html#scripts-pyvenv"><em>pyvenv</em></a> command also accepts a <tt class="docutils literal"><span class="pre">--without-pip</span></tt>
option to suppress the otherwise-automatic bootstrapping of pip into
the virtual environment.  (Contributed by Nick Coghlan in <a class="reference external" href="https://bugs.python.org/issue19552">issue 19552</a>
as part of the <span class="target" id="index-53"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0453"><strong>PEP 453</strong></a> implementation.)</li>
<li>The encoding name is now optional in the value set for the
<span class="target" id="index-54"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONIOENCODING"><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONIOENCODING</span></tt></a> environment variable.  This makes it possible to
set just the error handler, without changing the default encoding.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue18818">issue 18818</a>.)</li>
<li>The <a class="reference internal" href="../library/bz2.html#module-bz2" title="bz2: Interfaces for bzip2 compression and decompression."><tt class="xref py py-mod docutils literal"><span class="pre">bz2</span></tt></a>, <a class="reference internal" href="../library/lzma.html#module-lzma" title="lzma: A Python wrapper for the liblzma compression library."><tt class="xref py py-mod docutils literal"><span class="pre">lzma</span></tt></a>, and <a class="reference internal" href="../library/gzip.html#module-gzip" title="gzip: Interfaces for gzip compression and decompression using file objects."><tt class="xref py py-mod docutils literal"><span class="pre">gzip</span></tt></a> module <tt class="docutils literal"><span class="pre">open</span></tt> functions now
support <tt class="docutils literal"><span class="pre">x</span></tt> (exclusive creation) mode.  (Contributed by Tim Heaney and
Vajrasky Kok in <a class="reference external" href="https://bugs.python.org/issue19201">issue 19201</a>, <a class="reference external" href="https://bugs.python.org/issue19222">issue 19222</a>, and <a class="reference external" href="https://bugs.python.org/issue19223">issue 19223</a>.)</li>
</ul>
</div>
<div class="section" id="significant-optimizations">
<h3>Significant Optimizations<a class="headerlink" href="#significant-optimizations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The UTF-32 decoder is now 3x to 4x faster.  (Contributed by Serhiy Storchaka
in <a class="reference external" href="https://bugs.python.org/issue14625">issue 14625</a>.)</li>
<li>The cost of hash collisions for sets is now reduced.  Each hash table
probe now checks a series of consecutive, adjacent key/hash pairs before
continuing to make random probes through the hash table.  This exploits
cache locality to make collision resolution less expensive.
The collision resolution scheme can be described as a hybrid of linear
probing and open addressing.  The number of additional linear probes
defaults to nine.  This can be changed at compile-time by defining
LINEAR_PROBES to be any value.  Set LINEAR_PROBES=0 to turn-off
linear probing entirely.  (Contributed by Raymond Hettinger in
<a class="reference external" href="https://bugs.python.org/issue18771">issue 18771</a>.)</li>
<li>The interpreter starts about 30% faster. A couple of measures lead to the
speedup. The interpreter loads fewer modules on startup, e.g. the <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><tt class="xref py py-mod docutils literal"><span class="pre">re</span></tt></a>,
<a class="reference internal" href="../library/collections.html#module-collections" title="collections: Container datatypes"><tt class="xref py py-mod docutils literal"><span class="pre">collections</span></tt></a> and <a class="reference internal" href="../library/locale.html#module-locale" title="locale: Internationalization services."><tt class="xref py py-mod docutils literal"><span class="pre">locale</span></tt></a> modules and their dependencies are no
longer imported by default. The marshal module has been improved to load
compiled Python code faster.  (Contributed by Antoine Pitrou, Christian
Heimes and Victor Stinner in <a class="reference external" href="https://bugs.python.org/issue19219">issue 19219</a>, <a class="reference external" href="https://bugs.python.org/issue19218">issue 19218</a>, <a class="reference external" href="https://bugs.python.org/issue19209">issue 19209</a>,
<a class="reference external" href="https://bugs.python.org/issue19205">issue 19205</a> and <a class="reference external" href="https://bugs.python.org/issue9548">issue 9548</a>.)</li>
<li><a class="reference internal" href="../library/bz2.html#bz2.BZ2File" title="bz2.BZ2File"><tt class="xref py py-class docutils literal"><span class="pre">bz2.BZ2File</span></tt></a> is now as fast or faster than the Python2 version for
most cases.  <a class="reference internal" href="../library/lzma.html#lzma.LZMAFile" title="lzma.LZMAFile"><tt class="xref py py-class docutils literal"><span class="pre">lzma.LZMAFile</span></tt></a> has also been optimized.  (Contributed by
Serhiy Storchaka and Nadeem Vawda in <a class="reference external" href="https://bugs.python.org/issue16034">issue 16034</a>.)</li>
<li><a class="reference internal" href="../library/random.html#random.getrandbits" title="random.getrandbits"><tt class="xref py py-func docutils literal"><span class="pre">random.getrandbits()</span></tt></a> is 20%-40% faster for small integers (the most
common use case).  (Contributed by Serhiy Storchaka in <a class="reference external" href="https://bugs.python.org/issue16674">issue 16674</a>.)</li>
<li>By taking advantage of the new storage format for strings, pickling of
strings is now significantly faster.  (Contributed by Victor Stinner and
Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue15596">issue 15596</a>.)</li>
<li>A performance issue in <tt class="xref py py-meth docutils literal"><span class="pre">io.FileIO.readall()</span></tt> has been solved.  This
particularly affects Windows, and significantly speeds up the case of piping
significant amounts of data through <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><tt class="xref py py-mod docutils literal"><span class="pre">subprocess</span></tt></a>.  (Contributed
by Richard Oudkerk in <a class="reference external" href="https://bugs.python.org/issue15758">issue 15758</a>.)</li>
<li><a class="reference internal" href="../library/html.html#html.escape" title="html.escape"><tt class="xref py py-func docutils literal"><span class="pre">html.escape()</span></tt></a> is now 10x faster.  (Contributed by Matt Bryant in
<a class="reference external" href="https://bugs.python.org/issue18020">issue 18020</a>.)</li>
<li>On Windows, the native <tt class="docutils literal"><span class="pre">VirtualAlloc</span></tt> is now used instead of the CRT
<tt class="docutils literal"><span class="pre">malloc</span></tt> in <tt class="docutils literal"><span class="pre">obmalloc</span></tt>.  Artificial benchmarks show about a 3% memory
savings.</li>
<li><a class="reference internal" href="../library/os.html#os.urandom" title="os.urandom"><tt class="xref py py-func docutils literal"><span class="pre">os.urandom()</span></tt></a> now uses a lazily-opened persistent file descriptor
so as to avoid using many file descriptors when run in parallel from
multiple threads.  (Contributed by Antoine Pitrou in <a class="reference external" href="https://bugs.python.org/issue18756">issue 18756</a>.)</li>
</ul>
</div>
</div>
<div class="section" id="deprecated">
<span id="deprecated-3-4"></span><h2>Deprecated<a class="headerlink" href="#deprecated" title="Permalink to this headline">¶</a></h2>
<p>This section covers various APIs and other features that have been deprecated
in Python 3.4, and will be removed in Python 3.5 or later.  In most (but not
all) cases, using the deprecated APIs will produce a <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><tt class="xref py py-exc docutils literal"><span class="pre">DeprecationWarning</span></tt></a>
when the interpreter is run with deprecation warnings enabled (for example, by
using <tt class="docutils literal"><span class="pre">-Wd</span></tt>).</p>
<div class="section" id="deprecations-in-the-python-api">
<h3>Deprecations in the Python API<a class="headerlink" href="#deprecations-in-the-python-api" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>As mentioned in <a class="reference internal" href="#whatsnew-pep-451"><em>PEP 451: A ModuleSpec Type for the Import System</em></a>, a number of <tt class="xref py py-mod docutils literal"><span class="pre">importilb</span></tt>
methods and functions are deprecated: <a class="reference internal" href="../library/importlib.html#importlib.find_loader" title="importlib.find_loader"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.find_loader()</span></tt></a> is
replaced by <a class="reference internal" href="../library/importlib.html#importlib.util.find_spec" title="importlib.util.find_spec"><tt class="xref py py-func docutils literal"><span class="pre">importlib.util.find_spec()</span></tt></a>;
<a class="reference internal" href="../library/importlib.html#importlib.machinery.PathFinder.find_module" title="importlib.machinery.PathFinder.find_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.machinery.PathFinder.find_module()</span></tt></a> is replaced by
<a class="reference internal" href="../library/importlib.html#importlib.machinery.PathFinder.find_spec" title="importlib.machinery.PathFinder.find_spec"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.machinery.PathFinder.find_spec()</span></tt></a>;
<a class="reference internal" href="../library/importlib.html#importlib.abc.MetaPathFinder.find_module" title="importlib.abc.MetaPathFinder.find_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.MetaPathFinder.find_module()</span></tt></a> is replaced by
<a class="reference internal" href="../library/importlib.html#importlib.abc.MetaPathFinder.find_spec" title="importlib.abc.MetaPathFinder.find_spec"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.MetaPathFinder.find_spec()</span></tt></a>;
<a class="reference internal" href="../library/importlib.html#importlib.abc.PathEntryFinder.find_loader" title="importlib.abc.PathEntryFinder.find_loader"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.PathEntryFinder.find_loader()</span></tt></a> and
<a class="reference internal" href="../library/importlib.html#importlib.abc.PathEntryFinder.find_module" title="importlib.abc.PathEntryFinder.find_module"><tt class="xref py py-meth docutils literal"><span class="pre">find_module()</span></tt></a> are replaced by
<a class="reference internal" href="../library/importlib.html#importlib.abc.PathEntryFinder.find_spec" title="importlib.abc.PathEntryFinder.find_spec"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.PathEntryFinder.find_spec()</span></tt></a>; all of the <tt class="docutils literal"><span class="pre">xxxLoader</span></tt> ABC
<tt class="docutils literal"><span class="pre">load_module</span></tt> methods (<a class="reference internal" href="../library/importlib.html#importlib.abc.Loader.load_module" title="importlib.abc.Loader.load_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.Loader.load_module()</span></tt></a>,
<a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader.load_module" title="importlib.abc.InspectLoader.load_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.InspectLoader.load_module()</span></tt></a>,
<a class="reference internal" href="../library/importlib.html#importlib.abc.FileLoader.load_module" title="importlib.abc.FileLoader.load_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.FileLoader.load_module()</span></tt></a>,
<a class="reference internal" href="../library/importlib.html#importlib.abc.SourceLoader.load_module" title="importlib.abc.SourceLoader.load_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.SourceLoader.load_module()</span></tt></a>) should no longer be
implemented, instead loaders should implement an
<tt class="docutils literal"><span class="pre">exec_module</span></tt> method
(<a class="reference internal" href="../library/importlib.html#importlib.abc.Loader.exec_module" title="importlib.abc.Loader.exec_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.Loader.exec_module()</span></tt></a>,
<a class="reference internal" href="../library/importlib.html#importlib.abc.InspectLoader.exec_module" title="importlib.abc.InspectLoader.exec_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.InspectLoader.exec_module()</span></tt></a>
<a class="reference internal" href="../library/importlib.html#importlib.abc.SourceLoader.exec_module" title="importlib.abc.SourceLoader.exec_module"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.SourceLoader.exec_module()</span></tt></a>) and let the import system
take care of the rest; and
<a class="reference internal" href="../library/importlib.html#importlib.abc.Loader.module_repr" title="importlib.abc.Loader.module_repr"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.Loader.module_repr()</span></tt></a>,
<a class="reference internal" href="../library/importlib.html#importlib.util.module_for_loader" title="importlib.util.module_for_loader"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.util.module_for_loader()</span></tt></a>, <a class="reference internal" href="../library/importlib.html#importlib.util.set_loader" title="importlib.util.set_loader"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.util.set_loader()</span></tt></a>,
and <a class="reference internal" href="../library/importlib.html#importlib.util.set_package" title="importlib.util.set_package"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.util.set_package()</span></tt></a> are no longer needed because their
functions are now handled automatically by the import system.</li>
<li>The <a class="reference internal" href="../library/imp.html#module-imp" title="imp: Access the implementation of the import statement. (deprecated)"><tt class="xref py py-mod docutils literal"><span class="pre">imp</span></tt></a> module is pending deprecation. To keep compatibility with
Python 2/3 code bases, the module&#8217;s removal is currently not scheduled.</li>
<li>The <a class="reference internal" href="../library/formatter.html#module-formatter" title="formatter: Generic output formatter and device interface. (deprecated)"><tt class="xref py py-mod docutils literal"><span class="pre">formatter</span></tt></a> module is pending deprecation and is slated for removal
in Python 3.6.</li>
<li><tt class="docutils literal"><span class="pre">MD5</span></tt> as the default <em>digestmod</em> for the <a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><tt class="xref py py-func docutils literal"><span class="pre">hmac.new()</span></tt></a> function is
deprecated.  Python 3.6 will require an explicit digest name or constructor as
<em>digestmod</em> argument.</li>
<li>The internal <tt class="docutils literal"><span class="pre">Netrc</span></tt> class in the <a class="reference internal" href="../library/ftplib.html#module-ftplib" title="ftplib: FTP protocol client (requires sockets)."><tt class="xref py py-mod docutils literal"><span class="pre">ftplib</span></tt></a> module has been documented
as deprecated in its docstring for quite some time.  It now emits a
<a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><tt class="xref py py-exc docutils literal"><span class="pre">DeprecationWarning</span></tt></a> and will be removed completely in Python 3.5.</li>
<li>The undocumented <em>endtime</em> argument to <a class="reference internal" href="../library/subprocess.html#subprocess.Popen.wait" title="subprocess.Popen.wait"><tt class="xref py py-meth docutils literal"><span class="pre">subprocess.Popen.wait()</span></tt></a> should
not have been exposed and is hopefully not in use; it is deprecated and
will mostly likely be removed in Python 3.5.</li>
<li>The <em>strict</em> argument of <a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><tt class="xref py py-class docutils literal"><span class="pre">HTMLParser</span></tt></a> is deprecated.</li>
<li>The <a class="reference internal" href="../library/plistlib.html#module-plistlib" title="plistlib: Generate and parse Mac OS X plist files."><tt class="xref py py-mod docutils literal"><span class="pre">plistlib</span></tt></a> <a class="reference internal" href="../library/plistlib.html#plistlib.readPlist" title="plistlib.readPlist"><tt class="xref py py-func docutils literal"><span class="pre">readPlist()</span></tt></a>,
<a class="reference internal" href="../library/plistlib.html#plistlib.writePlist" title="plistlib.writePlist"><tt class="xref py py-func docutils literal"><span class="pre">writePlist()</span></tt></a>, <a class="reference internal" href="../library/plistlib.html#plistlib.readPlistFromBytes" title="plistlib.readPlistFromBytes"><tt class="xref py py-func docutils literal"><span class="pre">readPlistFromBytes()</span></tt></a>, and
<a class="reference internal" href="../library/plistlib.html#plistlib.writePlistToBytes" title="plistlib.writePlistToBytes"><tt class="xref py py-func docutils literal"><span class="pre">writePlistToBytes()</span></tt></a> functions are deprecated in favor of the
corresponding new functions <a class="reference internal" href="../library/plistlib.html#plistlib.load" title="plistlib.load"><tt class="xref py py-func docutils literal"><span class="pre">load()</span></tt></a>, <a class="reference internal" href="../library/plistlib.html#plistlib.dump" title="plistlib.dump"><tt class="xref py py-func docutils literal"><span class="pre">dump()</span></tt></a>,
<a class="reference internal" href="../library/plistlib.html#plistlib.loads" title="plistlib.loads"><tt class="xref py py-func docutils literal"><span class="pre">loads()</span></tt></a>, and <a class="reference internal" href="../library/plistlib.html#plistlib.dumps" title="plistlib.dumps"><tt class="xref py py-func docutils literal"><span class="pre">dumps()</span></tt></a>.  <a class="reference internal" href="../library/plistlib.html#plistlib.Data" title="plistlib.Data"><tt class="xref py py-func docutils literal"><span class="pre">Data()</span></tt></a>
is deprecated in favor of just using the <a class="reference internal" href="../library/functions.html#bytes" title="bytes"><tt class="xref py py-class docutils literal"><span class="pre">bytes</span></tt></a> constructor.</li>
<li>The <a class="reference internal" href="../library/sysconfig.html#module-sysconfig" title="sysconfig: Python's configuration information"><tt class="xref py py-mod docutils literal"><span class="pre">sysconfig</span></tt></a> key <tt class="docutils literal"><span class="pre">SO</span></tt> is deprecated, it has been replaced by
<tt class="docutils literal"><span class="pre">EXT_SUFFIX</span></tt>.</li>
<li>The <tt class="docutils literal"><span class="pre">U</span></tt> mode accepted by various <tt class="docutils literal"><span class="pre">open</span></tt> functions is deprecated.
In Python3 it does not do anything useful, and should be replaced by
appropriate uses of <a class="reference internal" href="../library/io.html#io.TextIOWrapper" title="io.TextIOWrapper"><tt class="xref py py-class docutils literal"><span class="pre">io.TextIOWrapper</span></tt></a> (if needed) and its <em>newline</em>
argument.</li>
<li>The <em>parser</em> argument of <a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.iterparse" title="xml.etree.ElementTree.iterparse"><tt class="xref py py-func docutils literal"><span class="pre">xml.etree.ElementTree.iterparse()</span></tt></a> has
been deprecated, as has the <em>html</em> argument of
<a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.XMLParser" title="xml.etree.ElementTree.XMLParser"><tt class="xref py py-func docutils literal"><span class="pre">XMLParser()</span></tt></a>.  To prepare for the removal of the
latter, all arguments to <tt class="docutils literal"><span class="pre">XMLParser</span></tt> should be passed by keyword.</li>
</ul>
</div>
<div class="section" id="deprecated-features">
<h3>Deprecated Features<a class="headerlink" href="#deprecated-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Running <a class="reference internal" href="../library/idle.html#idle"><em>IDLE</em></a> with the <tt class="docutils literal"><span class="pre">-n</span></tt> flag (no subprocess) is deprecated.
However, the feature will not be removed until <a class="reference external" href="https://bugs.python.org/issue18823">issue 18823</a> is resolved.</li>
<li>The site module adding a &#8220;site-python&#8221; directory to sys.path, if it
exists, is deprecated (<a class="reference external" href="https://bugs.python.org/issue19375">issue 19375</a>).</li>
</ul>
</div>
</div>
<div class="section" id="removed">
<h2>Removed<a class="headerlink" href="#removed" title="Permalink to this headline">¶</a></h2>
<div class="section" id="operating-systems-no-longer-supported">
<h3>Operating Systems No Longer Supported<a class="headerlink" href="#operating-systems-no-longer-supported" title="Permalink to this headline">¶</a></h3>
<p>Support for the following operating systems has been removed from the source
and build tools:</p>
<ul class="simple">
<li>OS/2 (<a class="reference external" href="https://bugs.python.org/issue16135">issue 16135</a>).</li>
<li>Windows 2000 (changeset e52df05b496a).</li>
<li>Windows systems where <tt class="docutils literal"><span class="pre">COMSPEC</span></tt> points to <tt class="docutils literal"><span class="pre">command.com</span></tt> (<a class="reference external" href="https://bugs.python.org/issue14470">issue 14470</a>).</li>
<li>VMS (<a class="reference external" href="https://bugs.python.org/issue16136">issue 16136</a>).</li>
</ul>
</div>
<div class="section" id="api-and-feature-removals">
<h3>API and Feature Removals<a class="headerlink" href="#api-and-feature-removals" title="Permalink to this headline">¶</a></h3>
<p>The following obsolete and previously deprecated APIs and features have been
removed:</p>
<ul class="simple">
<li>The unmaintained <tt class="docutils literal"><span class="pre">Misc/TextMate</span></tt> and <tt class="docutils literal"><span class="pre">Misc/vim</span></tt> directories have been
removed (see the <a class="reference external" href="https://docs.python.org/devguide">devguide</a>
for suggestions on what to use instead).</li>
<li>The <tt class="docutils literal"><span class="pre">SO</span></tt> makefile macro is removed (it was replaced by the
<tt class="docutils literal"><span class="pre">SHLIB_SUFFIX</span></tt> and <tt class="docutils literal"><span class="pre">EXT_SUFFIX</span></tt> macros) (<a class="reference external" href="https://bugs.python.org/issue16754">issue 16754</a>).</li>
<li>The <tt class="docutils literal"><span class="pre">PyThreadState.tick_counter</span></tt> field has been removed; its value has
been meaningless since Python 3.2, when the &#8220;new GIL&#8221; was introduced
(<a class="reference external" href="https://bugs.python.org/issue19199">issue 19199</a>).</li>
<li><tt class="docutils literal"><span class="pre">PyLoader</span></tt> and <tt class="docutils literal"><span class="pre">PyPycLoader</span></tt> have been removed from <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><tt class="xref py py-mod docutils literal"><span class="pre">importlib</span></tt></a>.
(Contributed by Taras Lyapun in <a class="reference external" href="https://bugs.python.org/issue15641">issue 15641</a>.)</li>
<li>The <em>strict</em> argument to <a class="reference internal" href="../library/http.client.html#http.client.HTTPConnection" title="http.client.HTTPConnection"><tt class="xref py py-class docutils literal"><span class="pre">HTTPConnection</span></tt></a> and
<a class="reference internal" href="../library/http.client.html#http.client.HTTPSConnection" title="http.client.HTTPSConnection"><tt class="xref py py-class docutils literal"><span class="pre">HTTPSConnection</span></tt></a> has been removed.  HTTP 0.9-style
&#8220;Simple Responses&#8221; are no longer supported.</li>
<li>The deprecated <a class="reference internal" href="../library/urllib.request.html#urllib.request.Request" title="urllib.request.Request"><tt class="xref py py-mod docutils literal"><span class="pre">urllib.request.Request</span></tt></a> getter and setter methods
<tt class="docutils literal"><span class="pre">add_data</span></tt>, <tt class="docutils literal"><span class="pre">has_data</span></tt>, <tt class="docutils literal"><span class="pre">get_data</span></tt>, <tt class="docutils literal"><span class="pre">get_type</span></tt>, <tt class="docutils literal"><span class="pre">get_host</span></tt>,
<tt class="docutils literal"><span class="pre">get_selector</span></tt>, <tt class="docutils literal"><span class="pre">set_proxy</span></tt>, <tt class="docutils literal"><span class="pre">get_origin_req_host</span></tt>, and
<tt class="docutils literal"><span class="pre">is_unverifiable</span></tt> have been removed (use direct attribute access instead).</li>
<li>Support for loading the deprecated <tt class="docutils literal"><span class="pre">TYPE_INT64</span></tt> has been removed from
<a class="reference internal" href="../library/marshal.html#module-marshal" title="marshal: Convert Python objects to streams of bytes and back (with different constraints)."><tt class="xref py py-mod docutils literal"><span class="pre">marshal</span></tt></a>.  (Contributed by Dan Riti in <a class="reference external" href="https://bugs.python.org/issue15480">issue 15480</a>.)</li>
<li><a class="reference internal" href="../library/inspect.html#inspect.Signature" title="inspect.Signature"><tt class="xref py py-class docutils literal"><span class="pre">inspect.Signature</span></tt></a>: positional-only parameters are now required
to have a valid name.</li>
<li><a class="reference internal" href="../reference/datamodel.html#object.__format__" title="object.__format__"><tt class="xref py py-meth docutils literal"><span class="pre">object.__format__()</span></tt></a> no longer accepts non-empty format strings, it now
raises a <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a> instead.  Using a non-empty string has been
deprecated since Python 3.2.  This change has been made to prevent a
situation where previously working (but incorrect) code would start failing
if an object gained a __format__ method, which means that your code may now
raise a <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a> if you are using an <tt class="docutils literal"><span class="pre">'s'</span></tt> format code with objects
that do not have a __format__ method that handles it.  See <a class="reference external" href="https://bugs.python.org/issue7994">issue 7994</a> for
background.</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">difflib.SequenceMatcher.isbjunk()</span></tt> and
<tt class="xref py py-meth docutils literal"><span class="pre">difflib.SequenceMatcher.isbpopular()</span></tt> were deprecated in 3.2, and have
now been removed: use <tt class="docutils literal"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">sm.bjunk</span></tt> and
<tt class="docutils literal"><span class="pre">x</span> <span class="pre">in</span> <span class="pre">sm.bpopular</span></tt>, where <em>sm</em> is a <a class="reference internal" href="../library/difflib.html#difflib.SequenceMatcher" title="difflib.SequenceMatcher"><tt class="xref py py-class docutils literal"><span class="pre">SequenceMatcher</span></tt></a> object
(<a class="reference external" href="https://bugs.python.org/issue13248">issue 13248</a>).</li>
</ul>
</div>
<div class="section" id="code-cleanups">
<h3>Code Cleanups<a class="headerlink" href="#code-cleanups" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The unused and undocumented internal <tt class="docutils literal"><span class="pre">Scanner</span></tt> class has been removed from
the <a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><tt class="xref py py-mod docutils literal"><span class="pre">pydoc</span></tt></a> module.</li>
<li>The private and effectively unused <tt class="docutils literal"><span class="pre">_gestalt</span></tt> module has been removed,
along with the private <a class="reference internal" href="../library/platform.html#module-platform" title="platform: Retrieves as much platform identifying data as possible."><tt class="xref py py-mod docutils literal"><span class="pre">platform</span></tt></a> functions <tt class="docutils literal"><span class="pre">_mac_ver_lookup</span></tt>,
<tt class="docutils literal"><span class="pre">_mac_ver_gstalt</span></tt>, and <tt class="docutils literal"><span class="pre">_bcd2str</span></tt>, which would only have ever been called
on badly broken OSX systems (see <a class="reference external" href="https://bugs.python.org/issue18393">issue 18393</a>).</li>
<li>The hardcoded copies of certain <a class="reference internal" href="../library/stat.html#module-stat" title="stat: Utilities for interpreting the results of os.stat(), os.lstat() and os.fstat()."><tt class="xref py py-mod docutils literal"><span class="pre">stat</span></tt></a> constants that were included in
the <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><tt class="xref py py-mod docutils literal"><span class="pre">tarfile</span></tt></a> module namespace have been removed.</li>
</ul>
</div>
</div>
<div class="section" id="porting-to-python-3-4">
<h2>Porting to Python 3.4<a class="headerlink" href="#porting-to-python-3-4" title="Permalink to this headline">¶</a></h2>
<p>This section lists previously described changes and other bugfixes
that may require changes to your code.</p>
<div class="section" id="changes-in-python-command-behavior">
<h3>Changes in &#8216;python&#8217; Command Behavior<a class="headerlink" href="#changes-in-python-command-behavior" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In a posix shell, setting the <span class="target" id="index-55"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PATH</span></tt> environment variable to
an empty value is equivalent to not setting it at all.  However, setting
<span class="target" id="index-56"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONPATH"><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONPATH</span></tt></a> to an empty value was <em>not</em> equivalent to not setting it
at all: setting <span class="target" id="index-57"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONPATH"><tt class="xref std std-envvar docutils literal"><span class="pre">PYTHONPATH</span></tt></a> to an empty value was equivalent to
setting it to <tt class="docutils literal"><span class="pre">.</span></tt>, which leads to confusion when reasoning by analogy to
how <span class="target" id="index-58"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PATH</span></tt> works.  The behavior now conforms to the posix convention
for <span class="target" id="index-59"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PATH</span></tt>.</li>
<li>The [X refs, Y blocks] output of a debug (<tt class="docutils literal"><span class="pre">--with-pydebug</span></tt>) build of the
CPython interpreter is now off by default.  It can be re-enabled using the
<tt class="docutils literal"><span class="pre">-X</span> <span class="pre">showrefcount</span></tt> option.  (Contributed by Ezio Melotti in <a class="reference external" href="https://bugs.python.org/issue17323">issue 17323</a>.)</li>
<li>The python command and most stdlib scripts (as well as <a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a>) now
output <tt class="docutils literal"><span class="pre">--version</span></tt> information to <tt class="docutils literal"><span class="pre">stdout</span></tt> instead of <tt class="docutils literal"><span class="pre">stderr</span></tt> (for
issue list see <a class="reference internal" href="#other-improvements-3-4"><em>Other Improvements</em></a> above).</li>
</ul>
</div>
<div class="section" id="changes-in-the-python-api">
<h3>Changes in the Python API<a class="headerlink" href="#changes-in-the-python-api" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The ABCs defined in <a class="reference internal" href="../library/importlib.html#module-importlib.abc" title="importlib.abc: Abstract base classes related to import"><tt class="xref py py-mod docutils literal"><span class="pre">importlib.abc</span></tt></a> now either raise the appropriate
exception or return a default value instead of raising
<a class="reference internal" href="../library/exceptions.html#NotImplementedError" title="NotImplementedError"><tt class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></tt></a> blindly. This will only affect code calling
<a class="reference internal" href="../library/functions.html#super" title="super"><tt class="xref py py-func docutils literal"><span class="pre">super()</span></tt></a> and falling through all the way to the ABCs. For compatibility,
catch both <a class="reference internal" href="../library/exceptions.html#NotImplementedError" title="NotImplementedError"><tt class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></tt></a> or the appropriate exception as needed.</li>
<li>The module type now initializes the <a class="reference internal" href="../reference/import.html#__package__" title="__package__"><tt class="xref py py-attr docutils literal"><span class="pre">__package__</span></tt></a> and <a class="reference internal" href="../reference/import.html#__loader__" title="__loader__"><tt class="xref py py-attr docutils literal"><span class="pre">__loader__</span></tt></a>
attributes to <tt class="docutils literal"><span class="pre">None</span></tt> by default. To determine if these attributes were set
in a backwards-compatible fashion, use e.g.
<tt class="docutils literal"><span class="pre">getattr(module,</span> <span class="pre">'__loader__',</span> <span class="pre">None)</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></tt>.  (<a class="reference external" href="https://bugs.python.org/issue17115">issue 17115</a>.)</li>
<li><a class="reference internal" href="../library/importlib.html#importlib.util.module_for_loader" title="importlib.util.module_for_loader"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.util.module_for_loader()</span></tt></a> now sets <tt class="docutils literal"><span class="pre">__loader__</span></tt> and
<tt class="docutils literal"><span class="pre">__package__</span></tt> unconditionally to properly support reloading. If this is not
desired then you will need to set these attributes manually. You can use
<tt class="xref py py-func docutils literal"><span class="pre">importlib.util.module_to_load()</span></tt> for module management.</li>
<li>Import now resets relevant attributes (e.g. <tt class="docutils literal"><span class="pre">__name__</span></tt>, <tt class="docutils literal"><span class="pre">__loader__</span></tt>,
<tt class="docutils literal"><span class="pre">__package__</span></tt>, <tt class="docutils literal"><span class="pre">__file__</span></tt>, <tt class="docutils literal"><span class="pre">__cached__</span></tt>) unconditionally when reloading.
Note that this restores a pre-3.3 behavior in that it means a module is
re-found when re-loaded (<a class="reference external" href="https://bugs.python.org/issue19413">issue 19413</a>).</li>
<li>Frozen packages no longer set <tt class="docutils literal"><span class="pre">__path__</span></tt> to a list containing the package
name, they now set it to an empty list.  The previous behavior could cause
the import system to do the wrong thing on submodule imports if there was
also a directory with the same name as the frozen package.  The correct way
to determine if a module is a package or not is to use <tt class="docutils literal"><span class="pre">hasattr(module,</span>
<span class="pre">'__path__')</span></tt> (<a class="reference external" href="https://bugs.python.org/issue18065">issue 18065</a>).</li>
<li>Frozen modules no longer define a <tt class="docutils literal"><span class="pre">__file__</span></tt> attribute. It&#8217;s semantically
incorrect for frozen modules to set the attribute as they are not loaded from
any explicit location. If you must know that a module comes from frozen code
then you can see if the module&#8217;s <tt class="docutils literal"><span class="pre">__spec__.location</span></tt> is set to <tt class="docutils literal"><span class="pre">'frozen'</span></tt>,
check if the loader is a subclass of
<a class="reference internal" href="../library/importlib.html#importlib.machinery.FrozenImporter" title="importlib.machinery.FrozenImporter"><tt class="xref py py-class docutils literal"><span class="pre">importlib.machinery.FrozenImporter</span></tt></a>,
or if Python 2 compatibility is necessary you can use <tt class="xref py py-func docutils literal"><span class="pre">imp.is_frozen()</span></tt>.</li>
<li><a class="reference internal" href="../library/py_compile.html#py_compile.compile" title="py_compile.compile"><tt class="xref py py-func docutils literal"><span class="pre">py_compile.compile()</span></tt></a> now raises <a class="reference internal" href="../library/exceptions.html#FileExistsError" title="FileExistsError"><tt class="xref py py-exc docutils literal"><span class="pre">FileExistsError</span></tt></a> if the file path
it would write to is a symlink or a non-regular file. This is to act as a
warning that import will overwrite those files with a regular file regardless
of what type of file path they were originally.</li>
<li><a class="reference internal" href="../library/importlib.html#importlib.abc.SourceLoader.get_source" title="importlib.abc.SourceLoader.get_source"><tt class="xref py py-meth docutils literal"><span class="pre">importlib.abc.SourceLoader.get_source()</span></tt></a> no longer raises
<a class="reference internal" href="../library/exceptions.html#ImportError" title="ImportError"><tt class="xref py py-exc docutils literal"><span class="pre">ImportError</span></tt></a> when the source code being loaded triggers a
<a class="reference internal" href="../library/exceptions.html#SyntaxError" title="SyntaxError"><tt class="xref py py-exc docutils literal"><span class="pre">SyntaxError</span></tt></a> or <a class="reference internal" href="../library/exceptions.html#UnicodeDecodeError" title="UnicodeDecodeError"><tt class="xref py py-exc docutils literal"><span class="pre">UnicodeDecodeError</span></tt></a>. As <a class="reference internal" href="../library/exceptions.html#ImportError" title="ImportError"><tt class="xref py py-exc docutils literal"><span class="pre">ImportError</span></tt></a> is
meant to be raised only when source code cannot be found but it should, it was
felt to be over-reaching/overloading of that meaning when the source code is
found but improperly structured. If you were catching ImportError before and
wish to continue to ignore syntax or decoding issues, catch all three
exceptions now.</li>
<li><a class="reference internal" href="../library/functools.html#functools.update_wrapper" title="functools.update_wrapper"><tt class="xref py py-func docutils literal"><span class="pre">functools.update_wrapper()</span></tt></a> and <a class="reference internal" href="../library/functools.html#functools.wraps" title="functools.wraps"><tt class="xref py py-func docutils literal"><span class="pre">functools.wraps()</span></tt></a> now correctly
set the <tt class="docutils literal"><span class="pre">__wrapped__</span></tt> attribute to the function being wrapped, even if
that function also had its <tt class="docutils literal"><span class="pre">__wrapped__</span></tt> attribute set. This means
<tt class="docutils literal"><span class="pre">__wrapped__</span></tt> attributes now correctly link a stack of decorated
functions rather than every <tt class="docutils literal"><span class="pre">__wrapped__</span></tt> attribute in the chain
referring to the innermost function. Introspection libraries that
assumed the previous behaviour was intentional can use
<a class="reference internal" href="../library/inspect.html#inspect.unwrap" title="inspect.unwrap"><tt class="xref py py-func docutils literal"><span class="pre">inspect.unwrap()</span></tt></a> to access the first function in the chain that has
no <tt class="docutils literal"><span class="pre">__wrapped__</span></tt> attribute.</li>
<li><a class="reference internal" href="../library/inspect.html#inspect.getfullargspec" title="inspect.getfullargspec"><tt class="xref py py-func docutils literal"><span class="pre">inspect.getfullargspec()</span></tt></a> has been reimplemented on top of
<a class="reference internal" href="../library/inspect.html#inspect.signature" title="inspect.signature"><tt class="xref py py-func docutils literal"><span class="pre">inspect.signature()</span></tt></a> and hence handles a much wider variety of callable
objects than it did in the past. It is expected that additional builtin and
extension module callables will gain signature metadata over the course of
the Python 3.4 series. Code that assumes that
<a class="reference internal" href="../library/inspect.html#inspect.getfullargspec" title="inspect.getfullargspec"><tt class="xref py py-func docutils literal"><span class="pre">inspect.getfullargspec()</span></tt></a> will fail on non-Python callables may need
to be adjusted accordingly.</li>
<li><a class="reference internal" href="../library/importlib.html#importlib.machinery.PathFinder" title="importlib.machinery.PathFinder"><tt class="xref py py-class docutils literal"><span class="pre">importlib.machinery.PathFinder</span></tt></a> now passes on the current working
directory to objects in <a class="reference internal" href="../library/sys.html#sys.path_hooks" title="sys.path_hooks"><tt class="xref py py-data docutils literal"><span class="pre">sys.path_hooks</span></tt></a> for the empty string. This
results in <a class="reference internal" href="../library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache"><tt class="xref py py-data docutils literal"><span class="pre">sys.path_importer_cache</span></tt></a> never containing <tt class="docutils literal"><span class="pre">''</span></tt>, thus
iterating through <a class="reference internal" href="../library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache"><tt class="xref py py-data docutils literal"><span class="pre">sys.path_importer_cache</span></tt></a> based on <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><tt class="xref py py-data docutils literal"><span class="pre">sys.path</span></tt></a>
will not find all keys. A module&#8217;s <tt class="docutils literal"><span class="pre">__file__</span></tt> when imported in the current
working directory will also now have an absolute path, including when using
<tt class="docutils literal"><span class="pre">-m</span></tt> with the interpreter (except for <tt class="docutils literal"><span class="pre">__main__.__file__</span></tt> when a script
has been executed directly using a relative path) (Contributed by Brett
Cannon in <a class="reference external" href="https://bugs.python.org/issue18416">issue 18416</a>).  is specified on the command-line)
(<a class="reference external" href="https://bugs.python.org/issue18416">issue 18416</a>).</li>
<li>The removal of the <em>strict</em> argument to <a class="reference internal" href="../library/http.client.html#http.client.HTTPConnection" title="http.client.HTTPConnection"><tt class="xref py py-class docutils literal"><span class="pre">HTTPConnection</span></tt></a>
and <a class="reference internal" href="../library/http.client.html#http.client.HTTPSConnection" title="http.client.HTTPSConnection"><tt class="xref py py-class docutils literal"><span class="pre">HTTPSConnection</span></tt></a> changes the meaning of the
remaining arguments if you are specifying them positionally rather than by
keyword.  If you&#8217;ve been paying attention to deprecation warnings your code
should already be specifying any additional arguments via keywords.</li>
<li>Strings between <tt class="docutils literal"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">...</span></tt> statements now <em>always</em> raise
a <a class="reference internal" href="../library/exceptions.html#SyntaxError" title="SyntaxError"><tt class="xref py py-exc docutils literal"><span class="pre">SyntaxError</span></tt></a>.  Previously if there was no leading docstring, an
interstitial string would sometimes be ignored.  This brings CPython into
compliance with the language spec; Jython and PyPy already were.
(<a class="reference external" href="https://bugs.python.org/issue17434">issue 17434</a>).</li>
<li><a class="reference internal" href="../library/ssl.html#ssl.SSLSocket.getpeercert" title="ssl.SSLSocket.getpeercert"><tt class="xref py py-meth docutils literal"><span class="pre">ssl.SSLSocket.getpeercert()</span></tt></a> and <a class="reference internal" href="../library/ssl.html#ssl.SSLSocket.do_handshake" title="ssl.SSLSocket.do_handshake"><tt class="xref py py-meth docutils literal"><span class="pre">ssl.SSLSocket.do_handshake()</span></tt></a>
now raise an <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><tt class="xref py py-exc docutils literal"><span class="pre">OSError</span></tt></a> with <tt class="docutils literal"><span class="pre">ENOTCONN</span></tt> when the <tt class="docutils literal"><span class="pre">SSLSocket</span></tt> is not
connected, instead of the previous behavior of raising an
<a class="reference internal" href="../library/exceptions.html#AttributeError" title="AttributeError"><tt class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></tt></a>.  In addition, <a class="reference internal" href="../library/ssl.html#ssl.SSLSocket.getpeercert" title="ssl.SSLSocket.getpeercert"><tt class="xref py py-meth docutils literal"><span class="pre">getpeercert()</span></tt></a>
will raise a <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><tt class="xref py py-exc docutils literal"><span class="pre">ValueError</span></tt></a> if the handshake has not yet been done.</li>
<li><a class="reference internal" href="../library/base64.html#base64.b32decode" title="base64.b32decode"><tt class="xref py py-func docutils literal"><span class="pre">base64.b32decode()</span></tt></a> now raises a <a class="reference internal" href="../library/binascii.html#binascii.Error" title="binascii.Error"><tt class="xref py py-exc docutils literal"><span class="pre">binascii.Error</span></tt></a> when the
input string contains non-b32-alphabet characters, instead of a
<a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a>.  This particular <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a> was missed when the other
<a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a>s were converted.  (Contributed by Serhiy Storchaka in
<a class="reference external" href="https://bugs.python.org/issue18011">issue 18011</a>.)  Note: this change was also inadvertently applied in Python
3.3.3.</li>
<li>The <tt class="xref py py-attr docutils literal"><span class="pre">file</span></tt> attribute is now automatically closed when
the creating <tt class="xref py py-class docutils literal"><span class="pre">cgi.FieldStorage</span></tt> instance is garbage collected. If you
were pulling the file object out separately from the <tt class="xref py py-class docutils literal"><span class="pre">cgi.FieldStorage</span></tt>
instance and not keeping the instance alive, then you should either store the
entire <tt class="xref py py-class docutils literal"><span class="pre">cgi.FieldStorage</span></tt> instance or read the contents of the file
before the <tt class="xref py py-class docutils literal"><span class="pre">cgi.FieldStorage</span></tt> instance is garbage collected.</li>
<li>Calling <tt class="docutils literal"><span class="pre">read</span></tt> or <tt class="docutils literal"><span class="pre">write</span></tt> on a closed SSL socket now raises an
informative <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><tt class="xref py py-exc docutils literal"><span class="pre">ValueError</span></tt></a> rather than the previous more mysterious
<a class="reference internal" href="../library/exceptions.html#AttributeError" title="AttributeError"><tt class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></tt></a> (<a class="reference external" href="https://bugs.python.org/issue9177">issue 9177</a>).</li>
<li><a class="reference internal" href="../reference/datamodel.html#slice.indices" title="slice.indices"><tt class="xref py py-meth docutils literal"><span class="pre">slice.indices()</span></tt></a> no longer produces an <a class="reference internal" href="../library/exceptions.html#OverflowError" title="OverflowError"><tt class="xref py py-exc docutils literal"><span class="pre">OverflowError</span></tt></a> for huge
values.  As a consequence of this fix, <a class="reference internal" href="../reference/datamodel.html#slice.indices" title="slice.indices"><tt class="xref py py-meth docutils literal"><span class="pre">slice.indices()</span></tt></a> now raises a
<a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><tt class="xref py py-exc docutils literal"><span class="pre">ValueError</span></tt></a> if given a negative length; previously it returned nonsense
values (<a class="reference external" href="https://bugs.python.org/issue14794">issue 14794</a>).</li>
<li>The <a class="reference internal" href="../library/functions.html#complex" title="complex"><tt class="xref py py-class docutils literal"><span class="pre">complex</span></tt></a> constructor, unlike the <a class="reference internal" href="../library/cmath.html#module-cmath" title="cmath: Mathematical functions for complex numbers."><tt class="xref py py-mod docutils literal"><span class="pre">cmath</span></tt></a> functions, was
incorrectly accepting <a class="reference internal" href="../library/functions.html#float" title="float"><tt class="xref py py-class docutils literal"><span class="pre">float</span></tt></a> values if an object&#8217;s <tt class="docutils literal"><span class="pre">__complex__</span></tt>
special method returned one.  This now raises a <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a>.
(<a class="reference external" href="https://bugs.python.org/issue16290">issue 16290</a>.)</li>
<li>The <a class="reference internal" href="../library/functions.html#int" title="int"><tt class="xref py py-class docutils literal"><span class="pre">int</span></tt></a> constructor in 3.2 and 3.3 erroneously accepts <a class="reference internal" href="../library/functions.html#float" title="float"><tt class="xref py py-class docutils literal"><span class="pre">float</span></tt></a>
values for the <em>base</em> parameter.  It is unlikely anyone was doing this, but
if so, it will now raise a <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a> (<a class="reference external" href="https://bugs.python.org/issue16772">issue 16772</a>).</li>
<li>Defaults for keyword-only arguments are now evaluated <em>after</em> defaults for
regular keyword arguments, instead of before.  Hopefully no one wrote any
code that depends on the previous buggy behavior (<a class="reference external" href="https://bugs.python.org/issue16967">issue 16967</a>).</li>
<li>Stale thread states are now cleared after <a class="reference internal" href="../library/os.html#os.fork" title="os.fork"><tt class="xref py py-func docutils literal"><span class="pre">fork()</span></tt></a>.  This may cause
some system resources to be released that previously were incorrectly kept
perpetually alive (for example, database connections kept in thread-local
storage).  (<a class="reference external" href="https://bugs.python.org/issue17094">issue 17094</a>.)</li>
<li>Parameter names in <tt class="docutils literal"><span class="pre">__annotations__</span></tt> dicts are now mangled properly,
similarly to <tt class="docutils literal"><span class="pre">__kwdefaults__</span></tt>.  (Contributed by Yury Selivanov in
<a class="reference external" href="https://bugs.python.org/issue20625">issue 20625</a>.)</li>
<li><a class="reference internal" href="../library/hashlib.html#hashlib.hash.name" title="hashlib.hash.name"><tt class="xref py py-attr docutils literal"><span class="pre">hashlib.hash.name</span></tt></a> now always returns the identifier in lower case.
Previously some builtin hashes had uppercase names, but now that it is a
formal public interface the naming has been made consistent (<a class="reference external" href="https://bugs.python.org/issue18532">issue 18532</a>).</li>
<li>Because <a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><tt class="xref py py-mod docutils literal"><span class="pre">unittest.TestSuite</span></tt></a> now drops references to tests after they
are run, test harnesses that re-use a <a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><tt class="xref py py-class docutils literal"><span class="pre">TestSuite</span></tt></a> to re-run
a set of tests may fail.   Test suites should not be re-used in this fashion
since it means state is retained between test runs, breaking the test
isolation that <a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><tt class="xref py py-mod docutils literal"><span class="pre">unittest</span></tt></a> is designed to provide.  However, if the lack
of isolation is considered acceptable, the old behavior can be restored by
creating a <a class="reference internal" href="../library/unittest.html#unittest.TestSuite" title="unittest.TestSuite"><tt class="xref py py-mod docutils literal"><span class="pre">TestSuite</span></tt></a> subclass that defines a
<tt class="docutils literal"><span class="pre">_removeTestAtIndex</span></tt> method that does nothing (see
<a class="reference internal" href="../library/unittest.html#unittest.TestSuite.__iter__" title="unittest.TestSuite.__iter__"><tt class="xref py py-meth docutils literal"><span class="pre">TestSuite.__iter__()</span></tt></a>) (<a class="reference external" href="https://bugs.python.org/issue11798">issue 11798</a>).</li>
<li><a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><tt class="xref py py-mod docutils literal"><span class="pre">unittest</span></tt></a> now uses <a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><tt class="xref py py-mod docutils literal"><span class="pre">argparse</span></tt></a> for command line parsing.  There are
certain invalid command forms that used to work that are no longer allowed;
in theory this should not cause backward compatibility issues since the
disallowed command forms didn&#8217;t make any sense and are unlikely to be in use.</li>
<li>The <a class="reference internal" href="../library/re.html#re.split" title="re.split"><tt class="xref py py-func docutils literal"><span class="pre">re.split()</span></tt></a>, <a class="reference internal" href="../library/re.html#re.findall" title="re.findall"><tt class="xref py py-func docutils literal"><span class="pre">re.findall()</span></tt></a>, and <a class="reference internal" href="../library/re.html#re.sub" title="re.sub"><tt class="xref py py-func docutils literal"><span class="pre">re.sub()</span></tt></a> functions, and
the <a class="reference internal" href="../library/re.html#re.match.group" title="re.match.group"><tt class="xref py py-meth docutils literal"><span class="pre">group()</span></tt></a> and <a class="reference internal" href="../library/re.html#re.match.groups" title="re.match.groups"><tt class="xref py py-meth docutils literal"><span class="pre">groups()</span></tt></a> methods of
<tt class="docutils literal"><span class="pre">match</span></tt> objects now always return a <em>bytes</em> object when the string
to be matched is a <a class="reference internal" href="../glossary.html#term-bytes-like-object"><em class="xref std std-term">bytes-like object</em></a>.  Previously the return type
matched the input type, so if your code was depending on the return value
being, say, a <tt class="docutils literal"><span class="pre">bytearray</span></tt>, you will need to change your code.</li>
<li><a class="reference internal" href="../library/audioop.html#module-audioop" title="audioop: Manipulate raw audio data."><tt class="xref py py-mod docutils literal"><span class="pre">audioop</span></tt></a> functions now raise an error immediately if passed string
input, instead of failing randomly later on (<a class="reference external" href="https://bugs.python.org/issue16685">issue 16685</a>).</li>
<li>The new <em>convert_charrefs</em> argument to <a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><tt class="xref py py-class docutils literal"><span class="pre">HTMLParser</span></tt></a>
currently defaults to <tt class="docutils literal"><span class="pre">False</span></tt> for backward compatibility, but will
eventually be changed to default to <tt class="docutils literal"><span class="pre">True</span></tt>.  It is recommended that you add
this keyword, with the appropriate value, to any
<a class="reference internal" href="../library/html.parser.html#html.parser.HTMLParser" title="html.parser.HTMLParser"><tt class="xref py py-class docutils literal"><span class="pre">HTMLParser</span></tt></a> calls in your code (<a class="reference external" href="https://bugs.python.org/issue13633">issue 13633</a>).</li>
<li>Since the <em>digestmod</em> argument to the <a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><tt class="xref py py-func docutils literal"><span class="pre">hmac.new()</span></tt></a> function will in the
future have no default, all calls to <a class="reference internal" href="../library/hmac.html#hmac.new" title="hmac.new"><tt class="xref py py-func docutils literal"><span class="pre">hmac.new()</span></tt></a> should be changed to
explicitly specify a <em>digestmod</em> (<a class="reference external" href="https://bugs.python.org/issue17276">issue 17276</a>).</li>
<li>Calling <a class="reference internal" href="../library/sysconfig.html#sysconfig.get_config_var" title="sysconfig.get_config_var"><tt class="xref py py-func docutils literal"><span class="pre">sysconfig.get_config_var()</span></tt></a> with the <tt class="docutils literal"><span class="pre">SO</span></tt> key, or looking
<tt class="docutils literal"><span class="pre">SO</span></tt> up in the results of a call to <a class="reference internal" href="../library/sysconfig.html#sysconfig.get_config_vars" title="sysconfig.get_config_vars"><tt class="xref py py-func docutils literal"><span class="pre">sysconfig.get_config_vars()</span></tt></a>
is deprecated.  This key should be replaced by <tt class="docutils literal"><span class="pre">EXT_SUFFIX</span></tt> or
<tt class="docutils literal"><span class="pre">SHLIB_SUFFIX</span></tt>, depending on the context (<a class="reference external" href="https://bugs.python.org/issue19555">issue 19555</a>).</li>
<li>Any calls to <tt class="docutils literal"><span class="pre">open</span></tt> functions that specify <tt class="docutils literal"><span class="pre">U</span></tt> should be modified.
<tt class="docutils literal"><span class="pre">U</span></tt> is ineffective in Python3 and will eventually raise an error if used.
Depending on the function, the equivalent of its old Python2 behavior can be
achieved using either a <em>newline</em> argument, or if necessary by wrapping the
stream in <a class="reference internal" href="../library/io.html#io.TextIOWrapper" title="io.TextIOWrapper"><tt class="xref py py-mod docutils literal"><span class="pre">TextIOWrapper</span></tt></a> to use its <em>newline</em> argument
(<a class="reference external" href="https://bugs.python.org/issue15204">issue 15204</a>).</li>
<li>If you use <a class="reference internal" href="../using/scripts.html#scripts-pyvenv"><em>pyvenv</em></a> in a script and desire that pip
<em>not</em> be installed, you must add <tt class="docutils literal"><span class="pre">--without-pip</span></tt> to your command
invocation.</li>
<li>The default behavior of <a class="reference internal" href="../library/json.html#json.dump" title="json.dump"><tt class="xref py py-func docutils literal"><span class="pre">json.dump()</span></tt></a> and <a class="reference internal" href="../library/json.html#json.dumps" title="json.dumps"><tt class="xref py py-func docutils literal"><span class="pre">json.dumps()</span></tt></a> when
an indent is specified has changed: it no longer produces trailing
spaces after the item separating commas at the ends of lines.  This
will matter only if you have tests that are doing white-space-sensitive
comparisons of such output (<a class="reference external" href="https://bugs.python.org/issue16333">issue 16333</a>).</li>
<li><a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><tt class="xref py py-mod docutils literal"><span class="pre">doctest</span></tt></a> now looks for doctests in extension module <tt class="docutils literal"><span class="pre">__doc__</span></tt>
strings, so if your doctest test discovery includes extension modules that
have things that look like doctests in them you may see test failures you&#8217;ve
never seen before when running your tests (<a class="reference external" href="https://bugs.python.org/issue3158">issue 3158</a>).</li>
<li>The <a class="reference internal" href="../library/collections.abc.html#module-collections.abc" title="collections.abc: Abstract base classes for containers"><tt class="xref py py-mod docutils literal"><span class="pre">collections.abc</span></tt></a> module has been slightly refactored as
part of the Python startup improvements.  As a consequence of this, it is no
longer the case that importing <a class="reference internal" href="../library/collections.html#module-collections" title="collections: Container datatypes"><tt class="xref py py-mod docutils literal"><span class="pre">collections</span></tt></a> automatically imports
<a class="reference internal" href="../library/collections.abc.html#module-collections.abc" title="collections.abc: Abstract base classes for containers"><tt class="xref py py-mod docutils literal"><span class="pre">collections.abc</span></tt></a>.  If your program depended on the (undocumented)
implicit import, you will need to add an explicit <tt class="docutils literal"><span class="pre">import</span> <span class="pre">collections.abc</span></tt>
(<a class="reference external" href="https://bugs.python.org/issue20784">issue 20784</a>).</li>
</ul>
</div>
<div class="section" id="changes-in-the-c-api">
<h3>Changes in the C API<a class="headerlink" href="#changes-in-the-c-api" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="../c-api/veryhigh.html#c.PyEval_EvalFrameEx" title="PyEval_EvalFrameEx"><tt class="xref c c-func docutils literal"><span class="pre">PyEval_EvalFrameEx()</span></tt></a>, <a class="reference internal" href="../c-api/object.html#c.PyObject_Repr" title="PyObject_Repr"><tt class="xref c c-func docutils literal"><span class="pre">PyObject_Repr()</span></tt></a>, and
<a class="reference internal" href="../c-api/object.html#c.PyObject_Str" title="PyObject_Str"><tt class="xref c c-func docutils literal"><span class="pre">PyObject_Str()</span></tt></a>, along with some other internal C APIs, now include
a debugging assertion that ensures they are not used in situations where
they may silently discard a currently active exception. In cases where
discarding the active exception is expected and desired (for example,
because it has already been saved locally with <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_Fetch" title="PyErr_Fetch"><tt class="xref c c-func docutils literal"><span class="pre">PyErr_Fetch()</span></tt></a> or
is being deliberately replaced with a different exception), an explicit
<a class="reference internal" href="../c-api/exceptions.html#c.PyErr_Clear" title="PyErr_Clear"><tt class="xref c c-func docutils literal"><span class="pre">PyErr_Clear()</span></tt></a> call will be needed to avoid triggering the
assertion when invoking these operations (directly or indirectly) and
running against a version of Python that is compiled with assertions
enabled.</li>
<li><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_SetImportError" title="PyErr_SetImportError"><tt class="xref c c-func docutils literal"><span class="pre">PyErr_SetImportError()</span></tt></a> now sets <a class="reference internal" href="../library/exceptions.html#TypeError" title="TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a> when its <strong>msg</strong>
argument is not set. Previously only <tt class="docutils literal"><span class="pre">NULL</span></tt> was returned with no exception
set.</li>
<li>The result of the <a class="reference internal" href="../c-api/veryhigh.html#c.PyOS_ReadlineFunctionPointer" title="PyOS_ReadlineFunctionPointer"><tt class="xref c c-data docutils literal"><span class="pre">PyOS_ReadlineFunctionPointer</span></tt></a> callback must
now be a string allocated by <a class="reference internal" href="../c-api/memory.html#c.PyMem_RawMalloc" title="PyMem_RawMalloc"><tt class="xref c c-func docutils literal"><span class="pre">PyMem_RawMalloc()</span></tt></a> or
<a class="reference internal" href="../c-api/memory.html#c.PyMem_RawRealloc" title="PyMem_RawRealloc"><tt class="xref c c-func docutils literal"><span class="pre">PyMem_RawRealloc()</span></tt></a>, or <em>NULL</em> if an error occurred, instead of a
string allocated by <a class="reference internal" href="../c-api/memory.html#c.PyMem_Malloc" title="PyMem_Malloc"><tt class="xref c c-func docutils literal"><span class="pre">PyMem_Malloc()</span></tt></a> or <a class="reference internal" href="../c-api/memory.html#c.PyMem_Realloc" title="PyMem_Realloc"><tt class="xref c c-func docutils literal"><span class="pre">PyMem_Realloc()</span></tt></a>
(<a class="reference external" href="https://bugs.python.org/issue16742">issue 16742</a>)</li>
<li><tt class="xref c c-func docutils literal"><span class="pre">PyThread_set_key_value()</span></tt> now always set the value. In Python
3.3, the function did nothing if the key already exists (if the current
value is a non-NULL pointer).</li>
<li>The <tt class="docutils literal"><span class="pre">f_tstate</span></tt> (thread state) field of the <tt class="xref c c-type docutils literal"><span class="pre">PyFrameObject</span></tt>
structure has been removed to fix a bug: see <a class="reference external" href="https://bugs.python.org/issue14432">issue 14432</a> for the
rationale.</li>
</ul>
</div>
</div>
<div class="section" id="changed-in-3-4-3">
<h2>Changed in 3.4.3<a class="headerlink" href="#changed-in-3-4-3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pep-476-enabling-certificate-verification-by-default-for-stdlib-http-clients">
<span id="pep-476"></span><h3>PEP 476: Enabling certificate verification by default for stdlib http clients<a class="headerlink" href="#pep-476-enabling-certificate-verification-by-default-for-stdlib-http-clients" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../library/http.client.html#module-http.client" title="http.client: HTTP and HTTPS protocol client (requires sockets)."><tt class="xref py py-mod docutils literal"><span class="pre">http.client</span></tt></a> and modules which use it, such as <a class="reference internal" href="../library/urllib.request.html#module-urllib.request" title="urllib.request: Extensible library for opening URLs."><tt class="xref py py-mod docutils literal"><span class="pre">urllib.request</span></tt></a> and
<a class="reference internal" href="../library/xmlrpc.client.html#module-xmlrpc.client" title="xmlrpc.client: XML-RPC client access."><tt class="xref py py-mod docutils literal"><span class="pre">xmlrpc.client</span></tt></a>, will now verify that the server presents a certificate
which is signed by a CA in the platform trust store and whose hostname matches
the hostname being requested by default, significantly improving security for
many applications.</p>
<p>For applications which require the old previous behavior, they can pass an
alternate context:</p>
<div class="highlight-python3"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">ssl</span>

<span class="c"># This disables all verification</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span><span class="p">()</span>

<span class="c"># This allows using a specific certificate for the host, which doesn&#39;t need</span>
<span class="c"># to be in the trust store</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">(</span><span class="n">cafile</span><span class="o">=</span><span class="s">&quot;/path/to/file.crt&quot;</span><span class="p">)</span>

<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;https://invalid-cert&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">What&#8217;s New In Python 3.4</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">Summary &#8211; Release Highlights</a></li>
<li><a class="reference internal" href="#new-features">New Features</a><ul>
<li><a class="reference internal" href="#pep-453-explicit-bootstrapping-of-pip-in-python-installations">PEP 453: Explicit Bootstrapping of PIP in Python Installations</a><ul>
<li><a class="reference internal" href="#bootstrapping-pip-by-default">Bootstrapping pip By Default</a></li>
<li><a class="reference internal" href="#documentation-changes">Documentation Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-446-newly-created-file-descriptors-are-non-inheritable">PEP 446: Newly Created File Descriptors Are Non-Inheritable</a></li>
<li><a class="reference internal" href="#improvements-to-codec-handling">Improvements to Codec Handling</a></li>
<li><a class="reference internal" href="#pep-451-a-modulespec-type-for-the-import-system">PEP 451: A ModuleSpec Type for the Import System</a></li>
<li><a class="reference internal" href="#other-language-changes">Other Language Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-modules">New Modules</a><ul>
<li><a class="reference internal" href="#asyncio">asyncio</a></li>
<li><a class="reference internal" href="#ensurepip">ensurepip</a></li>
<li><a class="reference internal" href="#enum">enum</a></li>
<li><a class="reference internal" href="#pathlib">pathlib</a></li>
<li><a class="reference internal" href="#selectors">selectors</a></li>
<li><a class="reference internal" href="#statistics">statistics</a></li>
<li><a class="reference internal" href="#tracemalloc">tracemalloc</a></li>
</ul>
</li>
<li><a class="reference internal" href="#improved-modules">Improved Modules</a><ul>
<li><a class="reference internal" href="#abc">abc</a></li>
<li><a class="reference internal" href="#aifc">aifc</a></li>
<li><a class="reference internal" href="#argparse">argparse</a></li>
<li><a class="reference internal" href="#audioop">audioop</a></li>
<li><a class="reference internal" href="#base64">base64</a></li>
<li><a class="reference internal" href="#collections">collections</a></li>
<li><a class="reference internal" href="#colorsys">colorsys</a></li>
<li><a class="reference internal" href="#contextlib">contextlib</a></li>
<li><a class="reference internal" href="#dbm">dbm</a></li>
<li><a class="reference internal" href="#dis">dis</a></li>
<li><a class="reference internal" href="#doctest">doctest</a></li>
<li><a class="reference internal" href="#email">email</a></li>
<li><a class="reference internal" href="#filecmp">filecmp</a></li>
<li><a class="reference internal" href="#functools">functools</a></li>
<li><a class="reference internal" href="#gc">gc</a></li>
<li><a class="reference internal" href="#glob">glob</a></li>
<li><a class="reference internal" href="#hashlib">hashlib</a></li>
<li><a class="reference internal" href="#hmac">hmac</a></li>
<li><a class="reference internal" href="#html">html</a></li>
<li><a class="reference internal" href="#http">http</a></li>
<li><a class="reference internal" href="#idlelib-and-idle">idlelib and IDLE</a></li>
<li><a class="reference internal" href="#importlib">importlib</a></li>
<li><a class="reference internal" href="#inspect">inspect</a></li>
<li><a class="reference internal" href="#ipaddress">ipaddress</a></li>
<li><a class="reference internal" href="#logging">logging</a></li>
<li><a class="reference internal" href="#marshal">marshal</a></li>
<li><a class="reference internal" href="#mmap">mmap</a></li>
<li><a class="reference internal" href="#multiprocessing">multiprocessing</a></li>
<li><a class="reference internal" href="#operator">operator</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#pdb">pdb</a></li>
<li><a class="reference internal" href="#pickle">pickle</a></li>
<li><a class="reference internal" href="#plistlib">plistlib</a></li>
<li><a class="reference internal" href="#poplib">poplib</a></li>
<li><a class="reference internal" href="#pprint">pprint</a></li>
<li><a class="reference internal" href="#pty">pty</a></li>
<li><a class="reference internal" href="#pydoc">pydoc</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#resource">resource</a></li>
<li><a class="reference internal" href="#select">select</a></li>
<li><a class="reference internal" href="#shelve">shelve</a></li>
<li><a class="reference internal" href="#shutil">shutil</a></li>
<li><a class="reference internal" href="#smtpd">smtpd</a></li>
<li><a class="reference internal" href="#smtplib">smtplib</a></li>
<li><a class="reference internal" href="#socket">socket</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#ssl">ssl</a></li>
<li><a class="reference internal" href="#stat">stat</a></li>
<li><a class="reference internal" href="#struct">struct</a></li>
<li><a class="reference internal" href="#subprocess">subprocess</a></li>
<li><a class="reference internal" href="#sunau">sunau</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#tarfile">tarfile</a></li>
<li><a class="reference internal" href="#textwrap">textwrap</a></li>
<li><a class="reference internal" href="#threading">threading</a></li>
<li><a class="reference internal" href="#traceback">traceback</a></li>
<li><a class="reference internal" href="#types">types</a></li>
<li><a class="reference internal" href="#urllib">urllib</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#venv">venv</a></li>
<li><a class="reference internal" href="#wave">wave</a></li>
<li><a class="reference internal" href="#weakref">weakref</a></li>
<li><a class="reference internal" href="#xml-etree">xml.etree</a></li>
<li><a class="reference internal" href="#zipfile">zipfile</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpython-implementation-changes">CPython Implementation Changes</a><ul>
<li><a class="reference internal" href="#pep-445-customization-of-cpython-memory-allocators">PEP 445: Customization of CPython Memory Allocators</a></li>
<li><a class="reference internal" href="#pep-442-safe-object-finalization">PEP 442: Safe Object Finalization</a></li>
<li><a class="reference internal" href="#pep-456-secure-and-interchangeable-hash-algorithm">PEP 456: Secure and Interchangeable Hash Algorithm</a></li>
<li><a class="reference internal" href="#pep-436-argument-clinic">PEP 436: Argument Clinic</a></li>
<li><a class="reference internal" href="#other-build-and-c-api-changes">Other Build and C API Changes</a></li>
<li><a class="reference internal" href="#other-improvements">Other Improvements</a></li>
<li><a class="reference internal" href="#significant-optimizations">Significant Optimizations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deprecated">Deprecated</a><ul>
<li><a class="reference internal" href="#deprecations-in-the-python-api">Deprecations in the Python API</a></li>
<li><a class="reference internal" href="#deprecated-features">Deprecated Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#removed">Removed</a><ul>
<li><a class="reference internal" href="#operating-systems-no-longer-supported">Operating Systems No Longer Supported</a></li>
<li><a class="reference internal" href="#api-and-feature-removals">API and Feature Removals</a></li>
<li><a class="reference internal" href="#code-cleanups">Code Cleanups</a></li>
</ul>
</li>
<li><a class="reference internal" href="#porting-to-python-3-4">Porting to Python 3.4</a><ul>
<li><a class="reference internal" href="#changes-in-python-command-behavior">Changes in &#8216;python&#8217; Command Behavior</a></li>
<li><a class="reference internal" href="#changes-in-the-python-api">Changes in the Python API</a></li>
<li><a class="reference internal" href="#changes-in-the-c-api">Changes in the C API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#changed-in-3-4-3">Changed in 3.4.3</a><ul>
<li><a class="reference internal" href="#pep-476-enabling-certificate-verification-by-default-for-stdlib-http-clients">PEP 476: Enabling certificate verification by default for stdlib http clients</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">What&#8217;s New in Python</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="3.3.html"
                        title="next chapter">What&#8217;s New In Python 3.3</a></p>
<h3>This Page</h3>
<ul class="this-page-menu">
  <li><a href="../bugs.html">Report a Bug</a></li>
  <li><a href="../_sources/whatsnew/3.4.txt"
         rel="nofollow">Show Source</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="3.3.html" title="What’s New In Python 3.3"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="What’s New in Python"
             >previous</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &raquo;</li>
        <li>
          <span class="version_switcher_placeholder">3.4.3</span>
          <a href="../index.html">Documentation</a> &raquo;
        </li>

          <li><a href="index.html" >What&#8217;s New in Python</a> &raquo;</li> 
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 1990-2015, Python Software Foundation.
    <br />
    The Python Software Foundation is a non-profit corporation.
    <a href="https://www.python.org/psf/donations/">Please donate.</a>
    <br />
    Last updated on May 23, 2015.
    <a href="../bugs.html">Found a bug</a>?
    <br />
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
    </div>

  </body>
</html>